/* >>> file start: js/jquery/jquery.lj.inlineCalendar.js */
function _typeof(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}!function(t){function e(t,e){e=e||!1;var a=t.getDate().toString();1===a.length&&(a="0"+a),e&&(a="");var n=t.getMonth().toString();return 1===n.length&&(n="0"+n),parseInt(t.getFullYear().toString()+n+a,10)}function a(t,a){return e(a,!0)>=e(t[0],!0)&&e(a,!0)<=e(t[1],!0)}function n(a,n,i){this.initialize=function(t){this.tbody=this.catchTableStructure(t)},this.modelChanged=function(e,n,s){var o=i.longMonth?i.ml.monthNamesLong:i.ml.monthNamesShort;this.tbody.detach(),this.fillDates(e,n);for(var r in s)s.hasOwnProperty(r)&&a[r][s[r]?"removeClass":"addClass"](this.disabledStyle(r));var l=i.monthRef?t("<a>",{href:LJ.Util.Date.format(e,i.monthRef),text:o[e.getMonth()]+(i.monthWithYear?" "+e.getFullYear():"")}):o[e.getMonth()],h=i.yearRef?t("<a>",{href:LJ.Util.Date.format(e,i.yearRef),text:e.getFullYear()}):e.getFullYear();a.monthLabel.empty().append(l),a.yearLabel.empty().append(h),this.tbody.appendTo(a.table)},this.catchTableStructure=function(e){var n=a.tbody[0];a.daysCells=[],a.daysSpans=[];for(var i,s,o,r=n.rows.length,l=6-r,h="<tr>",d=0;7>d;++d)h+="<td><span></span></td>";for(h+="</tr>";l-- >0;)t(h).hide().appendTo(a.tbody);for(r=6,a.lastRow=jQuery(n.rows[n.rows.length-1]),e=new Date(e),i=0;r>i;++i)for(s=0,o=n.rows[i].cells.length;o>s;++s){var c=jQuery(n.rows[i].cells[s]),u=c.children(),p=u.text().trim();p&&(e.setDate(p),c.data("isActive",!0),c.data("day",e)),a.daysCells.push(c),a.daysSpans.push(u)}return jQuery(n)},this.fillDates=function(t,e){function n(t){var a=t.getFullYear(),n=t.getMonth(),i=t.getDate();return e&&e[a]&&e[a][n]&&e[a][n][i]}var s=new Date(t);s.setDate(1);var o;o=i.startAtSunday?s.getDay():0===s.getDay()?6:s.getDay()-1,s.setDate(1-o);for(var r=0,l=a.daysCells.length;l>r;++r){var h=a.daysCells[r],d=a.daysSpans[r];this.formDayString(s,h,d,n(s),this.isActiveDate(s,t)),s.setDate(s.getDate()+1)}s.setDate(s.getDate()-1),s.getDate()<7?a.lastRow.css("display",""):a.lastRow.css("display","none")},this.isActiveDate=function(t,a){var n=!0;return n=a.getFullYear()===t.getFullYear()&&a.getMonth()===t.getMonth(),n&&(i.activeFrom||i.activeUntil)&&(n=i.activeFrom&&e(i.activeFrom)<=e(t)||i.activeUntil&&e(i.activeUntil)>=e(t)),n},this.formDayString=function(a,s,o,r,l){a=new Date(a);var h=e(a)===e(i.currentDate);if(s.data("day",a),s.data("isActive",l),s.data("hasEvents",r),s[h?"addClass":"removeClass"](n.current),s.removeClass(n.cellHover),l)if(r||i.allRefs){var d=!0;i.allRefs&&"object"===_typeof(i.allRefs)&&(i.allRefs.from&&a<i.allRefs.from&&(d=!1),i.allRefs.to&&a>i.allRefs.to&&(d=!1)),d?(s.removeClass(n.inactive),o.html(t("<a />",{html:a.getDate(),href:LJ.Util.Date.format(a,i.dayRef),target:"_self"}))):(s.removeClass(n.inactive),o.html(a.getDate()))}else s.removeClass(n.inactive),o.html(a.getDate());else s.addClass(n.inactive),o.html(a.getDate())},this.disabledStyle=function(t){return"prevMonth"===t||"prevYear"===t?n.prevDisabled:n.nextDisabled}}var i={dayRef:"/%Y/%M/%D",monthRef:"",yearRef:"",allRefs:!1,currentDate:new Date,activeUntil:null,activeFrom:null,startMonth:new Date(1900,0,1),endMonth:new Date(2050,0,1),startAtSunday:"0"===LJ.ml("date.format.offset")||!1,dateFormat:"%Y-%M-%D",defaultTitle:"Calendar",longMonth:!1,events:null,displayedMonth:null,dateChange:null,selectors:{table:"table",title:"h5",tbody:"tbody",month:".cal-nav-month",year:".cal-nav-year",monthSelect:".cal-nav-month-select",yearSelect:".cal-nav-year-select",prevMonth:".cal-nav-month .cal-nav-prev",nextMonth:".cal-nav-month .cal-nav-next",prevYear:".cal-nav-year .cal-nav-prev",nextYear:".cal-nav-year .cal-nav-next",monthLabel:".cal-nav-month .cal-month",yearLabel:".cal-nav-year .cal-year"},classNames:{container:"",inactive:"other",future:"other",current:"current",weekend:"weekend",nextDisabled:"cal-nav-next-dis",prevDisabled:"cal-nav-prev-dis",cellHover:"hover",longMonth:"sidebar-cal-longmonth"},mlPrefix:{monthNamesShort:["monthNames","date.month.{name}.short"],monthNamesLong:["monthNames","date.month.{name}.long"],dayNamesShort:["dayNames","date.day.{name}.short"]},ml:{monthNames:["january","february","march","april","may","june","july","august","september","october","november","december"],dayNames:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],caption:"Calendar"}},s={options:{},_create:function(){this._preInit(),this._initialize(),this._postInit()},_preInit:function(){var e=t[this.namespace][this.widgetName].getDefaults();this.options=jQuery.extend(!0,{},e,this.options),this._prepareMLVars()},_prepareMLVars:function(){var t,e=function(t,e){return LJ.ml(t.supplant({name:e}))};for(var a in this.options.mlPrefix)this.options.mlPrefix.hasOwnProperty(a)&&(t=this.options.mlPrefix[a],this.options.ml[a]=this.options.ml[t[0]].map(e.bind(null,t[1])))},_initialize:function(){this.options.displayedMonth||(this.options.displayedMonth=new Date(this.options.currentDate)),this._events=this.options.events,this._hideTimer=null,this._nodes=this._nodes||{container:this.element,root:this.element},this._invalidateTimer=null,this.element.hasClass(this.options.classNames.longMonth)&&(this.options.longMonth=!0),this._bindNodes(),this.options.startMonth.setDate(1),this._view=new(this._getView())(this._nodes,this.options.classNames,this.options),this._view.initialize(this.options.currentDate),this._nodes.table.hasClass("monday")&&this._setOption("startAtSunday",!1),this._nodes.monthSelect.val(this.options.displayedMonth.getMonth()),this._nodes.yearSelect.val(this.options.displayedMonth.getFullYear()),this._bindEvents()},_postInit:function(){},_getView:function(){return n},_bindNodes:function(){for(var t in this.options.selectors)!this.options.selectors.hasOwnProperty(t)||t in this._nodes||(this._nodes[t]=this._nodes.container.find(this.options.selectors[t]));var e=LJ.Util.Date.parse(this._nodes.table.attr("data-date"),this.options.dateFormat);e&&(this.options.displayedMonth=e)},destroy:function(){t.Widget.prototype.destroy.apply(this,arguments)},_bindEvents:function(){var e=this,a=this._getSwitcherStates(this.options.currentDate),n=function(t){return function(a){a.preventDefault(),a.stopPropagation();var n=e._getSwitcherStates(e.options.currentDate);n[t]&&e["_"+t]()}};for(var i in a)a.hasOwnProperty(i)&&this._nodes[i].click(n(i));this._nodes.monthSelect.change(function(){var t=new Date(e.options.currentDate);t.setMonth(this.value),e._setOption("currentDate",t)}),this._nodes.yearSelect.change(function(){var t=new Date(e.options.currentDate);t.setFullYear(this.value),e._setOption("currentDate",t)}),this._nodes.tbody.delegate("td","click",function(a){e._cellSelectedEvent(t(this),a)})},_switchMonth:function(t){var e=jQuery.Event("dateChange");e.moveForward=t>0,e.switchType=12===Math.abs(t)?"year":1===Math.abs(t)?"month":null,e.date=new Date(this.options.displayedMonth.getFullYear(),this.options.displayedMonth.getMonth()+t,1),this._nodes.root.trigger(e),this._setOption("displayedMonth",e.date)},_prevMonth:function(){this._switchMonth(-1)},_nextMonth:function(){this._switchMonth(1)},_prevYear:function(){this._switchMonth(-12)},_nextYear:function(){this._switchMonth(12)},_cellSelectedEvent:function(t,e){(!t.data("isActive")||this._cellSelected(t.data("day")))&&(e.stopPropagation(),e.preventDefault())},_cellSelected:function(t){var e=jQuery.Event("daySelected");return this._nodes.root.trigger(e,[t,LJ.Util.Date.format(t,this.options.dateFormat)]),e.isDefaultPrevented()||this._setOption("currentDate",t),!e.isDefaultPrevented()},_fitDate:function(t){t=new Date(t);var n=[this.options.startMonth,this.options.endMonth];return a(n,t)||(t=e(t,!0)<e(n[0],!0)?new Date(n[0]):new Date(n[1])),t},_getSwitcherStates:function(){var t=this.options.displayedMonth,e=new Date(t.getFullYear(),0,1),a=new Date(t.getFullYear(),11,1);return{prevMonth:this._isActivePrev(t)!==!1,prevYear:this._isActivePrev(e)!==!1,nextMonth:this._isActiveNext(t)!==!1,nextYear:this._isActiveNext(a)!==!1}},_isActiveNext:function(t){return this._isActiveDate(t,1)},_isActivePrev:function(t){return this._isActiveDate(t,-1)},_isActiveDate:function(t,e){var n=new Date(t);return n.setMonth(n.getMonth()+e),n.setDate(1),a([this.options.startMonth,this.options.endMonth],n)},_invalidateDisplay:function(){var t=this;clearTimeout(this._invalidateTimer),setTimeout(function(){t._view.modelChanged(t.options.displayedMonth,t._events,t._getSwitcherStates())},50)},_setOption:function(t,a){switch(t){case"currentDate":this.options.currentDate=this._fitDate(a);var n=jQuery.Event("currentDateChange"),i=new Date(this.options.currentDate);this._nodes.root.trigger(n,[i,LJ.Util.Date.format(i,this.options.dateFormat)]),this._setOption("displayedMonth",a),this._invalidateDisplay();break;case"activeFrom":this.options.activeFrom=new Date(a),this._invalidateDisplay();break;case"activeUntil":this.options.activeUntil=new Date(a),this._invalidateDisplay();break;case"title":this._title=a,this._nodes.title.html(a);break;case"events":this._events=a,this._invalidateDisplay();break;case"displayedMonth":var s=this._fitDate(new Date(a)),o=e(s,!0)===e(this.options.displayedMonth,!0);o||(this.options.displayedMonth=this._fitDate(new Date(a)),this._nodes.monthSelect.val(this.options.displayedMonth.getMonth()),this._nodes.yearSelect.val(this.options.displayedMonth.getFullYear()),this._invalidateDisplay());break;case"startMonth":this.options.startMonth=new Date(a),this._invalidateDisplay();break;case"endMonth":this.options.endMonth=new Date(a),this._invalidateDisplay();break;case"startAtSunday":this.options.startAtSunday=!!a;break;case"monthWithYear":this.options.monthWithYear=Boolean(a);break;case"dayRef":this.options.dayRef=a,this._invalidateDisplay()}},getElement:function(t){return t in this._nodes?this._nodes[t]:null}};t.widget("lj.inlineCalendar",s),jQuery.extend(t.lj.inlineCalendar,{getDefaults:function(){return i},setDefaults:function(t){t&&jQuery.extend(!0,i,t)}})}(jQuery);
/* <<< file end: js/jquery/jquery.lj.inlineCalendar.js */

//# map link was there [jquery.lj.inlineCalendar.js.map]
/* >>> file start: js/jquery/jquery.lj.calendar.js */
//= require js/jquery/jquery.lj.inlineCalendar.js
!function(e,t){var n,s={showOn:"click",closeControl:!0,showCellHovers:!1,hoverDelay:400,align:"center",events:null,displayedMonth:null,bubbleClass:!1,selectors:{tmpl:".appwidget-calendar .calendar"},classNames:{showCellHovers:"all-days",popup:"b-bubble-calendar"},templates:{calendar:'<div class="popup-inner calendar" style="display: none;"> 						<p class="cal-nav"> 							<span class="cal-nav-month"> 								<i class="cal-nav-prev"></i> 								<span class="cal-month"></span> 								<i class="cal-nav-next cal-nav-next-dis"></i> 							</span> 							<span class="cal-nav-year"> 								<i class="cal-nav-prev cal-nav-prev"></i> 								<span class="cal-year"></span> 								<i class="cal-nav-next cal-nav-next-dis"></i> 							</span> 						</p> 						<table class="calendar-table" cellspacing="0" cellpadding="0"> 							<thead> 								<tr> 									{{each days}} 										<th class="calendar-cell calendar-cell--header {{if $index % 7 === weekend1 || $index % 7 === weekend2}} weekend{{/if}}">${day}</th> 									{{/each}} 								</tr> 							</thead> 							<tbody> 								{{each cells}} 								{{if $index % 7 === 0}}<tr>{{/if}} 								<td class="calendar-cell {{if $index % 7 === weekend1 || $index % 7 === weekend2}}weekend{{/if}}"><span></span></td> 								{{if $index % 7 === 6}}</tr>{{/if}} 								{{/each}} 							</tbody> 						</table></div>'}},a={options:{},_initialize:function(){n||(n=this._buildDOM()),this._nodes={container:n.clone(),root:this.element},e.lj.inlineCalendar.prototype._initialize.apply(this),this._invalidateDisplay()},_bindNodes:function(){e.lj.inlineCalendar.prototype._bindNodes.apply(this);var t=this;this._nodes.container.bubble({classNames:{containerAddClass:this.options.bubbleClass?this.options.classNames.popup:""},target:this._nodes.root,align:this.options.align,closeControl:this.options.closeControl,showOn:this.options.showOn,closeOnContentClick:!1}).bind("bubbleshow",function(e){t._nodes.container.bubble("setPreventHide",!0),setTimeout(function(){t._nodes.container.bubble("setPreventHide",!1)},300),t._trigger("show")}).bind("bubblehide",function(e){t._trigger("hide")}).addClass(this.options.classNames.container),this.options.input?this._nodes.input=this.options.input:this._nodes.root.is("[type=text]")?this._nodes.input=this._nodes.root:this._nodes.input=e(),this._nodes.input.mask&&this._nodes.input.mask("?dddd-dd-dd",{placeholder:" "}),this._nodes.input.input(this._parseInputValue.bind(this));var n=LJ.Util.Date.parse(this._nodes.input.val(),this.options.dateFormat);n&&(this.options.currentDate=n),this.options.showCellHovers&&this._nodes.table.addClass(this.options.classNames.showCellHovers)},destroy:function(){this._nodes.container.bubble("destroy"),e.lj.inlineCalendar.prototype.destroy.apply(this)},_buildDOM:function(){var e=this.options.ml.dayNamesShort.map(function(e){return{day:e}}),t=0,n=6,s=function(e,t){for(var n=[];e--;)n.push(t);return n};this.options.startAtSunday||(e[7]=e[0],e.shift(),t=5);for(var a=[],i=[],l=this.options.endMonth.getFullYear(),o=this.options.startMonth.getFullYear();l>=o;)a.push({year:l--});i=this.options.ml.monthNamesLong.map(function(e){return{month:e}});var d={caption:this.options.ml.caption,days:e,months:i,years:a,cells:s(42,{}),weekend1:t,weekend2:n};return-1!==this.options.templates.calendar.indexOf(" ")?jQuery.tmpl(this.options.templates.calendar,d):LJ.UI.template(this.options.templates.calendar,d)},_parseInputValue:function(){var e=LJ.Util.Date.parse(this._nodes.input.val(),this.options.dateFormat);e&&this._cellSelected(e)},_cellSelectedEvent:function(n,s){var a=this;e.lj.inlineCalendar.prototype._cellSelectedEvent.call(this,n,s),a.options.showCellHovers&&n.data("isActive")&&a._nodes.container.bubble("hide"),"a"==s.target.tagName.toLowerCase()&&(t.location.href=s.target.href)},_invalidateDisplay:function(){this._view.modelChanged(this.options.displayedMonth,this._events,this._getSwitcherStates())},_setOption:function(t,n){switch(e.lj.inlineCalendar.prototype._setOption.call(this,t,n),t){case"currentDate":this._nodes.input.val(LJ.Util.Date.format(this.options.currentDate,this.options.dateFormat))}}};e.widget("lj.calendar",e.lj.inlineCalendar,a),jQuery.extend(e.lj.calendar,{getDefaults:function(){return jQuery.extend(!0,{},e.lj.inlineCalendar.getDefaults(),s)},setDefaults:function(e){e&&jQuery.extend(s,e)}})}(jQuery,window);
/* <<< file end: js/jquery/jquery.lj.calendar.js */

//# map link was there [jquery.lj.calendar.js.map]
/* >>> file start: js/jquery/jquery.mask.js */
!function(t){var e=(t.browser.msie?"paste":"input")+".mask",n=void 0!=window.orientation;t.mask={definitions:{d:"[0-9]",w:"[A-Za-z]","*":"[A-Za-z0-9а-яА-Я]"}},t.fn.extend({unmask:function(){return this.trigger("unmask")},mask:function(a,r){if(!a&&this.length>0){var i=t(this[0]),o=i.data("tests");return t.map(i.data("buffer"),function(t,e){return o[e]?t:null}).join("")}r=t.extend({placeholder:"_",completed:null},r);var u=t.mask.definitions,o=[],l=a.length,f=null,s=a.length;return t.each(a.split(""),function(t,e){"?"==e?(s--,l=t):u[e]?(o.push(new RegExp(u[e])),null==f&&(f=o.length-1)):o.push(null)}),this.each(function(){function i(t){for(;++t<=s&&!o[t];);return t}function c(t){for(;!o[t]&&--t>=0;);for(var e=t;s>e;e++)if(o[e]){g[e]=r.placeholder;var n=i(e);if(!(s>n&&o[e].test(g[n])))break;g[e]=g[n]}k(),b.caret(Math.max(f,t))}function d(t){for(var e=t,n=r.placeholder;s>e;e++)if(o[e]){var a=i(e),u=g[e];if(g[e]=n,!(s>a&&o[a].test(u)))break;n=u}}function h(e){var a=t(this).caret(),r=e.keyCode;return y=16>r||r>16&&32>r||r>32&&41>r,a.start-a.end==0||y&&8!=r&&46!=r||m(a.start,a.end),8==r||46==r||n&&127==r?(c(a.start+(46==r?0:-1)),!1):27==r?(b.val(w),b.caret(0,p()),!1):void 0}function v(e){if(y)return y=!1,8==e.keyCode?!1:null;e=e||window.event;var n=e.charCode||e.keyCode||e.which,a=t(this).caret();if(e.ctrlKey||e.altKey||e.metaKey)return!0;if(n>=32&&125>=n||n>186){var u=i(a.start-1);if(s>u){var l=String.fromCharCode(n);if(o[u].test(l)){d(u),g[u]=l,k();var a=i(u);t(this).caret(a),r.completed&&a==s&&r.completed.call(b)}}}return!1}function m(t,e){for(var n=t;e>n&&s>n;n++)o[n]&&(g[n]=r.placeholder)}function k(){return b.val(g.join("")).val()}function p(t){for(var e=b.val(),n=-1,a=0,i=0;s>a;a++)if(o[a]){for(g[a]=r.placeholder;i++<e.length;){var u=e.charAt(i-1);if(o[a].test(u)){g[a]=u,n=a;break}}if(i>e.length)break}else g[a]==e.charAt(i)&&a!=l&&(i++,n=a);return!t&&l>n+1?(b.val(""),m(0,s)):(t||n+1>=l)&&(k(),t||b.val(b.val().substring(0,n+1))),l?a:f}var b=t(this),g=t.map(a.split(""),function(t,e){return"?"!=t?u[t]?r.placeholder:t:void 0}),y=!1,w=b.val();b.data("buffer",g).data("tests",o),b.attr("readonly")||b.one("unmask",function(){b.unbind(".mask").removeData("buffer").removeData("tests")}).bind("focus.mask",function(){w=b.val();var t=p();k(),setTimeout(function(){t==a.length?b.caret(0,t):b.caret(t)},0)}).bind("blur.mask",function(){p(),b.val()!=w&&b.change()}).bind("keydown.mask",h).bind("keypress.mask",v).bind(e,function(){setTimeout(function(){b.caret(p(!0))},0)}),p()})}})}(jQuery);
/* <<< file end: js/jquery/jquery.mask.js */

//# map link was there [jquery.mask.js.map]
/* >>> file start: js/jquery/jquery.calendarEvents.js */
!function(e){var t={};e.fn.calendarEvents=function(n){function a(e,t){return"cache_"+e+t}function s(e,t){var n=this;this.calendar=e,this.events=null,this.options=t,this._ajaxActive=!1,this._currentDate;var s,i=function(t,i){"string"!=typeof e.data("noFetch")&&(clearTimeout(s),n._currentDate=a(t.getFullYear(),t.getMonth()+1),s=setTimeout(function(){n.fetchEvents(t.getFullYear(),t.getMonth()+1,i)},200))};this.calendar.bind("dateChange",function(e){var t=n.calendar[n.options.calendarType]("option","displayedMonth"),a=1===Math.abs(12*(e.date.getFullYear()-t.getFullYear())+(e.date.getMonth()-t.getMonth()));i(e.date,a)}),this.options.fetchOnFirstDisplay&&this.calendar.one("calendarshow",function(e){i(new Date,!0)})}var i={calendarType:"calendar",classNames:{idle:"idle"},fetchOnFirstDisplay:!1};return s.prototype={getEvents:function(e,t,n){var a={};return a[+e]={},a[+e][+t-1]=n,a},fetchEvents:function(n,s,i){i=arguments.length>=3?!!i:!0;var o=this,r=(this.calendar[this.options.calendarType]("option","displayedMonth"),this.calendar[this.options.calendarType]("getElement",i?"month":"year")),c=this.options.classNames.idle,l=!0,h=function(){o._ajaxActive||l||r.removeClass(c)};this.calendar[this.options.calendarType]("getElement","year").removeClass(c),this.calendar[this.options.calendarType]("getElement","month").removeClass(c),r.addClass(c),this._ajaxActive=!0,setTimeout(function(){l=!1,h()},500);var d=a(n,s);processResults=function(e){d===o._currentDate&&(o.events=t[d],o.calendar[o.options.calendarType]("option","events",o.getEvents(o.events.year,o.events.month,o.events.days)),o._ajaxActive=!1,h())},d in t?processResults(t[d]):e.getJSON(LiveJournal.getAjaxUrl("calendar"),{year:n,month:s},function(e){t[d]=e,processResults(e)})}},this.each(function(){new s(e(this),e.extend({},i,n))})}}(jQuery);
/* <<< file end: js/jquery/jquery.calendarEvents.js */

//# map link was there [jquery.calendarEvents.js.map]
/* >>> file start: js/core/angular/ref.js */
!function(e){return e}(),function(){"use strict";angular.module("LJ.Ref",[]).factory("Ref",function(){function e(e,n){return f[e]?void console.error("Ref element with id `%s` has been registered before.",e):void(f[e]=n)}function n(e){f[e]&&delete f[e]}function o(e){var n=f[e];return n||console.error("Ref `%s` not found.",e),n}function r(e,n){"undefined"==typeof n&&(n={});var r=o(e),f=angular.element("html, body");if(!r)return void console.error("Could not scroll to the ref `%s` that has not been already defined.",e);var l=r.offset().top;n.onlyUp&&angular.element(window).scrollTop()<=l||(!n.onlyOutOfScreen||t(r))&&(n.toParent&&(f=r.parent(),l=0),f.animate({scrollTop:l}))}function t(e){var n=angular.element(window),o=n.scrollTop(),r=o+n.height(),t=e.offset().top;return t>r-100||o>t}var f={};return{add:e,remove:n,get:o,scrollTo:r}}).directive("ljRef",["Ref",function(e){return{restrict:"A",scope:!0,link:function(n,o,r){var t=r.ljRef;e.add(t,o),n.$on("$destroy",function(){e.remove(t)})}}}])}();
/* <<< file end: js/core/angular/ref.js */

//# map link was there [ref.js.map]
/* >>> file start: js/core/angular/bubble.js */
//= require js/core/angular/ref.js
Site.page.template['Widgets/ljBubble.tmpl'] = '<div\n    class=\"\n        b-popup\n        bubble-node\n        b-popup-withclosecontrol\n        b-bubble-{{bubble.name}}\n        \"\n    ng-show=\"show\"\n    lj-switch-off=\"show\"\n    lj-switch-off-action=\"bubble.close()\"\n    ng-style=\"{ left: position.x, top: position.y, visibility: visibility }\"\n    ng-class=\"{\n        \'b-popup-noclosecontrol\': !bubble.options.closeControl\n    }\"\n    lj-switch-off-skip>\n    <div class=\"b-popup-outer\">\n        <div class=\"b-popup-inner\">\n            <i class=\"i-popup-arr\" ng-class=\"arrowClass()\">\n                <i class=\"i-popup-arr-brdr-outer\">\n                    <i class=\"i-popup-arr-brdr-inner\">\n                        <i class=\"i-popup-arr-bg\"></i>\n                    </i>\n                </i>\n            </i>\n            <div ng-include src=\"template\"></div>\n            <i class=\"i-popup-close\" ng-click=\"bubble.close()\"></i>\n        </div>\n    </div>\n</div>\n';
Site.page.template['angular/confirm.bubble.ng.tmpl'] = '<div class=\"b-popup-content b-popup-options-centered\">\n  <div class=\"b-popup-content-header\">\n    <span>{{ bubble.options.header }}</span>\n  </div>\n  <div class=\"b-popup-content-confirm\" ng-bind-html=\"bubble.options.text\"></div>\n  <div class=\"b-popup-submit-options\">\n    <button class=\"b-popup-btn b-flatbutton b-flatbutton-simple\" ng-click=\"bubble.options.confirm()\">{{ bubble.options.yes }}</button>\n    <button class=\"b-popup-cancel b-flatbutton b-flatbutton-simple b-flatbutton-neutral\" ng-click=\"bubble.close()\">{{ bubble.options.no }}</button>\n  </div>\n</div>\n';
//= require_ml confirm.bubble.yes
//= require_ml confirm.bubble.no
!function(){"use strict";function e(e,o,t,n,r){return{scope:!0,link:function(i,l,a){function u(){var e=i.arrow.vertical,o=i.arrow.horizontal;i.visibility="hidden",$.keepInitialWidth&&!$.widthSaved&&($.widthSaved=!0,C.width(C.width())),f(),d()&&(i.arrow.vertical="b"===e?c("alwaysTop")?"b":"t":c("alwaysBottom")?"t":"b"),p()&&(i.arrow.horizontal="l"===o?c("alwaysRight")?"l":"r":c("alwaysLeft")?"r":"l"),i.arrow.horizontal!==o||i.arrow.vertical!==e?n(s):i.visibility="visible"}function s(){return f(),p()&&!c("aside")&&i.arrow.horizontal?(i.arrow.horizontal="",void s()):void(i.visibility="visible")}function c(e){return i.bubble.options[e]||$[e]}function f(){var o=e.node||l,t=o.offset().left+Math.floor(o.outerWidth()/2),n=i.bubble.options.forceX||0,r=i.bubble.options.forceY||0;c("aside")?(i.position.x="r"===i.arrow.horizontal?o.offset().left-C.outerWidth()-B.outerWidth()+n:o.offset().left+o.outerWidth()+B.outerWidth()+n,i.position.y=o.offset().top-B.position().top+(o.outerHeight()-B.outerHeight())/2+r):(i.position.x=i.arrow.horizontal?t-B.position().left-Math.floor(B.outerWidth()/2)-2+n:t-C.outerWidth()/2-Math.floor(B.outerWidth()/4)-2+n,i.position.y="t"===i.arrow.vertical?o.offset().top+o.outerHeight()+B.outerHeight()+r:o.offset().top-B.outerHeight()-C.outerHeight()+r)}function b(){i.position.x=-9999}function d(){var e=L.scrollTop();return i.position.y<e||i.bubble.options.aside?!0:i.position.y+C.outerHeight()>e+L.outerHeight()}function p(){var e=L.scrollLeft();return i.position.x<e||i.bubble.options.aside?!0:i.position.x+C.outerWidth()>e+L.outerWidth()}function h(o){o.preventDefault(),e.current!==$.name&&n(function(){e.open($.name)})}function v(){m(),x&&(y=n(e.close,x))}function m(){n.cancel(y)}function w(){m(),e.close()}function g(){i.show&&n(W)}var y,$=o(a.ljBubble)(i),z=$.name,C=t(r.get("ljBubble.tmpl"))(i),W=LJ.Function.throttle(u,50),B=C.find(".i-popup-arr"),L=angular.element(window),j=$.eventType||"click",x=Number($.autoClose||0);i.show=!1,e._register(z,$),i.template=$.template||z+".html",i.bubble={name:z,close:e.close,options:e.options(z)},i.clear=function(){i.arrow={vertical:$.arrowInitialVertical||"t",horizontal:$.arrowInitialHorizontal||"l"}},i.position={x:-9999,y:-9999},i.visibility="hidden",i.arrowClass=function(){var e=i.bubble.options,o=i.arrow.vertical,t=i.arrow.horizontal;return e.aside||$.aside?"i-popup-arr"+t+o:"i-popup-arr"+o+t},i.$watch(function(){return e.current},function(e){b(),n(function(){i.show=e===z,e&&i.show&&(i.clear(),n(W))})},!0),$.disableClick||l.on(j,h),$.disableResizeListener||L.on("resize",g),$.recalculateOnOrientationChange&&L.on("orientationchange",function(){g(),L.on("resize",g),n(function(){L.off("resize",g)},1e3)}),$.recalculateOnScroll&&L.on("scroll",g),$.closeOnScroll&&L.on("scroll",w),angular.element("body").append(C),l.on("mouseleave",v),C.on("mouseenter",m),C.on("mouseleave",v),i.clear(),i.$on("$destroy",function(){l.off(j,h),L.off("resize",g),L.off("scroll",g),L.off("scroll",e.close),l.off("mouseleave",v),C.off("mouseenter",m),C.off("mouseleave",v),e._unregister(z),C.remove()})}}}function o(e,o,t,n,r,i){var l={},a={},u="p-openpopup";return l.current=null,l.node=null,l.register=function(){function t(t,l){var a,u,s;return t&&t.name&&t.template?(a=t.name,t.disableClick=!0,r[a]?(r[a].count+=1,n.bind(null,a)):(u=angular.element("<div />").attr("lj-bubble",angular.toJson(t)),s="undefined"==typeof l,s&&(l=e.$new(!0)),u.appendTo("body"),o(u)(l),r[a]={count:1,node:u,scope:l,isScopeCreated:s},n.bind(null,a))):void i.error("Incorrect bubble options. You should provide name and template.",t)}function n(e){var o=r[e];o&&(o.count-=1,0===o.count&&(o.isScopeCreated||o.scope.$destroy(),o.node.remove(),delete r[e]))}var r={};return t}(),l.exists=function(e){return a.hasOwnProperty(e)},l._register=function(e,o){var t;if(a.hasOwnProperty(e))throw"Warning: bubble with name "+e+" has been registered before!";t=angular.isDefined(o)?angular.copy(o):{},t=angular.extend({closeControl:!0},t),a[e]=Object.create(t)},l._unregister=function(e){delete a[e],l.current===e&&(l.current=null)},l.confirm=function(e){function o(){r.scrollBy(0,1),r.scrollBy(0,-1)}var t=LJ.ml("confirm.bubble.yes"),i=LJ.ml("confirm.bubble.no"),a={closeControl:!1,confirm:e.confirm,header:e.header,text:e.text,yes:e.yes||t,no:e.no||i};l.open(e.id,a),n(o),n(o,100),n(o,200),n(o,300)},l.open=function(o,n,r){return a.hasOwnProperty(o)?(n instanceof jQuery&&(r=n,n={}),angular.isString(n)&&(r=t.get(n),n={}),angular.isObject(n)&&l.options(o,n),r instanceof jQuery&&(l.node=r),angular.isString(r)&&(l.node=t.get(r)),l.current=o,e.$broadcast("bubble:open",o,n,r),e.$broadcast("bubble:open:"+o,o,n,r),void angular.element("body").addClass(u)):void i.error("Bubble `"+o+"` can't be opened, it has not been registered yet.")},l.close=function(){var o,t=l.current,n=a[t];e.$broadcast("bubble:close",t,n,l.node),e.$broadcast("bubble:close:"+t,t,n,l.node);for(o in n)n.hasOwnProperty(o)&&delete n[o];l.current=null,l.node=null,angular.element("body").removeClass(u)},l.options=function(e,o){return"undefined"==typeof o||o===a[e]?a[e]:void angular.copy(o,a[e])},l}angular.module("LJ.Bubble",["LJ.Templates","LJ.Directives","LJ.Ref"]),angular.module("LJ.Bubble").factory("Bubble",o).directive("ljBubble",e),e.$inject=["Bubble","$parse","$compile","$timeout","$templateCache"],o.$inject=["$rootScope","$compile","Ref","$timeout","$window","$log"]}();
/* <<< file end: js/core/angular/bubble.js */

//# map link was there [bubble.js.map]
/* >>> file start: js/core/angular/activity.js */
!function(){"use strict";function t(t,n){function c(){return u}function e(t){u=t}function i(){n.cancel(o),e(!0),o=n(e.bind(this,!1),9e5)}var u,o;return i(),t.on("click touchstart touchend keydown mousemove mousewheel",LJ.Function.debounce(i,100,!0)),{isActive:c}}angular.module("LJ.Activity",[]),angular.module("LJ.Activity").factory("Activity",t),t.$inject=["$document","$timeout"]}();
/* <<< file end: js/core/angular/activity.js */

//# map link was there [activity.js.map]
/* >>> file start: js/core/angular/api.js */
//!= require js/core/angular/messages.js
//= require js/core/angular/activity.js
!function(){"use strict";function e(e,n,t,r,a,c){function i(e,n){return"undefined"==typeof n?e:e+angular.toJson(s(n))}function s(e){var n;return angular.isObject(e)?(n={},Object.keys(e).sort().forEach(function(t){n[t]=s(e[t])}),n):e}function o(e,n){f.remove(i(e,n))}function u(n,s,o,u){var g,l,p=r.defer(),d={cache:!1,silent:!1,meta:!1},m=!1;return c.isActive()?(angular.isObject(s)&&null!==s||(s={}),angular.isObject(o)&&(u=o,o=null),u=angular.extend(d,u||{}),l=i(n,s),u.cache&&(g=f.get(l),g&&(m=!0)),m||(g=p.promise,LJ.Api.call(n,s,function(n){e(function(){n.error?p.reject(n.error):p.resolve(n),t.$apply()},0)}),u.cache&&f.put(l,g)),LJ.Event.trigger("api:request:change",n,!0),g.then(function(){LJ.Event.trigger("api:request:change",n,!1)}),u.silent||g.then(function(e){var n={};"undefined"!=typeof e.message&&(angular.isString(e.message)?(n.body=e.message,n.type="success"):(n.body=e.message.content,n.type="success"),a.add(n))},function(e){"undefined"!=typeof e.message&&1!==e.code&&a.error({body:e.message})}),u.meta&&(g=g.then(function(e){return{response:e,fromCache:m}})),angular.isFunction(o)&&g.then(o),g):(p.reject(),p.promise)}var g={call:u,invalidate:o},f=n("LJApiPromises");return g}angular.module("LJ.Api",["LJ.Messages","LJ.Activity"]).factory("Api",e),e.$inject=["$timeout","$cacheFactory","$rootScope","$q","Messages","Activity"]}();
/* <<< file end: js/core/angular/api.js */

//# map link was there [api.js.map]
/* >>> file start: js/core/angular/options.js */
function _typeof(n){return n&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n}angular.module("LJ.Options",[]).factory("Options",[function(){return{create:function(n){function e(e,t){"undefined"==typeof t?angular.extend(n,e):n[e]=t}function t(e){return n[e]}function o(){return n}if("undefined"==typeof n&&(n={}),"object"!==("undefined"==typeof n?"undefined":_typeof(n)))throw new TypeError("Options should be an object.");return{set:e,get:t,raw:o}}}}]);
/* <<< file end: js/core/angular/options.js */

//# map link was there [options.js.map]
/* >>> file start: js/core/angular/users.js */
//= require js/core/angular/api.js
//= require js/core/angular/options.js
!function(e){return e}(),function(){"use strict";angular.module("Users",["LJ.Api","LJ.Options"]).factory("Relations",["$q","$timeout","UsersCache",function(e,n,r){function t(t,i,u){var a=e.defer(),s={addFriend:{is_invite_sent:!0},removeFriend:{is_friend:!1},subscribe:{is_subscribedon:!0},unsubscribe:{is_subscribedon:!1},join:{is_invite_sent:!0},leave:{is_member:!1},setBan:{is_banned:!0},setUnban:{is_banned:!1}},o={addFriend:{is_invite_sent:!1},removeFriend:{is_friend:!0},subscribe:{is_subscribedon:!1},unsubscribe:{is_subscribedon:!0},join:{is_invite_sent:!1},leave:{is_member:!0},setBan:{is_banned:!1},setUnban:{is_banned:!0}},c=angular.copy(r.get(t)||{});return angular.isUndefined(u)&&(u={}),u.wait||r.update(t,s[i]||{}),LJ.Event.trigger("relations.change",{username:t,action:i,callback:function(e){n(function(){if(e.error)return u.wait||r.update(t,angular.extend(o[i],c)),void a.reject(e.error.message);var n=LJ.Object.pick(e,"is_banned","is_friend","is_member","is_subscriber","is_subscribedon","is_friend_of","is_invite_sent");r.update(t,n),a.resolve(e)})}}),a.promise}function i(e,n,i){var u=t(e,n?"subscribe":"unsubscribe",i);return n||u.then(function(){r.update(e,{filtermask:0})}),u}function u(e,n,r){return t(e,n?"addFriend":"removeFriend",r)}function a(e,n,r){return t(e,n?"join":"leave",r)}function s(e,n,r){return t(e,n?"setBan":"setUnban",r)}function o(e,n,r){return t(e,n?"banEverywhere":"unbanEverywhere",r)}return{toggleFriend:u,toggleSubscription:i,toggleMember:a,toggleBan:s,toggleBanEverywhere:o}}]).factory("Mask",function(){function e(e){return e>>>0}var n={};return n.change=function(n,r){var t=r.add,i=r.remove;return angular.isDefined(t)&&(angular.isArray(t)||(t=[t]),n=t.reduce(function(n,r){return e(n|Math.pow(2,r))},n)),angular.isDefined(i)&&(angular.isArray(i)||(i=[i]),n=i.reduce(function(n,r){var t=Math.pow(2,32)-1-Math.pow(2,r);return e(n&t)},n)),n},n.check=function(e,n){var r=Math.pow(2,n);return Boolean(e&r)},n}).factory("UsersCache",["$q","$cacheFactory","Options",function(e,n,r){function t(e){if(!angular.isUndefined(e)){var n=l.get(f.get("journal"))||{},r=e;return angular.isArray(e)||(e=[e]),e.forEach(function(e){if(e&&angular.isObject(e)&&!angular.isUndefined(e.username)){var r=n[e.username];n[e.username]=r?angular.extend(r,e):e}}),l.put(f.get("journal"),n),r}}function i(e){var n=l.get(f.get("journal"));return Boolean(n[e])}function u(e){var n;if(angular.isString(e))return n=l.get(f.get("journal")),n&&n[e]?n[e]:null;if(angular.isFunction(e))return s(e);if(angular.isUndefined(e))return s();throw new TypeError("Incorrect argument passed.")}function a(e){var n=l.get(f.get("journal"));return n||angular.isObject(n)?Object.keys(n).reduce(function(r,t){return String(n[t].id)===String(e)?n[t]:r},null):null}function s(e){var n,r=l.get(f.get("journal")),t=[];for(n in r)if(r.hasOwnProperty(n)){if(e&&!e(r[n]))continue;t.push(r[n])}return t}function o(e,n){var r=u(e)||{username:e};return angular.extend(r,n),t(r),r}var c,l=n("users"),f=r.create({journal:LJ.get("remoteUser")});return c={add:t,update:o,set:f.set,get:u,getById:a,exists:i}}]).factory("Users",["$q","$timeout","Api","Mask","UsersCache","Options",function(e,n,r,t,i,u){function a(e){return k[C.get("type")][e]}function s(e){return"subscriptions"===C.get("type")?Boolean(e.is_subscribedon):!0}function o(e,n){return angular.isUndefined(n)?e[c()]||1:void(e[c()]=n)}function c(){return"subscriptions"===C.get("type")?"filtermask":"groupmask"}function l(e,n,t){return r.call("user.get",{target:e,fields:n},t).then(function(e){var n=e.user;return i.add(n),n})}function f(e,n,t){return r.call("user.get",{targetid:e,fields:n},t).then(function(e){var n=e.user;return i.add(n),n})}function d(e,n){return r.call("relations.list_friends",{journal:C.get("journal"),fields:e},n).then(_("is_friend"))}function g(e){return r.call("groups.list_users",{journal:C.get("journal"),fields:e}).then(function(e){return i.add(e.users),e})}function p(e){return r.call("relations.list_subscriptions",{journal:C.get("journal"),fields:e}).then(_("is_subscribedon"))}function b(e){return r.call("relations.list_banned",{journal:C.get("journal"),fields:e}).then(_("is_banned"))}function _(e){return function(n){var r=n.users;return r.forEach(LJ.Function.set(e,!0)),i.add(r),r}}function v(e){return r.call("relations."+e+"_count").then(function(e){return e.count})}function h(n){return angular.isArray(n)||(n=[n]),0===n.length?e.reject("You should provide users to sync."):r.call(a("update"),{users:n,journal:C.get("journal")}).then(function(e){return i.add(e.users),e})}function m(e,n){var r=i.get(e);return r?t.check(o(r),n):!1}function j(e){return e.filter(i.exists).map(i.get).filter(s)}function y(e){var n=(e.filter||"").toLowerCase(),r=i.get(function(r){return s(r)&&t.check(o(r),e.id)?n&&-1===r.display_username.toLowerCase().indexOf(n)?!1:!0:!1});return e.limit&&(r=r.slice(0,e.limit)),r}function U(e){var n=(e.filter||"").toLowerCase(),r=i.get(function(r){return s(r)?t.check(o(r),e.id)?!1:n&&-1===r.display_username.toLowerCase().indexOf(n)?!1:!0:!1});return e.limit&&(r=r.slice(0,e.limit)),r}function w(e,n){angular.isArray(n)||(n=[n]);var r;return r="subscriptions"===C.get("type")?j(n):n.map(function(e){return i.get(e)||{username:e}}),r.forEach(function(n){o(n,t.change(o(n),{add:e}))}),h(r)}function L(e,n,r){angular.isArray(n)||(n=[n]);var i=j(n);return i.forEach(function(n){o(n,t.change(o(n),{remove:e}))}),r&&r.silent?void 0:h(i)}function E(e,n){return i.update(e,{alias:n}),r.call("user.alias_set",{target:e,alias:n})}function F(e){return function(n,r){return n[e].toLowerCase().localeCompare(r[e].toLowerCase())}}function O(){var e,n=C.get("journal");C.set.apply(null,arguments),e=C.get("journal"),e!==n&&i.set("journal",e)}var k={friends:{read:"relations.list_friends",readOne:"relations.get_friend",update:"groups.update_users"},subscriptions:{read:"relations.list_subscriptions",readOne:"relations.get_subscription",update:"filters.update_users"}},C=u.create({type:"friends",journal:LJ.get("remoteUser")});return{USERHEAD_FIELDS:{alias:1,journal_url:1,profile_url:1,userhead_url:1,is_invisible:1,journaltype:1},set:O,get:C.get,Cache:i,fetchUser:l,fetchUserById:f,fetchBanned:b,fetchFriends:d,fetchGroupUsers:g,fetchSubscriptions:p,fetchCount:v,sync:h,alias:E,isUserInGroup:m,getExisting:j,fromGroup:y,outOfGroup:U,addToGroup:w,removeFromGroup:L,comparator:F}}])}();
/* <<< file end: js/core/angular/users.js */

//# map link was there [users.js.map]
/* >>> file start: js/core/angular/ljUser.js */
//= require js/core/angular/api.js
//= require js/core/angular/users.js
Site.page.template['angular/ljUser.ng.tmpl'] = '<span\n    class=\"\n        ljuser\n        i-ljuser\n        i-ljuser-type-{{user.journaltype}}\n        \"\n    ng-class=\"{\n        \'i-ljuser-deleted\': user.is_invisible,\n        \'i-ljuser-nopopup noctxpopup\': user.noctxpopup,\n        \'i-ljuser-withalias\': user.alias,\n        \'i-ljuser-showalias\': user.showalias\n    }\"\n    data-ljuser=\"{{user.username}}\"\n    lj:user=\"{{user.username}}\"\n    ><!--\n\n    Userhead\n    --><a\n        class=\"i-ljuser-profile\"\n        ng-href=\"{{user.profile_url}}\"\n        ng-attr-target=\"{{user.target ? user.target : \'_self\'}}\"\n        ><!--\n        --><img\n            class=\"i-ljuser-userhead\"\n            ng-src=\"{{user.userhead_url}}\"\n            ><!--\n    --></a><!--\n\n    Username\n    --><a\n        class=\"i-ljuser-username\"\n        ng-href=\"{{user.journal_url}}\"\n        ng-attr-title=\"{{user.display_username || user.alias}}\"\n        ng-attr-target=\"{{user.target ? user.target : \'_self\'}}\"\n        ><b ng-bind=\"user.display_name || user.display_username\"></b></a><!--\n\n    Alias\n    --><span\n        class=\"i-ljuser-alias\"\n        ng-bind=\"user.alias\"\n        ></span><!--\n\n--></span>\n';
!function(){"use strict";function e(e,r,n,t,a,u,s){function c(e){var r=n.defer(),t=s.Cache.get(e);return t&&t.userhead_url?(r.resolve(t),r.promise):s.fetchUser(e,s.USERHEAD_FIELDS,{cache:!0,silent:!0})}function i(e){var r=n.defer(),t=s.Cache.getById(e);return t&&t.userhead_url?(r.resolve(t),r.promise):s.fetchUserById(e,s.USERHEAD_FIELDS,{cache:!0,silent:!0})}function l(r,t){var i=n.defer(),l=e.$new();return c(r).then(function(){var e;l.user=angular.extend({},s.Cache.get(r),t||{}),e=a(d)(l),u(function(){i.resolve(p.empty().append(e).html()),l.$destroy()})}),i.promise}function o(r,t){var c=n.defer(),l=e.$new();return i(r).then(function(){var e;l.user=angular.extend({},s.Cache.getById(r),t||{}),e=a(d)(l),u(function(){c.resolve(p.empty().append(e).html()),l.$destroy()})}),c.promise}var p=angular.element("<div />"),d=t.get("ljUser.ng.tmpl");return{prepare:c,prepareById:i,getById:o,get:l}}function r(e,r,n){return{templateUrl:"ljUser.ng.tmpl",replace:!0,scope:!0,compile:function(t,a){var u=e(a.ljUserDynamic),s=e(a.ljUserDynamicOptions);return function(e){var t=s(e);e.$watch(function(){return u(e)},function(a){var u=a;e.user=angular.extend({username:u,display_username:u},t||{}),n.prepare(u).then(function(){e.$watch(function(){return r.Cache.get(u)},function(r){angular.extend(e.user,r)},!0)})})}}}}function n(e,r,n){return{templateUrl:"ljUser.ng.tmpl",replace:!0,scope:!0,compile:function(t,a){return function(t){var u=e(a.ljUserById)(t),s=e(a.ljUserByIdOptions)(t);t.user=angular.extend({username:"user-"+u,display_username:"user-"+u},s||{}),n.prepareById(u).then(function(){t.$watch(function(){return r.Cache.getById(u)},function(e){angular.extend(t.user,e)},!0)})}}}}angular.module("LJ.User",["LJ.Api","LJ.Templates","Users"]),angular.module("LJ.User").factory("ljUser",e).directive("ljUserById",n).directive("ljUserDynamic",r),e.$inject=["$rootScope","Api","$q","$templateCache","$compile","$timeout","Users"],r.$inject=["$parse","Users","ljUser"],n.$inject=["$parse","Users","ljUser"]}();
/* <<< file end: js/core/angular/ljUser.js */

//# map link was there [ljUser.js.map]
/* >>> file start: js/settings/services/filters/filters.js */
//= require js/core/angular/api.js
//= require js/core/angular/options.js
//= require js/core/angular/users.js
!function(t){return t}(),function(){"use strict";angular.module("GroupsAndFilters.Services.Filters",["LJ.Api","LJ.Options","Users"]).filter("filtersOrder",function(){return function(t){var r=t.slice(0);return r.sort(function(t,r){if(31===t.id)return-1;if(31===r.id)return 1;var e=t.name.toLowerCase(),i=r.name.toLowerCase();return e>i?1:-1}),r}}).factory("FilterGroupFactory",["$q","$timeout","Api","Options","Users",function(t,r,e,i,n){function o(){angular.extend(this,{MAX_COUNT:31,filters:[],key:"filters",rpc:{}},i.create({journal:LJ.get("remoteUser")}))}return o.prototype.toJSON=function(t){var r=angular.copy(t);return delete r.checked,delete r.users,r},o.prototype.nextId=function(){for(var t=null,r=this.filters.map(LJ.Function.get("id")),e=1,i=this.MAX_COUNT;i>e&&null===t;)-1===r.indexOf(e)&&(t=e),e+=1;return t},o.prototype.sync=function(t){var r={};return angular.isArray(t)||(t=[t]),r[this.key]=t.map(this.toJSON),r.journal=this.get("journal"),e.call(this.rpc.update,r)},o.prototype.fetch=function(t){var r=this,i={journal:this.get("journal")};return t=angular.extend(t||{},{cache:!1}),e.call(this.rpc.read,i,t).then(function(t){return r.filters=t[r.key],r.filters})},o.prototype._isNameUniq=function(t){var r=this.filters.map(function(t){return t.name.toLowerCase()});return t=t.toLowerCase(),-1===r.indexOf(t)},o.prototype.create=function(r){var i;return r=r.trim(),0===r.length?t.reject("filters"===this.key?LJ.ml("api.error.filters.filter_name_not_specified"):LJ.ml("api.error.groups.group_name_not_specified")):this._isNameUniq(r)?(i={id:this.nextId(),name:r,users:[],"public":!1,journal:this.get("journal")},this.filters.push(i),e.call(this.rpc.create,i)):t.reject("filters"===this.key?LJ.ml("api.error.filters.filter_already_exist",{name:r}):LJ.ml("api.error.groups.group_already_exist",{name:r}))},o.prototype.remove=function(t){var r=this,i={};return t=Array.isArray(t)?t:[t],i[this.key]=t.map(LJ.Function.get("id")),i.journal=this.get("journal"),t.forEach(function(t){r.filters.splice(r.filters.indexOf(t),1)}),e.call(this.rpc.remove,i)},o.prototype.getCount=function(){return e.call(this.rpc.count,{journal:this.get("journal")}).then(LJ.Function.get("count"))},o.prototype.by=function(t){var r=n.Cache.get(t);return r?this.filters.filter(function(r){return n.isUserInGroup(t,r.id)}):[]},o}]).factory("Filter",["FilterGroupFactory",function(t){function r(){this.rpc={create:"filters.create",read:"filters.list",update:"filters.update",remove:"filters.remove",count:"filters.count"},this.key="filters"}return r.prototype=new t,r.prototype._setPrivacy=function(t,r){return t=Array.isArray(t)?t:[t],t.forEach(LJ.Function.set("public","public"===r)),this.sync(t)},r.prototype["private"]=function(t){return this._setPrivacy(t,"private")},r.prototype["public"]=function(t){return this._setPrivacy(t,"public")},new r}]).factory("Group",["FilterGroupFactory",function(t){function r(){this.rpc={create:"groups.create",read:"groups.list",update:"groups.update",remove:"groups.remove",count:"groups.count"},this.key="groups"}return r.prototype=new t,new r}])}();
/* <<< file end: js/settings/services/filters/filters.js */

//# map link was there [filters.js.map]
/* >>> file start: js/settings/directives/filtersFor.js */
//!= require js/core/angular/messages.js
LJ.injectStyle('/* >>> file start: stc/widgets/filter-settings.css */\n.b-filterset{max-width:290px;font:14px/1.4 Arial,sans-serif;color:#000}.b-filterset-addnew-input,.b-filterset-list LABEL{display:block;white-space:nowrap;line-height:1.333}.b-filterset B,.b-filterset CODE,.b-filterset DD,.b-filterset DIV,.b-filterset DT,.b-filterset EM,.b-filterset I,.b-filterset KBD,.b-filterset LABEL,.b-filterset LI,.b-filterset P,.b-filterset PRE,.b-filterset SPAN,.b-filterset STRONG,.b-filterset TD,.b-filterset TH{font-size:100%}.b-filterset .i-ljuser-userhead{vertical-align:top!important;margin:1px 0 0!important;border:none!important}.b-filterset .i-ljuser-username:active,.b-filterset .i-ljuser-username:hover,.b-filterset .i-ljuser-username:link,.b-filterset .i-ljuser-username:visited{color:#0051B7!important;text-decoration:none!important;border:none!important}.b-filterset .b-filterset-subtitle,.b-filterset .b-filterset-title{margin:0 1.142em .5em 0!important;color:#222!important}.b-filterset .b-filterset-title{font-weight:700!important}.b-filterset-list{position:relative;z-index:1;overflow:auto;max-height:14em;min-width:220px;margin:0 0 .3em;padding:0;background-attachment:scroll;background-clip:border-box;background-image:-webkit-radial-gradient(50% 0,farthest-side,rgba(0,0,0,.1),transparent),-webkit-radial-gradient(50% 100%,farthest-side,rgba(0,0,0,.1),transparent);background-image:radial-gradient(farthest-side at 50% 0,rgba(0,0,0,.1),transparent),radial-gradient(farthest-side at 50% 100%,rgba(0,0,0,.1),transparent);background-origin:padding-box;background-position:0 0,0 100%;background-repeat:no-repeat;background-size:100% 7px}.b-filterset-list:after,.b-filterset-list:before{position:relative;z-index:-1;display:block;content:\"\";height:14px;margin:0 0 -14px;background:-webkit-linear-gradient(top,#F4F5F6,#F4F5F6 30%,rgba(244,245,246,0));background:linear-gradient(to bottom,#F4F5F6,#F4F5F6 30%,rgba(244,245,246,0))}.b-filterset-list:after{margin:-14px 0 0;background:-webkit-linear-gradient(top,rgba(228,229,233,0),#E4E5E9 70%,#E4E5E9);background:linear-gradient(to bottom,rgba(228,229,233,0),#E4E5E9 70%,#E4E5E9)}.b-filterset-list LI{margin:0;padding:0;list-style-type:none}.b-filterset-list LI.loading{background:url(/img/preloader/preloader-blue-gray.gif?v=16423) 100% 50% no-repeat}.b-filterset-list LABEL{font-size:.857em}.b-filterset-list LABEL:hover{background:#7292BD;color:#FFF}.b-filterset-addnew-input{margin:0 0 .5em;font-size:.857em}.b-filterset-addnew{margin:.5em 0 0}.b-filterset-pseudo{font-size:.857em;color:#0051B7}.b-filterset-submit{text-align:right}.b-filterset-loader:after,.b-filterset-loader:before{display:inline-block;visibility:hidden;content:\'\';width:21px;height:21px;margin:-2px 0 0 4px;background:url(/img/preloader/preloader-blue-gray.gif?v=16423) 50% 50% no-repeat;vertical-align:middle}.b-filterset-loader-after:before,.b-filterset-loader-before:after{display:none}.b-filterset-loading .b-filterset-loader-after:after,.b-filterset-loading .b-filterset-loader-before:before{visibility:visible}\n/* <<< file end: stc/widgets/filter-settings.css */\n\n/*# sourceMappingURL=filter-settings.css.map */\n');
Site.page.template['angular/controlstrip/filters.ng.tmpl'] = '<div class=\"b-filterset-body\" ng-class=\"{ \'b-filterset-loading\': model.loading }\">\n    <ul class=\"b-filterset-section b-filterset-list\">\n        <li ng-repeat=\"filter in filters | filtersOrder\" ng-class=\"{ \'loading\': loading[filter.id] }\">\n            <label>\n                <input\n                    ng-checked=\"checked = isActive(filter.id)\"\n                    ng-change=\"toggleFilter(filter.id, checked)\"\n                    ng-model=\"checked\"\n                    type=\"checkbox\"\n                    class=\"b-filterset-checkbox\"\n                    >{{filter.name}}\n            </label>\n        </li>\n\n        <li ng-show=\"model.showCreateDialog\">\n            <span class=\"b-filterset-addnew-input\" >\n                <form ng-submit=\"createFilter()\">\n                    <input\n                        ng-model=\"model.newFilter\"\n                        focus-and-select=\"model.showCreateDialog\"\n                        type=\"text\"\n                        />\n                    <input type=\"submit\" lj-ml=\"filterset.button.save\" lj-ml-attr=\"value\" />\n                </form>\n            </span>\n        </li>\n    </ul>\n\n    <div\n        ng-hide=\"model.showCreateDialog || isFiltersCountReached()\"\n        class=\"b-filterset-section b-filterset-addnew\">\n        <span\n            ng-if=\"isFiltersFor\"\n            ng-click=\"model.showCreateDialog = true\"\n            lj-ml=\"filterset.link.addnewfilter\"\n            class=\"b-filterset-pseudo b-pseudo\"\n            ></span>\n        <span\n            ng-if=\"isGroupsFor\"\n            ng-click=\"model.showCreateDialog = true\"\n            lj-ml=\"filterset.link.addnewgroup\"\n            class=\"b-filterset-pseudo b-pseudo\"\n            ></span>\n    </div>\n</div>\n';
!function(e){return e}(),function(){"use strict";function e(e,r,t,n,o,i){function l(){return Array.isArray(e.usernames)?e.usernames:[e.usernames]}e.loading={},e.filters=[],t.fetch({cache:!0}).then(function(r){e.filters=r}),e.model={newFilter:"",showCreateDialog:!1},e.toggleFilter=function(r,t){var o;i.clear(),e.loading[r]=!0,o=t?n.addToGroup(r,l()):n.removeFromGroup(r,l()),o.then(function(){e.loading[r]=!1})},e.isActive=function(e){var r=l().every(function(r){return n.isUserInGroup(r,e)});return r},e.isCountReached=function(){return e.filters.length>=t.MAX_COUNT},e.createFilter=function(){var r=e.model.newFilter.trim();e.resetFilter(),0!==r.length&&(e.model.loading=!0,t.create(r).then(function(r){var t=r.filter;n.addToGroup(t.id,l()).then(function(){e.model.loading=!1})}))},e.resetFilter=function(){e.model.newFilter="",e.model.showCreateDialog=!1},e.$on("bubble:open:controlstrip",e.resetFilter)}angular.module("Filters.List",[]).controller("FiltersForCtrl",["$scope","$q","Filter","Users","Bubble","Messages",e]).controller("GroupsForCtrl",["$scope","$q","Group","Users","Bubble","Messages",e]).directive("filtersFor",[function(){return{controller:"FiltersForCtrl",scope:{usernames:"=filtersFor"},templateUrl:"filters.ng.tmpl",link:function(e){e.isFiltersFor=!0}}}]).directive("groupsFor",[function(){return{controller:"GroupsForCtrl",scope:{usernames:"=groupsFor"},templateUrl:"filters.ng.tmpl",link:function(e){e.isGroupsFor=!0}}}])}();
/* <<< file end: js/settings/directives/filtersFor.js */

//# map link was there [filtersFor.js.map]
/* >>> file start: js/relations/menu.js */
//= require js/core/angular/bubble.js
//= require js/core/angular/ljUser.js
//!= require js/core/angular/messages.js
//= require js/settings/services/filters/filters.js
//= require js/core/angular/users.js
//= require js/settings/directives/filtersFor.js
Site.page.template['angular/controlstrip/controlstrip.ng.tmpl'] = '<div\n  class=\"b-filterset\"\n  ng-class=\"{ \'b-filterset-loading\': loading }\"\n  >\n\n  <!-- subscribe user -->\n  <div class=\"b-filterset-title\" ng-show=\"mode == \'subscribe\'\" lj-ml=\"filterset.title.subscribed.journal\" lj-ml-resolve=\"mlResolve\"></div>\n\n  <!-- add user -->\n  <div class=\"b-filterset-title\" ng-show=\"mode == \'add\'\" lj-ml=\"filterset.title.addfriend.journal\" lj-ml-resolve=\"mlResolve\"></div>\n  <div class=\"b-filterset-subtitle\" ng-show=\"mode == \'add\'\" lj-ml=\"filterset.subtitle.addfriend.journal\" lj-ml-resolve=\"mlResolve\"></div>\n\n  <!-- subscribe community -->\n  <div class=\"b-filterset-title\" ng-show=\"mode == \'watch\'\" lj-ml=\"filterset.title.subscribed.community\" lj-ml-resolve=\"mlResolve\"></div>\n\n  <!-- join community -->\n  <div class=\"b-filterset-title\" ng-show=\"mode == \'join\' || mode == \'joinSubscribed\'\" lj-ml=\"filterset.title.join\"></div>\n  <div class=\"b-filterset-subtitle\" ng-show=\"mode == \'join\'\" lj-ml=\"filterset.subtitle.join\" lj-ml-resolve=\"mlResolve\"></div>\n  <div class=\"b-filterset-section b-filterset-submit\" ng-show=\"mode == \'join\'\">\n      <div class=\"b-ljbutton b-filterset-loader b-filterset-loader-before\">\n          <input type=\"submit\" lj-ml=\"filterset.submit.subscribe\" lj-ml-attr=\"value\" ng-click=\"subscribeAfterJoin()\" />\n      </div>\n  </div>\n\n  <!-- filters section -->\n  <!-- Notice: extra div here is because of bug in AngularJS: https://github.com/angular/angular.js/issues/3981 -->\n\n  <div ng-show=\"mode !== \'join\'\">\n    <div\n      class=\"b-filterset-subtitle b-filterset-loader b-filterset-loader-after\"\n      lj-ml=\"filterset.subtitle.filters\"\n      ></div>\n      <div filters-for=\"username\"></div>\n  </div>\n</div>\n';
!function(e){return e}(),function(e){"use strict";function t(e){LJ.Track.event("Relations","Menu",e)}angular.module("Relations.Menu",["LJ.Templates","LJ.Bubble","LJ.Directives","LJ.User","LJ.Messages","GroupsAndFilters.Services.Filters","Users","Filters.List"]).value("$anchorScroll",null).controller("MenuCtrl",["$scope","Bubble","$timeout","$q","ljUser","Filter","Users","Relations","Messages",function(n,s,r,i,o,u,c,a,l){function b(e,t){var s;switch(t&&d(t),e){case"addFriend":s=a.toggleFriend(h,!0,{wait:!0});break;case"removeFriend":s=a.toggleFriend(h,!1,{wait:!0});break;case"join":s=a.toggleMember(h,!0,{wait:!0});break;case"leave":s=a.toggleMember(h,!1,{wait:!0});break;case"subscribe":s=a.toggleSubscription(h,!0,{wait:!0});break;case"unsubscribe":s=a.toggleSubscription(h,!1,{wait:!0})}return s["finally"](m).then(function(t){return ContextualPopup.currentElement===v.find(".ljuser img").get(0)&&ContextualPopup.hide(),t.error?i.reject(t.error.message):(t.message&&(t.message.body=t.message.content,l.add(t.message)),"undefined"!=typeof t.controlstrip_status&&(n.status=t.controlstrip_status),"subscribe"===e||"addFriend"===e||"join"===e&&t.is_subscribedon?f():void(n.filters=[]))},function(e){l.error({body:e})})}function f(){var e,t=c.Cache.get(h);return t.is_subscribedon?(e=t.filtermask?i.defer().resolve():c.fetchUser(h,{filtermask:1}),i.all({filters:u.fetch({cache:!0}),user:e}).then(function(e){n.filters=e.filters})):i.reject()}function d(e){g&&m(),g=(new Hourglass).setEvent(e).show()}function m(){g&&(g.remove(),g=null)}var g,p,v=e(".w-cs-status"),h=LJ.get("journal.username");c.set({type:"subscriptions"}),n.username=h,n.filters=[],n.status=LJ.get("controlstrip.status"),c.Cache.add(LJ.get("journal")),ContextualPopup.showNote=angular.identity,p=i.defer(),n.mlResolve={promise:p.promise},o.get(h,{noctxpopup:!0}).then(function(e){p.resolve({username:e})}),n.$watch(function(){return c.Cache.get(h)},function(e){n.states=LJ.Object.pick(e,"is_friend","is_member","is_subscribedon","is_invite_sent")},!0),n.toggleLoading=function(e){n.loading=e},LJ.Event.on("relations.change",function(){r(l.clear)}),n.subscribe=function(e){e.preventDefault(),t("subscribe"),b("subscribe",e).then(function(){n.states.is_subscribedon&&(n.mode="subscribe",s.open("controlstrip","unsubscribe"))})},n.unsubscribe=function(e){e.preventDefault(),t("unsubscribe"),b("unsubscribe",e)},n.addFriend=function(e){e.preventDefault(),t("add friend"),b("addFriend",e).then(function(){n.states.is_friend&&(n.mode="add",s.open("controlstrip","removeFriend"))})},n.removeFriend=function(e){e.preventDefault(),t("remove friend"),b("removeFriend",e)},n.watch=function(e){e.preventDefault(),t("subscribe to community"),b("subscribe",e).then(function(){n.states.is_subscribedon&&(n.mode="watch",s.open("controlstrip","unwatch"))})},n.unwatch=function(e){e.preventDefault(),t("unsubscribe from community"),b("unsubscribe",e)},n.join=function(e){e.preventDefault(),t("join community"),b("join",e).then(function(){n.states.is_member&&(n.mode=n.states.is_subscribedon?"joinSubscribed":"join",s.open("controlstrip","leave"))})},n.leave=function(e){e.preventDefault(),t("leave community"),b("leave",e)},n.subscribeAfterJoin=function(){n.toggleLoading(!0),t("subscribe to community (after join)"),b("subscribe").then(function(){n.toggleLoading(!1),n.mode="watch"})}}])}(jQuery);
/* <<< file end: js/relations/menu.js */

//# map link was there [menu.js.map]
/* >>> file start: js/controlstrip.js */
//= require js/jquery/jquery.calendarEvents.js
//= require js/relations/menu.js
!function(e){return e}(),function(e){"use strict";function t(){var t,o,n,r;LJ.get("remoteUser")&&(t=e(".s-header .s-header-extra-filter, #lj_controlstrip_new .w-cs-filter-inner"),0!==t.length&&(o=e("#sortByPoster"),n=o.find("[name=poster]"),r=o.find("[type=image]"),t.bubble({target:".s-header .w-cs-filter-icon, #lj_controlstrip_new .w-cs-filter-icon",showOn:"click",closeControl:!0,classNames:{containerAddClass:"b-bubble-filter"}}),n.input(function(){this.value.length?r.css("opacity",1).prop("disabled",!1):r.css("opacity",0).prop("disabled",!0)}),o.on("submit",function(e){n.val().length||e.preventDefault()})))}function o(){e(".s-header input[placeholder], #lj_controlstrip_new input[placeholder]").labeledPlaceholder()}function n(){t(),o(),LJ.Flags.isEnabled("new_friends_and_subscriptions")&&!r&&angular.bootstrap(e("[data-controlstrip]"),["Relations.Menu"]),function(){function t(e){var t=e.split(",").map(Number);return new Date(t[0],t[1],t[2])}var o=e(".s-header .w-cs-i-calendar a, #lj_controlstrip_new .w-cs-i-calendar a"),n=/^\/friends/.test(location.pathname),r=LJ.get("current_journal.url_journal"),l=LJ.get("controlstrip.calendar.earlyDate"),a=LJ.get("controlstrip.calendar.lastDate");o.length&&(o.calendar({showOn:"click",closeControl:!0,bubbleClass:!0,dayRef:r+"/"+(n?"friends/":"")+"%Y/%M/%D",allRefs:n,startMonth:l?t(LJ.get("controlstrip.calendar.earlyDate")):new Date,endMonth:a?t(LJ.get("controlstrip.calendar.lastDate")):new Date,classNames:{container:"w-cs-calendar"},ml:{caption:LJ.ml("web.controlstrip.view.calendar")}}).on("daySelected",function(e){e.preventDefault()}),n||o.calendarEvents({fetchOnFirstDisplay:!0}))}(),e(".b-loginpopup").bubble({target:".i-auth-control",closeControl:!1,showOn:"click"}),e("input.text").labeledPlaceholder(),e("html").trigger("controlstrip-initialized")}var r=Boolean("undefined"!=typeof document.documentMode&&document.documentMode<8);e(function(){return 0!==e(".s-header, #lj_controlstrip_new").length||"xcolibur"===Site.page.scheme?void n():void e.get(LiveJournal.getAjaxUrl("controlstrip"),{user:LJ.get("currentJournal")},function(t){e(".body-content").length?e(t).prependTo(".body-content"):(e("html").removeClass("html-adaptive"),e(t).appendTo(document.body)),n()})}),e(function(){function t(t){var o=e("."+l.showElem+":not("+t+")");e(o).removeClass(l.showElem)}function o(){var t=e("."+l.showElem);t.length>0?e(r.bodyElem).addClass(l.showFader):e(r.bodyElem).removeClass(l.showFader)}function n(){var t=e("."+l.showElem);t.length>0?a.catchBlur=!0:a.catchBlur=!1}var r={bodyElem:e("body"),controls:e(".js--show-elem"),controlsHover:e(".js--show-elem-by-hover"),fader:e(".b-fader")},l={control:"js--show-elem",controlHover:"js--show-elem-by-hover",showElem:"js--is-shown",showFader:"js--show-fader",catchBlur:"js--catch-blur"},a={catchBlur:!1};e(document).on("click",function(){a.catchBlur&&t()}),e(r.controlsHover).hover(function(){var t=e(this).find("."+l.control),o={selector:e(t).data("elem")};e(o.selector).addClass(l.showElem)},function(){var t=e(this).find("."+l.control),o={selector:e(t).data("elem")};e(o.selector).removeClass(l.showElem),e(this).addClass(l.controlHover)}),e(r.controls).on("click",function(r){var a={selector:e(this).data("elem"),isShowFader:e(this).data("fader")||!1,isUseBlur:e(this).data("blur")||!1};t(a.selector),e(a.selector).toggleClass(l.showElem),e(this).parent().hasClass(l.controlHover)&&e(this).parent().removeClass(l.controlHover),a.isShowFader&&o(),a.isUseBlur&&n(),r.stopPropagation(),r.preventDefault()}),e(r.fader).on("click",function(){t(),e(r.bodyElem).removeClass(l.showFader)})})}(jQuery);
/* <<< file end: js/controlstrip.js */

//# map link was there [controlstrip.js.map]
/* >>> file start: js/lib/jquery.selectric.min.js */
!function(e){"use strict";var t="selectric",s="Input Items Open Disabled TempShow HideSelect Wrapper Hover Responsive Above Scroll",o=".sl",i={onChange:function(t){e(t).change()},maxHeight:300,keySearchTimeout:500,arrowButtonMarkup:'<b class="button">&#x25be;</b>',disableOnMobile:!0,openOnHover:!1,expandToItemText:!1,responsive:!1,preventWindowScroll:!0,inheritOriginalWidth:!1,customClass:{prefix:t,postfixes:s,camelCase:!0,overwrite:!0},optionsItemBuilder:"{text}"},n={add:function(e,t,s){this[e]||(this[e]={}),this[e][t]=s},remove:function(e,t){delete this[e][t]}},a={replaceDiacritics:function(e){for(var t="40-46 50-53 54-57 62-70 71-74 61 47 77".replace(/\d+/g,"\\3$&").split(" "),s=t.length;s--;)e=e.toLowerCase().replace(RegExp("["+t[s]+"]","g"),"aeiouncy".charAt(s));return e},format:function(e){var t=arguments;return(""+e).replace(/{(\d+|(\w+))}/g,function(e,s,o){return o&&t[1]?t[1][o]:t[s]})},nextEnabledItem:function(e,t){for(;e[t=(t+1)%e.length].disabled;);return t},previousEnabledItem:function(e,t){for(;e[t=(t>0?t:e.length)-1].disabled;);return t},toDash:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},triggerCallback:function(s,o){var i=o.element,l=o.options["on"+s];e.isFunction(l)&&l.call(i,i,o),n[s]&&e.each(n[s],function(){this.call(i,i,o)}),e(i).trigger(t+"-"+a.toDash(s),o)}},l=e(document),r=e(window),c=function(n,c){function d(t){if($.options=e.extend(!0,{},i,$.options,t),$.classes={},$.element=n,a.triggerCallback("BeforeInit",$),$.options.disableOnMobile&&L)return void($.disableOnMobile=!0);C(!0);var o=$.options.customClass,l=o.postfixes.split(" "),r=R.width();e.each(s.split(" "),function(e,t){var s=o.prefix+l[e];$.classes[t.toLowerCase()]=o.camelCase?s:a.toDash(s)}),x=e("<input/>",{"class":$.classes.input,readonly:L}),k=e("<div/>",{"class":$.classes.items,tabindex:-1}),T=e("<div/>",{"class":$.classes.scroll}),D=e("<div/>",{"class":o.prefix,html:$.options.arrowButtonMarkup}),y=e('<p class="label"/>'),I=R.wrap("<div>").parent().append(D.prepend(y),k,x),A={open:v,close:g,destroy:C,refresh:u,init:d},R.on(A).wrap('<div class="'+$.classes.hideselect+'">'),e.extend($,A),$.options.inheritOriginalWidth&&r>0&&I.width(r),p()}function p(){$.items=[];var t=R.children(),s="<ul>",i=t.filter(":selected").index();H=S=~i?i:0,(E=t.length)&&(t.each(function(t){var o=e(this),i=o.html(),n=o.prop("disabled"),l=$.options.optionsItemBuilder;$.items[t]={value:o.val(),text:i,slug:a.replaceDiacritics(i),disabled:n},s+=a.format('<li class="{1}">{2}</li>',e.trim([t==H?"selected":"",t==E-1?"last":"",n?"disabled":""].join(" ")),e.isFunction(l)?l($.items[t],o,t):a.format(l,$.items[t]))}),k.append(T.html(s+"</ul>")),y.html($.items[H].text)),D.add(R).add(I).add(x).off(o),I.prop("class",[$.classes.wrapper,$.options.customClass.overwrite?R.prop("class").replace(/\S+/g,$.options.customClass.prefix+"-$&"):R.prop("class"),$.options.responsive?$.classes.responsive:""].join(" ")),R.prop("disabled")?(I.addClass($.classes.disabled),x.prop("disabled",!0)):(j=!0,I.removeClass($.classes.disabled).on("mouseenter"+o+" mouseleave"+o,function(t){e(this).toggleClass($.classes.hover),$.options.openOnHover&&(clearTimeout($.closeTimer),"mouseleave"==t.type?$.closeTimer=setTimeout(g,500):v())}),D.on("click"+o,function(e){Y?g():v(e)}),x.prop({tabindex:q,disabled:!1}).on("keypress"+o,h).on("keydown"+o,function(e){h(e),clearTimeout($.resetStr),$.resetStr=setTimeout(function(){x.val("")},$.options.keySearchTimeout);var t=e.keyCode||e.which;t>36&&41>t&&b(a[(39>t?"previous":"next")+"EnabledItem"]($.items,S))}).on("focusin"+o,function(e){x.one("blur",function(){x.blur()}),Y||v(e)}).on("oninput"in x[0]?"input":"keyup",function(){x.val().length&&e.each($.items,function(e,t){return RegExp("^"+x.val(),"i").test(t.slug)&&!t.disabled?(b(e),!1):void 0})}),R.prop("tabindex",!1),O=e("li",k.removeAttr("style")).click(function(){return b(e(this).index(),!0),!1})),a.triggerCallback("Init",$)}function u(){a.triggerCallback("Refresh",$),p()}function h(e){var t=e.keyCode||e.which;13==t&&e.preventDefault(),/^(9|13|27)$/.test(t)&&(e.stopPropagation(),b(S,!0))}function f(){var e=k.closest(":visible").children(":hidden"),t=$.options.maxHeight;e.addClass($.classes.tempshow);var s=k.outerWidth(),o=D.outerWidth()-(s-k.width());!$.options.expandToItemText||o>s?W=o:(k.css("overflow","scroll"),I.width(9e4),W=k.width(),k.css("overflow",""),I.width("")),k.width(W).height()>t&&k.height(t),e.removeClass($.classes.tempshow)}function v(s){a.triggerCallback("BeforeOpen",$),s&&(s.preventDefault(),s.stopPropagation()),j&&(f(),e("."+$.classes.hideselect,"."+$.classes.open).children()[t]("close"),Y=!0,B=k.outerHeight(),M=k.height(),x.val("").is(":focus")||x.focus(),l.on("click"+o,g).on("scroll"+o,m),m(),$.options.preventWindowScroll&&l.on("mousewheel"+o+" DOMMouseScroll"+o,"."+$.classes.scroll,function(t){var s=t.originalEvent,o=e(this).scrollTop(),i=0;"detail"in s&&(i=-1*s.detail),"wheelDelta"in s&&(i=s.wheelDelta),"wheelDeltaY"in s&&(i=s.wheelDeltaY),"deltaY"in s&&(i=-1*s.deltaY),(o==this.scrollHeight-M&&0>i||0==o&&i>0)&&t.preventDefault()}),I.addClass($.classes.open),w(S),a.triggerCallback("Open",$))}function m(){f(),I.toggleClass($.classes.above,I.offset().top+I.outerHeight()+B>r.scrollTop()+r.height())}function g(){if(a.triggerCallback("BeforeClose",$),H!=S){a.triggerCallback("BeforeChange",$);var e=$.items[S].text;R.prop("selectedIndex",H=S).data("value",e),y.html(e),a.triggerCallback("Change",$)}l.off(o),I.removeClass($.classes.open),Y=!1,a.triggerCallback("Close",$)}function b(e,t){$.items[e].disabled||(O.removeClass("selected").eq(S=e).addClass("selected"),w(e),t&&g())}function w(e){var t=O.eq(e).outerHeight(),s=O[e].offsetTop,o=T.scrollTop(),i=s+2*t;T.scrollTop(i>o+B?i-B:o>s-t?s-t:o)}function C(e){j&&(k.add(D).add(x).remove(),!e&&R.removeData(t).removeData("value"),R.prop("tabindex",q).off(o).off(A).unwrap().unwrap(),j=!1)}var x,k,T,D,y,I,O,S,H,B,M,W,E,A,$=this,R=e(n),Y=!1,j=!1,L=/android|ip(hone|od|ad)/i.test(navigator.userAgent),q=R.prop("tabindex");d(c)};e.fn[t]=function(s){return this.each(function(){var o=e.data(this,t);o&&!o.disableOnMobile?""+s===s&&o[s]?o[s]():o.init(s):e.data(this,t,new c(this,s))})},e.fn[t].hooks=n}(jQuery);
/* <<< file end: js/lib/jquery.selectric.min.js */

//# map link was there [jquery.selectric.min.js.map]
/* >>> file start: js/captcha.js */
!function(e){return e}(),function(e){"use strict";function c(){return"undefined"!=typeof _}function a(){var c=e.Deferred();return"keycaptcha"===LJ.Captcha.current?(c.resolve(),c.promise()):(p?c.resolve(p):LJ.Api.call("captcha.get_public_key",{},function(e){p=e.captcha_public,c.resolve(p)}),c.promise())}function t(){return"solve_media_captcha"===LJ.Captcha.current?"https:"===location.protocol?"https://api-secure.solvemedia.com/papi/challenge.ajax":"http://api.solvemedia.com/papi/challenge.ajax":location.protocol+"//www.google.com/recaptcha/api/js/recaptcha_ajax.js"}function n(t,n){var o=e.Deferred();return n=e.extend(d,n||{}),LJ.Captcha.current?e.when(a(),l()).then(function(){c()?_.create(p,t,n):console.error("Something went wrong. Captcha object is not defined.")}):(o.resolve(),o.promise())}function o(){c()&&_.destroy()}function i(){c()&&_.reload.apply(null,arguments)}function r(){return c()?"keycaptcha"===LJ.Captcha.current?null:_.get_challenge():void 0}function s(){return c()?"keycaptcha"===LJ.Captcha.current?e("#"+window.s_s_c_captcha_field_id).val():_.get_response():void 0}LJ.define("LJ.Captcha"),LJ.Captcha={create:n,reload:i,destroy:o,getChallenge:r,getResponse:s,isDefined:c,responseFieldName:LJ.Flags.isEnabled("solve_media_captcha")?"adcopy_response":"recaptcha_response_field",current:["keycaptcha","solve_media_captcha","recaptcha"].filter(LJ.Flags.isEnabled).shift()};var p,_,d={lang:"ru"},l=LJ.Function.once(function(){var c=e.Deferred();return window.ACPuzzleOptions={onload:function(){_=ACPuzzle,c.resolve()}},"keycaptcha"===LJ.Captcha.current?LJ.Api.call("captcha.get_public_key",{},function(a){var t=LJ.get("page.captcha_field_id")||"capcode";window.s_s_c_user_id=a.user_id,window.s_s_c_session_id=a.session_id,window.s_s_c_captcha_field_id=LJ.get("page.captcha_field_id")||"capcode",window.s_s_c_submit_button_id=LJ.get("page.submitbtn_id")||"createpage_create",window.s_s_c_web_server_sign=a.server_sign,window.s_s_c_web_server_sign2=a.server_sign2,e("#"+t).before('<input type="hidden" name="captcha_type" value='+LJ.Captcha.current+">"),LJ.injectScript(location.protocol+"//backs.keycaptcha.com/swfs/cap.js").then(function(){_={create:function(){},destroy:function(){},reload:function(e){e&&window.s_s_c_onload&&window.s_s_c_onload(e,window.s_s_c_captcha_field_id,window.s_s_c_submit_button_id)}},c.resolve()})}):LJ.injectScript(t()).then(function(){"solve_media_captcha"!==LJ.Captcha.current&&(_=Recaptcha,c.resolve())}),c.promise()})}(jQuery);
/* <<< file end: js/captcha.js */

//# map link was there [captcha.js.map]
/* >>> file start: js/scheme/schemius/feedback.js */
!function(e){"use strict";e(function(){function t(){s.addClass("p-feedback"),o=!0,u.val(r),LJ.get("remote")||LJ.Captcha.create("b-captcha",{tabindex:50}),n.bubble("hide")}var a=this,s=e("body"),o=!1,r=e(".js-feedback").attr("data-spcatid"),n=e(".s-welcometo"),c=e(".s-do-item-feedback"),l=e(".s-feedback"),i=l.find(".s-feedback-error"),d=l.find(".b-bubble-success-inner"),u=l.find('.s-feedback-body .s-feedback-form input[name="spcatid"]'),f={inprogress:"s-feedback-creating",done:"s-feedback-successfully",error:"s-feedback-erroneously"};e(".js-feedback").on("click",function(e){e.preventDefault(),t()}),this.setState=function(e){l.toggleClass(f.inprogress,"inprogress"===e),l.toggleClass(f.done,"done"===e),l.toggleClass(f.error,"error"===e)},l.on("click",".s-feedback-submit",function(t){var s={};t.preventDefault(),a.setState("inprogress"),l.find("input, textarea, select").each(function(){s[this.name]=e(this).val()}),LJ.Api.call("support.create_request",s,function(t){return t.error?(i.html(t.error.message),a.setState("error")):(d.html(e("<a>").attr("href",t.request.url).html(t.request.url)),void a.setState("done"))})}).on("click",".s-feedback-another",function(t){t.preventDefault(),l.find("input, textarea").each(function(){e(this).val("")}),LJ.Captcha.reload(),a.setState(null)}),n.bubble({target:c,showOn:"click",alwaysShowUnderTarget:!0,arrowWidth:"auto"}).on("click",".s-welcometo-action .b-flatbutton",function(e){e.preventDefault(),t()}).on("click",".s-welcometo-switcher",function(e){return e.preventDefault(),LJ.get("remote")?void LJ.Api.call("settings.set_old_design",{value:1},function(){location.reload()}):(LJ.Cookie.setGlobal("ljold",1,{expires:7}),void location.reload())}),s.on("click",function(t){var r=e(t.target);o&&(r.hasClass("b-fader")||r.hasClass("s-feedback-close"))&&(s.removeClass("p-feedback"),u.val(""),o=!1,a.setState(null),LJ.get("remote")||LJ.Captcha.destroy())})})}(jQuery);
/* <<< file end: js/scheme/schemius/feedback.js */

//# map link was there [feedback.js.map]
/* >>> file start: js/scheme/schemius.js */
//= require js/lib/jquery.selectric.min.js
//= require js/captcha.js
//= require js/scheme/schemius/feedback.js
!function(e){return e}(),function(e){"use strict";function s(){function s(e){return!!(e.ctrlKey||e.metaKey&&LJ.Support.isMac)}function o(e){e&&(e.stopPropagation(),e.preventDefault()),L.removeClass(S),L.removeClass(v),u.removeClass(S),u.removeClass(v)}function t(s){s&&(s.preventDefault(),s.stopPropagation()),c(),n(),L.addClass(S),setTimeout(function(){e("#user").focus()},300)}function n(){LJ.Event.trigger("Messages:closeByMenus"),u.toggleClass(v)}function a(e){e&&LJ.Api.call("lang.set",{lang:e},function(){location.reload()})}var l,i,r,c,u,d,p,m,g,v,h,f,C,b,w,k,L=e(document.body),y=e(".s-header"),J=e(".s-inline-search-input"),j=e(".s-do-item-search-btn"),x="p-show-search",A=!1,S="p-loginform",T=e(".s-nav-item-lang"),D="s-nav-item-lang-open",I=function(e){s(e)||(y.toggleClass(x),y.hasClass(x)&&(A=!0,setTimeout(function(){J.focus()},500)))};LJ&&LJ.Util&&LJ.Util.Action&&(LJ.Util.Action.login=t),j.on("click",I),J.on("click",function(){A=!0}),L.on("click",function(){A||(y.removeClass(x),T.removeClass(D)),A=!1}),L.on("gesturestart",function(s){(e("html").hasClass("p-nav-common-menu-open")||e("html").hasClass("p-nav-user-menu-open"))&&s.preventDefault()}),navigator.userAgent.match(/Trident/)&&navigator.userAgent.match(/rv[ :]11/)&&e("html").addClass("html-ie11"),u=e("html"),u.addClass(LJ.Support.isMobile()?"html-mobile":"html-desktop"),~navigator.userAgent.toLowerCase().indexOf("android")?u.addClass("html-android"):~navigator.userAgent.toLowerCase().indexOf("iphone")||~navigator.userAgent.toLowerCase().indexOf("ipad")?u.addClass("html-ios"):~navigator.userAgent.toLowerCase().indexOf("windows phone")&&u.addClass("html-wphone"),e("[data-lang]").on("click",function(){a(e(this).data("lang"))}),T.on("click",function(e){s(e)||(e.preventDefault(),T.toggleClass(D),A=T.hasClass(D))}),e(".s-lang-select").selectric({customClass:{prefix:"b-selectus",postfixes:"Input Items Open Disabled TempShow HideSelect Wrapper Hover Responsive Above Scroll",camelCase:!1,overwrite:!1}}).on("change",function(){a(e(this).val())}),e(".selectricus").selectric({customClass:{prefix:"b-selectus",postfixes:"Input Items Open Disabled TempShow HideSelect Wrapper Hover Responsive Above Scroll",camelCase:!1,overwrite:!1}}),e(".b-message-mobile-close").one("click",function(){e(".b-message-mobile").hide()}),C=e(".s-drop-master"),b="s-drop-open",w=LJ.Support.isMobile(),k=!1,w||(f=e(":lj-bubble"),C.on("mouseenter",function(){var s=e(this),o=300;k&&(clearTimeout(h),o=0),h=setTimeout(function(){C.removeClass(b),s.addClass(b),k=!0,f.bubble("hide")},o)}).on("mouseleave",function(){var s=e(this);return k?void(h=setTimeout(function(){s.removeClass(b),k=!1},500)):(clearTimeout(h),void s.removeClass(b))})),w&&(C.on("click",function(s){var o=e(this),t=0!==o.find("li").length,n=e(s.target).closest("span").is(".s-header-extra-menu-item-link-icon");"input"!==s.target.tagName.toLowerCase()&&(o.hasClass(b)||!t||n||s.preventDefault(),o.hasClass(b)||n||(k=!0,C.removeClass(b),s.stopPropagation(),e(":lj-bubble").bubble("hide")),o.toggleClass(b))}),L.on("click",function(s){var o=0===e(s.target).closest(C).length,t=e(s.target).is(".b-popup");t&&(s.stopPropagation(),e(":lj-bubble").bubble("hide")),k&&o&&(k=!1,C.removeClass(b),s.preventDefault())}),LJ.Support.isMobile&&LJ.Support.browser.safari&&L.addClass("iphone"),e(".l-flatslide-menu-active, .l-flatslide-menu-expander").click(function(s){s.preventDefault(),e(this).closest(".l-flatslide-menu").toggleClass("l-flatslide-menu-expanded")}),e(".s-header-search, .s-header-item-search__form").removeAttr("target")),u=e("html"),d=e(".s-body"),p=e(".s-nav-control-common"),m=e(".s-nav-control-user, .s-nav-control-login"),g="p-nav-common-menu-open",v="p-nav-user-menu-open",p.on("click",function(){LJ.Event.trigger("Messages:closeByMenus"),u.toggleClass(g)}),m.on("click",n),c=function(){u.removeClass(g),u.removeClass(v)},d.on("click",function(){c(),o()}),e(".s-nav-item-login").on("click",t),e(".b-loginform-close").on("click",o),e(document).on("keyup",function(e){("Escape"===e.key||27===e.keyCode)&&o(e)}),e(".b-fader").on("click",o),e(".lj-openid-auth-button").on("click",function(s){s.preventDefault(),e(".b-loginform").toggleClass("openid-auth-state"),e(".b-loginform").hasClass("openid-auth-state")?e("#openid").focus():e("#user").focus()}),LJ.Event.on("userpic.changed",function(s){e(".s-userpic").css("backgroundImage","url("+s+")")}),!LJ.Flags.isEnabled("ljwelcomevideo")||w||LJ.get("remote")||LJ.Cookie.get("welcome_ljvideo")||0!==LJ.get("remote_is_sup")||e(".appwidget-login").length||LJ.injectScript("http://www.youtube.com/player_api").then(function(){function s(e){(0===e.data||2===e.data)&&t.addClass("s-ljvideo-end"),1===e.data&&t.removeClass("s-ljvideo-end")}var o,t=e(".s-ljvideo");L.addClass("p-ljvideo"),window.onYouTubePlayerAPIReady=function(){o=new window.YT.Player("s-ljvideo-player",{width:"640",height:"360",videoId:"wq0YmQ4xIeU",playerVars:{rel:0},events:{onStateChange:s}})},e(".b-fader, .s-ljvideo-close").on("click",function(){L.hasClass("p-ljvideo")&&(L.removeClass("p-ljvideo"),o.destroy(),LJ.Cookie.setGlobal("welcome_ljvideo",1,{expires:14}))})}),r=e(".s-header .i-supus-new, .s-header-messages-count"),LJ.Event.on("message:count:change",function(e){e>0?(r.html(e),r.removeClass("s-header-messages-count-empty")):r.addClass("s-header-messages-count-empty")}),i=e(".flatquestion-nojs-friendsgroups"),l=e(".flatquestion-popup-field-showanswer"),e(".flatquestion-popup-select").on("change",function(){"custom"===e(this).val()?i.show():i.hide(),"public"===e(this).val()?l.show():l.hide()})}e(function(){0===e(".s-header").length?e("html").on("controlstrip-initialized",s):s()})}(jQuery);
/* <<< file end: js/scheme/schemius.js */

//# map link was there [schemius.js.map]
/* >>> file start: js/jquery/jquery.lj.repostbutton.js */
LJ.UI.registerTemplate('templates-CleanHtml-PaidRepost', "<span class=\" b-flatrepost repost-button {{if $data.reposted}} b-flatrepost-reposted {{/if}} {{if $data.count}} b-flatrepost-counted {{/if}} {{if $data.budget || $data.cost}} b-flatrepost-gained {{/if}} {{if $data.owner}} b-flatrepost-disabled {{/if}} {{if $data.login}} b-flatrepost-disabled {{/if}} \" ><a href=\"javascript:void(0);\" data-href=\"{{html $data.url}}\" class=\"b-flatrepost-name\" title=\"{{if $data.reposted}}{{html LJ.mltext(\'entry.reference.label.title\')}}{{else}}{{if $data.login}}{{html LJ.mltext(\'repost.button.title.login\')}}{{else}}{{if $data.owner}}{{html LJ.mltext(\'repost.button.title.myown\')}}{{else}}{{html LJ.mltext(\'repost.button.title\')}}{{/if}}{{/if}}{{/if}}\" ><span class=\"b-flatrepost-gain\" title=\"{{html $data.budget}}{{html LJ.mltext(\'paidrepost.button.title.curr\')}}\" >{{if !$data.owner}}+{{html $data.cost}}{{else $data.budget}}{{html $data.budget}}{{/if}}</span></a><span class=\"b-flatrepost-counter\" title=\"{{html LJ.mltext(\'repost.button.counter\')}}\" >{{html $data.count}}</span></span> ", 'JQuery.stat');
LJ.UI.registerTemplate('templates-CleanHtml-Repost', "<span class=\" b-flatrepost repost-button {{if $data.reposted}} b-flatrepost-reposted {{/if}} {{if $data.count}} b-flatrepost-counted {{/if}} {{if $data.budget}} b-flatrepost-gained {{/if}} {{if $data.owner}} b-flatrepost-disabled {{/if}} {{if $data.login}} b-flatrepost-disabled {{/if}} \" ><a href=\"javascript:void(0);\" data-href=\"{{html $data.url}}\" class=\"b-flatrepost-name\" title=\"{{if $data.reposted}}{{html LJ.mltext(\'entry.reference.label.title\')}}{{else}}{{if $data.login}}{{html LJ.mltext(\'repost.button.title.login\')}}{{else}}{{if $data.owner}}{{html LJ.mltext(\'repost.button.title.myown\')}}{{else}}{{html LJ.mltext(\'repost.button.title\')}}{{/if}}{{/if}}{{/if}}\" ><span class=\"b-flatrepost-gain\" title=\"{{html $data.budget}}{{html LJ.mltext(\'paidrepost.button.title.curr\')}}\" >{{if !$data.owner}}+{{html $data.cost}}{{else $data.budget}}{{html $data.budget}}{{/if}}</span></a><span class=\"b-flatrepost-counter\" title=\"{{html LJ.mltext(\'repost.button.counter\')}}\" >{{html $data.count}}</span></span> ", 'JQuery.stat');
LJ.UI.registerTemplate('templates-CleanHtml-reposted', "{{if $data.content}} {{each ($value.users || $data.users)}}{{if !((!$index) && !($value.dropComma || $data.dropComma))}}, {{/if}}<a href=\"{{html ($value.url || $data.url)}}\">{{html ($value.user || $data.user)}}</a>{{/each}} {{else}} <div class=\"b-reposted-popup\"> <div class=\"b-reposted-popup-header\">{{html LJ.mltext(\'repost.popup.head\')}}</div> <div class=\"b-reposted-popup-content b-reposted-popup-load\"></div> <div class=\"b-reposted-popup-footer\"><a href=\"javascript:void(0);\">{{html LJ.mltext(\'repost.popup.footer\')}}</a></div> </div> {{/if}} ", 'JQuery.stat');
!function(t){return t}(),function(t){"use strict";t.widget("lj.repostbutton",t.lj.basicWidget,{options:{classNames:{active:"repost-button-active",inactive:"repost-button-inactive",popupLoad:"b-reposted-popup-load",popupNomore:"b-reposted-popup-footer-hide",repostError:"repost-error"},selectors:{counterParent:".lj-button-c",button:".lj-button-b",counter:".lj-like-item-count",buttonLink:".lj-button-link",popupContent:".b-reposted-popup-content",popupFooter:".b-reposted-popup-footer",popupMore:".b-reposted-popup-footer > a"},templates:{popup:"templates-CleanHtml-reposted"},url:"",reposted:!1,cost:0,budget:0,paid:!1},_create:function(){this.options.classNames={active:"b-flatrepost-reposted",inactive:"b-flatrepost-disabled",popupLoad:"b-reposted-popup-load",popupNomore:"b-reposted-popup-footer-hide",repostError:"repost-error"},this.options.selectors={counterParent:".b-flatrepost-counter",button:".b-flatrepost-name",counter:".b-flatrepost-counter",buttonLink:".b-flatrepost-name",popupContent:".b-reposted-popup-content",popupFooter:".b-reposted-popup-footer",popupMore:".b-reposted-popup-footer > a"},t.lj.basicWidget.prototype._create.apply(this),this.options.url||console.warn(this.widgetName,": no url in options, initialization won't continue"),this._journal=LJ.get("currentJournal"),this._count=null,this._remote=LJ.get("remoteUser"),this._reposted=this.options.reposted,this._el("buttonLink"),this._href=this.element.find(this._s("button")).data("href"),this._href=LJ.Util.Journal.parseLink(this._href)||{},this._canRepost()||(this.element.addClass(this._cl("inactive")),this._buttonLink.removeAttr("title"),this._lock()),this._popup=null,this._popupContent=null,this._popupLocked=!1,this._lastUser=null,this._el("counterParent"),this._el("counter"),Number(this._counter.html())||this._hideCounter(),this._bindControls()},_hideCounter:function(){this._counterParent.addClass("empty")},_showCounter:function(){this._counterParent.removeClass("empty")},_bindControls:function(){var e=this;this.element.on("click",this._s("button"),this._onUpdateButton.bind(this)),this._counterParent.one("click",function(){Number(e._counter.html())&&(e._popup=e._tmpl("popup"),e._el("popupFooter",e._popup),e._popupContent=e._popup.find(e._s("popupContent")),e._popup.bubble({showOn:"click",align:"side",alwaysShowUnderTarget:!0,target:e._counterParent}).on("bubblehide",function(){e._lastUser=null,e._popupContent.empty(),e._popupFooter.removeClass(e._cl("popupNomore"))}).on("bubbleshow",function(){e._loadRepostedList()}).on("click",e._s("popupMore"),e._loadRepostedList.bind(e)),Function.defer(function(){e._popup.bubble("show")}))}),t.lj.basicWidget.prototype._bindControls.apply(e)},_loadRepostedList:function(t){var e=this;t&&t.preventDefault(),this._popupLocked||(this._popupLocked=!0,this._popupContent.addClass(this._cl("popupLoad")),LJ.Api.call("repost.get_list",{url:this.options.url,last:this._lastUser},function(t){e._popupContent.removeClass(e._cl("popupLoad")),e._popupLocked=!1,t.error?e._handleAnswer(t):(e._render(t.users,t.nomore,t.count),e._lastUser=t.last)}))},_render:function(t,e,o){var s=this;t.length>0&&s._tmpl("popup",{content:!0,dropComma:!!s._lastUser,users:t}).appendTo(s._popupContent),this._updateCounter(o),e&&s._popupFooter.addClass(s._cl("popupNomore"))},_onUpdateButton:function(t){this.locked()||this.toggleRepost(),t.preventDefault()},_handleAnswer:function(t){if(t.hasOwnProperty("delete")&&(t.message&&this._showMessage(t.message),this.paid!==Boolean(t.paid)||this.paid&&this.cost!==t.cost))return void this.element.replaceWith(LJ.Social.renderRepostButton(this.options.url,t));if(t.error){if(t.error.message&&this._showMessage(t.error.message),t.error.data)return void this.element.replaceWith(LJ.Social.renderRepostButton(this.options.url,t.error.data))}else this._updateButton(!this._reposted);!t.hasOwnProperty("count")&&t.hasOwnProperty("delete")&&(t.count=this._count-1),this._updateCounter(t.count),this._unlock()},_showMessage:function(e){var o=t("<div />",{"class":this._cl("repostError"),text:e}).bubble({target:this.element,align:"center",hide:function(){o.remove()}}).bubble("show")},_updateButton:function(t){this._reposted=t,this.element.toggleClass(this._cl("active"),this._reposted)},_updateCounter:function(t){"undefined"!=typeof t&&(this._count=Number(t),this._counter.html(this._count)),Number(this._counter.html())?this._showCounter():this._hideCounter()},_canRepost:function(){return LJ.get("preview")?!1:this._remote?LJ.get("remote_is_identity")?!1:this._remote===this._href.journal?!1:!0:!1},toggleRepost:function(){var t=this,e={url:this.options.url};this._canRepost()&&(null===this._count&&(this._count=parseInt(this._el("counter").html(),10)||0),this._lock(),this._reposted?LJ.Api.call("repost.delete",e,function(e){e.error||e.reposted||t._journal!==t._remote||location.href.match(/\/(friends|times|feed)\b/)?t._handleAnswer(e):location.reload()}):(e.timezone=LJ.Util.Date.timezone(),this.options.paid&&(e.cost=this.options.cost),LJ.Api.call("repost.create",e,this._handleAnswer.bind(this))))}})}(jQuery);
/* <<< file end: js/jquery/jquery.lj.repostbutton.js */

//# map link was there [jquery.lj.repostbutton.js.map]
/* >>> file start: js/threeposts.js */
!function(t){return t}(),function(t){"use strict";t(function(){function e(){var t=3,e={7:4,8:4,9:3};return t=e[v]>0?e[v]:v}function i(){var t=1;if(M>H)return t=1;if(v>=2){t=Math.floor(H/M),t>v&&(t=v);var e=v%t;if(e>0)if(v%(t-1)===0)t--;else if(v%(t+1)===0)t++;else if(1===e){var i=H/(t+1);i>=E&&t++}}return t}function n(){H=u.width(),b=O>H?i():e(),s(H/b)}function s(t){var e=[150,300,330,400,500,600,800],i=["xxs","xs","s","m","l","xl","xxl"];e.forEach(function(n){t>n&&(F=i[e.indexOf(n)])})}function r(){u.find("."+w).removeClass(w),"xs"===F&&z.each(function(){var e=t(this).find("."+_),i=e.get(0).getClientRects().length;2>i&&t(this).addClass(w)})}function o(t){return p.get(t).scrollHeight}function a(){if(0===C&&g.height()>0){p.height("auto");var t=p.map(o),e=Math.max.apply(Math,t);p.height(e)}}function h(){H=u.width();var t=[400,600,800,1e3,1200,1400],e=["xs","s","m","l","xl","xxl"];t.forEach(function(i){H>i&&(j=e[t.indexOf(i)])}),n(),f()}function f(){var t=c+"--size-"+j,e=c+"--items-in-row-"+b,i=c+"--item-size-"+F,n=l+"\n"+t+"\n"+e+"\n"+i;u.attr("class",n),u.attr("data-item-layout",F),x.hide(),d.show(),a(),r()}var c="threeposts",u=t("."+c),l=u.attr("class"),x=t(".placeholder-threeposts"),d=t(".threeposts__items"),m="threeposts__item",p=t("."+m),g=t(p.get(0)),v=p.length,_="threeposts__title-inner",w="threeposts__item--short-title",y="threeposts__item--pic",z=t("."+y),C=z.length,M=235,E=200,O=1200,b=3,j="xxs",F="xxs",H=u.width();h(),t(window).resize(LJ.Function.debounce(h,50))})}(jQuery);
/* <<< file end: js/threeposts.js */

//# map link was there [threeposts.js.map]
/* >>> file start: js/discovery/directives.js */
//= require js/core/angular/api.js
Site.page.template['angular/ljImage.ng.tmpl'] = '<a ng-href=\"{{link}}\">\n    <figure class=\"b-journalpicture\">\n        <img\n            class=\"b-journalpicture-image\"\n            title=\"{{textContent}}\"\n            alt=\"{{textContent}}\"\n            ng-src=\"{{source}}\"\n            ng-style=\"dimensions\"\n            >\n        <figcaption class=\"b-journalpicture-caption\" lj-html=\"content\"></figcaption>\n    </figure>\n</a>\n';
Site.page.template['angular/ljGallery.ng.tmpl'] = '<div\n    class=\"b-journalgallery\"\n    ng-style=\"dimensions\"\n    ng-class=\"{\n        \'b-journalgallery-hightpriority\': isTall\n    }\"\n    >\n    <div\n        class=\"b-journalgallery-container\"\n        ng-style=\"dimensions\"\n        >\n        <figure\n            class=\"b-journalgallery-picture\"\n            ng-repeat=\"item in items\"\n            ng-style=\"dimensions\"\n            ng-if=\"isNearby($index)\"\n            ng-class=\"{\n                \'b-journalgallery-picture-prev\': $index < state.index,\n                \'b-journalgallery-picture-current\': $index === state.index,\n                \'b-journalgallery-picture-next\': $index > state.index\n            }\"\n            >\n            <span\n                class=\"\n                    b-journalgallery-preloader\n                    svgpreloader\n                    svgpreloader-tag\n                    svgpreloader-16\n                    \"\n                    ></span>\n            <div class=\"b-journalgallery-wrapper\">\n                <img\n                    ng-src=\"{{item.src}}\"\n                    class=\"b-journalgallery-image\"\n                    lj-gallery-load\n                    >\n            </div>\n            <figcaption class=\"b-journalgallery-caption\">\n                <span\n                    class=\"b-journalgallery-caption-title\"\n                    lj-html=\"item.content\"></span>\n            </figcaption>\n        </figure>\n    </div>\n    <span\n        class=\"b-journalgallery-counter\"\n        ng-bind=\"(state.index + 1) + \'/\' + (state.total+1)\"\n        ></span>\n    <span\n        class=\"b-journalgallery-nav b-journalgallery-nav-prev\"\n        ng-show=\"state.index !== 0\"\n        ng-click=\"prev()\"\n        ></span>\n    <span\n        class=\"b-journalgallery-nav b-journalgallery-nav-next\"\n        ng-show=\"state.index < state.total\"\n        ng-click=\"next()\"\n        ></span>\n</div>\n';
Site.page.template['angular/discovery/ljSuggest.ng.tmpl'] = '<div\n    class=\"b-mainpage-seealso\"\n    ng-if=\"suggest\"\n    >\n\n    <!-- head -->\n    <h3\n        class=\"b-mainpage-seealso-head\"\n        lj-ml=\"discovery.article.seealso\"\n        ></h3>\n\n    <!-- items -->\n    <ul class=\"b-mainpage-seealso-items\">\n        <li\n            class=\"b-mainpage-seealso-item\"\n            ng-repeat=\"suggested in suggest\"\n            >\n            <a\n                ng-href=\"{{suggested.url}}\"\n                class=\"b-mainpage-seealso-link\"\n                data-track-event=\"LJMag:Post:OpenSeeAlso\"\n                >\n                <span\n                    class=\"b-mainpage-seealso-pic\"\n                    ng-if=\"suggested.image\"\n                    ng-style=\"{ backgroundImage: \'url({{suggested.image}})\' }\"\n                    ></span>\n                <span\n                    class=\"b-mainpage-seealso-title\"\n                    lj-html=\"suggested.subject\"\n                    ></span>\n            </a>\n            <span class=\"b-mainpage-seealso-user\" ng-if=\"suggested.user\">\n                <span\n                    lj-user-dynamic=\"suggested.user.username\"\n                    lj-user-dynamic-options=\"{target: \'_blank\'}\"\n                    ></span>\n            </span>\n        </li>\n    </ul><!-- /items -->\n\n</div>\n';
Site.page.template['angular/widgets/authors/posts.ng.tmpl'] = '<!-- author\'s posts -->\n\n<div\n    class=\"\n        b-authorsposts\n        l-flatslide-aside-block\n        \"\n    ng-class=\"{\n        \'b-authorsposts-loading\': state.isLoading,\n        \'b-authorsposts-empty\': !posts.length\n    }\"\n    >\n\n    <!-- head -->\n    <header class=\"b-authorsposts-head\">\n        <h3\n            class=\"b-authorsposts-title\"\n            lj-ml=\"main.authorsposts.head\"\n            >\n        </h3>\n    </header>\n\n    <!-- body -->\n    <div class=\"b-authorsposts-body\">\n\n        <!-- items -->\n        <ul class=\"b-authorsposts-items\">\n\n            <!-- item -->\n            <li class=\"b-authorsposts-item\"\n                ng-repeat=\"post in posts\">\n\n                <!-- link -->\n                <a\n                    class=\"b-authorsposts-link\"\n                    data-track-event=\"LJMag:Post:OpenAnotherPostByAuthor:{{post.user.username}}\"\n                    ng-href=\"{{ post.url }}\"\n                    >\n                    <!-- pic -->\n                    <span\n                        class=\"b-authorsposts-pic\"\n                        style=\"background-image: url({{post.image}});\"\n                        ng-if=\"post.image\"\n                        ></span>\n                    <!-- subject -->\n                    <span\n                        class=\"b-authorsposts-subject\"\n                        lj-html=\"post.subject\"\n                        ></span>\n                </a>\n\n            </li>\n\n        </ul>\n\n        <!-- dummy loader -->\n        <div class=\"b-authorsposts-dummy\">\n            <div class=\"b-authorsposts-dummy-item\">\n                <span class=\"b-authorsposts-dummy-pic\"></span>\n                <div class=\"b-authorsposts-dummy-caption\">\n                    <span class=\"b-authorsposts-dummy-subject\"></span>\n                </div>\n            </div>\n            <div class=\"b-authorsposts-dummy-item\">\n                <span class=\"b-authorsposts-dummy-pic\"></span>\n                <div class=\"b-authorsposts-dummy-caption\">\n                    <span class=\"b-authorsposts-dummy-subject\"></span>\n                </div>\n            </div>\n            <div class=\"b-authorsposts-dummy-item\">\n                <span class=\"b-authorsposts-dummy-pic\"></span>\n                <div class=\"b-authorsposts-dummy-caption\">\n                    <span class=\"b-authorsposts-dummy-subject\"></span>\n                </div>\n            </div>\n        </div>\n\n    </div><!-- /body -->\n\n</div><!-- /authorsposts -->\n\n\n';
LJ.injectStyle('/* >>> file start: stc/lj_gallery.css */\n.b-journalgallery{overflow:hidden;display:block;position:relative;width:100%;margin:0 auto;padding:0 0 70px;font:.8125rem/1.1 ProximaNovaSemibold,Tahoma,Arial,sans-serif}.b-journalgallery-container{position:relative;background:#FFF}.b-journalgallery-picture{position:absolute;width:100%;margin:0;-webkit-transition:.5s cubic-bezier(.25,.25,.75,.75) all;transition:.5s cubic-bezier(.25,.25,.75,.75) all;text-align:center}.b-journalgallery-picture::after{content:\'\';display:inline-block;height:100%;margin:0 0 0 -.05em;vertical-align:middle}.b-journalgallery-preloader.svgpreloader{position:absolute;top:50%;left:50%;margin:-8px 0 0 -8px}.b-journalgallery-wrapper{display:inline-block;vertical-align:middle;max-width:99%;max-width:calc(100% - .3em)}.b-journalgallery-hightpriority .b-journalgallery-wrapper{display:inline}.b-journalgallery-image{position:relative;max-width:100%;margin:0;vertical-align:top;opacity:1;-webkit-transition:.5s cubic-bezier(.25,.25,.75,.75) all;transition:.5s cubic-bezier(.25,.25,.75,.75) all}.b-journalgallery.b-journalgallery-hightpriority .b-journalgallery-picture .b-journalgallery-wrapper .b-journalgallery-image{width:auto;max-height:100%}.b-journalgallery-caption{position:absolute;top:100%;left:0;right:0;height:70px;margin:0;padding:0;border:0;text-align:center;background:#FFF;color:#829399}.b-journalgallery-caption-title{overflow:hidden;position:absolute;top:0;right:40px;left:40px;height:2.2em;margin:0;padding:10px 2px 0}.b-journalgallery-picture-loaded{background-image:none}.b-journalgallery-picture-loaded .b-journalgallery-image{opacity:1}.b-journalgallery-picture-prev{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0);opacity:0}.b-journalgallery-picture-next{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0);opacity:0}.b-journalgallery-picture-current{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.b-journalgallery-counter{position:absolute;bottom:44px;right:0;margin:0;padding:2px;border:0;text-align:right;color:#829399}.b-journalgallery-nav{position:absolute;top:0;bottom:70px;margin:0;padding:0;border:0;cursor:pointer;font:0/0 a}.b-journalgallery-nav:after,.b-journalgallery-nav:before{content:\" \";position:absolute;top:50%;padding:0}.b-journalgallery-nav:before{width:50px;height:50px;margin:-25px 0 0;border:0;border-radius:3px;background:#839399}.b-journalgallery-nav:hover:before{background:#09C}.b-discoveryarticle .b-journalgallery-nav:hover:before{background:#39BF71}.b-journalgallery-nav:after{width:9px;height:16px;margin:-8px 0 0;background:url(/img/icons/journalgallery.png?v=39648) no-repeat}.b-journalgallery-nav-prev{left:0;width:30%}.b-journalgallery-nav-prev::before{left:20px}.b-journalgallery-nav-prev::after{left:40px}.b-journalgallery-nav-next{right:0;width:70%}.b-journalgallery-nav-next::before{right:20px}.b-journalgallery-nav-next::after{right:40px;background-position:0 -17px}@media all and (max-width:1100px){.b-journalgallery,.b-journalgallery-container,.b-journalgallery-picture{max-height:450px}}@media all and (max-width:1000px){.b-journalgallery,.b-journalgallery-container,.b-journalgallery-picture{max-height:400px}}@media all and (max-width:650px){.b-journalgallery,.b-journalgallery-container,.b-journalgallery-picture{max-height:300px}}@media all and (max-width:480px){.b-journalgallery,.b-journalgallery-container,.b-journalgallery-picture{max-height:200px}.b-journalgallery-nav-prev::before{left:0}.b-journalgallery-nav-prev::after{left:20px}.b-journalgallery-nav-next::before{right:0}.b-journalgallery-nav-next::after{right:20px}}\n/* <<< file end: stc/lj_gallery.css */\n\n/*# sourceMappingURL=lj_gallery.css.map */\n');
angular.module("Discovery.Tags",["LJ.Templates","LJ.Api"]).directive("ljDiscoveryTags",["$compile",function(t){var e=["lj-gallery","[lj-memories]","[lj-lazy]","[lj-share]","[lj-likus]","[lj-cut]","[lj-screenable]","[lj-remove-repost]"];return{restrict:"A",terminal:!0,link:function(i,n){t(n.find(e.join(",")))(i)}}}]).directive("ljGallery",["$templateCache","$compile",function(t,e){return{restrict:"E",scope:!0,link:function(i,n,l){i.dimensions={maxWidth:l.width+"px",height:l.height||350},i.items=n.find("lj-gallery-item").map(function(){var t=angular.element(this).find("img"),e=angular.element(this).find("a"),i=angular.element(this).find("lj-gallery-item-capture");return{content:i.html(),src:t.attr("src"),href:e.attr("href")}}).toArray(),i.isTall="undefined"!=typeof l.tall,i.next=function(){i.state.index+=1},i.prev=function(){i.state.index-=1},i.state={index:0,total:i.items.length-1},i.isNearby=function(t){return Math.abs(i.state.index-t)<=1},n.html(e(t.get("ljGallery.ng.tmpl"))(i))}}}]).directive("ljSuggest",["Api",function(t){return{templateUrl:"ljSuggest.ng.tmpl",scope:{itemId:"@ljSuggest"},link:function(e){t.call("discovery.suggest",{itemid:e.itemId},{cache:!0}).then(function(t){e.suggest=t.items})}}}]).directive("ljWidgetAuthorsPosts",["Api",function(t){return{templateUrl:"posts.ng.tmpl",scope:{userId:"@ljWidgetAuthorsPosts",itemId:"@ljWidgetAuthorsPostsExclude"},link:function(e){e.state={isLoading:!0},t.call("discovery.author_posts",{itemid:e.itemId,userid:e.userId},{cache:!0}).then(function(t){e.state.isLoading=!1,e.posts=t.items})}}}]);
/* <<< file end: js/discovery/directives.js */

//# map link was there [directives.js.map]
/* >>> file start: js/core/angular/ljMemories.js */
//= require js/core/angular/bubble.js
//= require js/core/angular/api.js
Site.page.template['angular/memories.ng.tmpl'] = '<div ng-controller=\"MemoriesCtrl\">\n\n    <div\n        class=\"b-addtomemories\"\n        ng-class=\"{ \'b-addtomemories-loading\': loading }\"\n        >\n\n        <!-- head -->\n        <h3\n            class=\"b-addtomemories-head\"\n            lj-ml=\"memories.title\"\n            ></h3>\n\n        <!-- intro -->\n        <p class=\"b-addtomemories-intro\">\n            <span\n                ng-show=\"!security\"\n                lj-ml=\"memories.title.add\"\n                ></span>\n            <span\n                ng-show=\"security\"\n                lj-ml=\"memories.title.edit\"\n                ></span>\n        </p>\n\n        <!-- items -->\n        <ul class=\"b-addtomemories-items\">\n\n            <li class=\"b-addtomemories-item\">\n                <label class=\"b-addtomemories-label\">\n                    <input\n                        type=\"radio\"\n                        name=\"security\"\n                        class=\"b-addtomemories-radio\"\n                        value=\"public\"\n                        ng-model=\"security\"\n                        ng-change=\"update()\"\n                        >\n                    <span\n                        class=\"b-addtomemories-title\"\n                        lj-ml=\"memories.security.public\"\n                        ></span>\n                </label>\n            </li>\n\n            <li class=\"b-addtomemories-item\">\n                <label class=\"b-addtomemories-label\">\n                    <input\n                        type=\"radio\"\n                        name=\"security\"\n                        class=\"b-addtomemories-radio\"\n                        value=\"friends\"\n                        ng-model=\"security\"\n                        ng-change=\"update()\"\n                        >\n                    <span\n                        class=\"b-addtomemories-title\"\n                        lj-ml=\"memories.security.friends\"\n                        ></span>\n                </label>\n            </li>\n\n            <li class=\"b-addtomemories-item\">\n                <label class=\"b-addtomemories-label\">\n                    <input\n                        type=\"radio\"\n                        name=\"security\"\n                        class=\"b-addtomemories-radio\"\n                        value=\"private\"\n                        ng-model=\"security\"\n                        ng-change=\"update()\"\n                        >\n                    <span\n                        class=\"b-addtomemories-title\"\n                        lj-ml=\"memories.security.private\"\n                        ></span>\n                </label>\n            </li>\n\n        </ul><!-- /items -->\n\n        <!-- footer -->\n        <div\n            class=\"b-addtomemories-footer\"\n            ng-show=\"removeButton\"\n            >\n            \n            <lj-flatbutton lj-flatbutton=\"[\'button\', \'memories.remove\', \'b-flatbutton b-flatbutton-simple b-flatbutton-red\', \'ng-click\', \'remove()\']\"></lj-flatbutton>\n        </div><!-- /footer -->\n\n        <p class=\"b-addtomemories-options\">\n            <a\n                ng-href=\"{{siteroot}}/tools/memadd.bml?journal={{bubble.options.journal}}&amp;itemid={{bubble.options.ditemid}}\"\n                target=\"_blank\"\n                lj-ml=\"memories.options\"\n                ></a>\n        </p>\n\n    </div><!-- /addtomemories -->\n\n</div>\n';
LJ.injectStyle('/* >>> file start: stc/popup/popup-memories.css */\n.b-addtomemories{width:150px;margin:0;padding:0;text-align:left}.b-addtomemories-head{margin:0 0 .5em;padding:0;font:700 1.13em/1.1 Arial,sans-serif;color:#000}.b-addtomemories-intro{margin:0 0 .3em}.b-addtomemories-items{margin:0;padding:0;list-style:none}.b-addtomemories-item{margin:0;padding:0}.b-addtomemories-label{display:block;margin:0 -5px;padding:5px;cursor:pointer}.b-addtomemories-item:hover .b-addtomemories-label{background:#C8E6FF}.b-addtomemories-footer{margin:1em 0}.b-addtomemories-options{margin:.3em -5px 0;padding:.3em 5px 0;border-top:1px solid #DAE3E6}.b-addtomemories-loading{background:url(/img/preloader/preloader-blue-gray.gif?v=16423) 50% 50% no-repeat}.b-addtomemories-loading .b-addtomemories-footer,.b-addtomemories-loading .b-addtomemories-head,.b-addtomemories-loading .b-addtomemories-intro,.b-addtomemories-loading .b-addtomemories-items,.b-addtomemories-loading .b-addtomemories-options{visibility:hidden}\n/* <<< file end: stc/popup/popup-memories.css */\n\n/*# sourceMappingURL=popup-memories.css.map */\n');
!function(e){angular.module("LJ.Memories",["LJ.Bubble","LJ.Api"]).directive("ljMemories",["$parse","$timeout","Bubble",function(o,t,i){return{scope:{ljMemories:"&"},link:function(o,t){function n(n){n.preventDefault(),r||(r="function"==typeof o.ljMemories?o.ljMemories({element:t}):o.ljMemories),i.open("memories",r,e(t)),o.$apply()}var r;i.exists("memories")||i.register({name:"memories",template:"memories.ng.tmpl",disableClick:!0}),t.on("click",n),o.$on("$destroy",function(){t.off("click",n)})}}}]).controller("MemoriesCtrl",["$scope","Api",function(o,t){var i=o.bubble;o.security=null,o.$watch("removeButton",function(){e(window).trigger("resize")}),o.$on("bubble:open:memories",function(){t.call("memories.get",i.options,function(e){o.security=e.result?e.result.security:null,o.removeButton=Boolean(o.security)})}),o.$on("bubble:close:memories",function(){o.removeButton=!1}),o.siteroot=LJ.get("siteroot"),o.update=function(){t.call("memories.set",{journal:i.options.journal,ditemid:i.options.ditemid,description:i.options.journal+": "+i.options.title.decodeHTML(),security:o.security},function(e){o.security=e,i.close(),o.removeButton=!0})},o.remove=function(){t.call("memories.remove",{journal:i.options.journal,ditemid:i.options.ditemid},function(){o.security=null,i.close(),o.removeButton=!1})},LJ.Event.on("api:request:change",function(e,t){/^memories/.test(e)&&(o.loading=t)})}])}(jQuery);
/* <<< file end: js/core/angular/ljMemories.js */

//# map link was there [ljMemories.js.map]
/* >>> file start: js/core/string.js */
!function(t){return t}(),function(){"use strict";LJ.define("LJ.String"),LJ.String.pad=function(t,n,r){if(t=t.toString(),"undefined"==typeof n)throw new Error("You should provide padding string length");if("undefined"==typeof r)throw new Error("You should provide padding symbol");if(t.length>=n)return t;for(;t.length<n;)t=r+t;return t.length===n?t:t.slice(-n)},LJ.String.capitalize=function(t){var n;if("string"!=typeof t)throw new Error("You should provide string as argument");return n=t.length,0===n?t:1===n?t.toUpperCase():t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},LJ.String.linkify=function(t){var n=new RegExp("^(?:([a-zA-Z]+):)?//"),r=/^[a-zA-Z]+:/,e=/^:\/\//,i=r.test(t)?"":"http://";return n.test(t)?t:i+(e.test(t)?t.replace("://",""):t)},LJ.String.smartSplit=function(t,n){return"undefined"==typeof n&&(n=","),t.split(n).map(function(t){return t.trim()}).filter(Boolean)},LJ.String.encodeHTML=function(t){var n={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};return t.replace(/([<>&\"\'])/g,function(t,r){return n[r]?n[r]:r})}}();
/* <<< file end: js/core/string.js */

//# map link was there [string.js.map]
/* >>> file start: js/core/angular/share.js */
//= require js/core/angular/bubble.js
//= require js/core/string.js
Site.page.template['angular/share.ng.tmpl'] = '<p\n    class=\"b-sharethis-head\"\n    lj-ml=\"sharing.popup.title\"\n    ></p>\n\n<ul\n    ng-controller=\"ShareBubbleCtrl as share\"\n    class=\"\n        b-sharethis-services\n        b-sharethis-services-{{ share.version }}\n        \"\n    >\n    <li\n        ng-repeat=\"service in share.services\"\n        class=\"\n            b-sharethis-services-item\n            b-sharethis-{{ service.name }}\n            \"\n        >\n        <a\n            target=\"_blank\"\n            class=\"b-sharethis-services-link\"\n            ng-click=\"share.openPopup($event, service.name, bubble.options.params);\"\n            ng-href=\"{{ service.link }}\"\n            ng-bind=\"service.title\"\n            ></a>\n    </li>\n</ul>\n';
//= require_ml sharing.popup.title
!function(e){return e}(),function(){"use strict";angular.module("LJ.Share",["LJ.Directives","LJ.Templates","LJ.Bubble"]).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|viber):/)}]).directive("ljShare",["Bubble",function(e){return{restrict:"A",scope:!0,link:function(r,t,i){function a(){e.open("share",{params:l,services:n},t),r.$evalAsync()}var l=r.$eval(i.ljShare),n=r.$eval(i.ljShareServices),o=r.$eval(i.ljShareServicesExclude);if(n=n?LJ.String.smartSplit(n):LJ.Social.Share.services(),o=o?LJ.String.smartSplit(o):[],o.length&&(n=n.filter(function(e){return-1===o.indexOf(e)})),n.length){var s=e.register({name:"share",template:"share.ng.tmpl",alwaysBottom:l.alwaysBottom,recalculateOnScroll:i.hasOwnProperty("ljShareScrollable")});t.on("click",a),r.$on("$destroy",function(){t.off("click",a),s()})}}}}]).controller("ShareBubbleCtrl",["$scope","Bubble",function(e,r){var t=this;e.$on("bubble:open:share",function(){t.version=LJ.Flags.isEnabled("adaptive_lj_mobile")?"v4":"v3",t.services=e.bubble.options.services.map(function(r){return{name:r,link:LJ.Social.Share.getUrl(r,e.bubble.options.params),title:LJ.Social.Share.getTitle(r)}})}),t.openPopup=function(e,t,i){return LJ.Social.Share.isTab(t)?void r.close("share"):(e.preventDefault(),LJ.Social.Share.openPopup(t,i),void r.close("share"))}}])}();
/* <<< file end: js/core/angular/share.js */

//# map link was there [share.js.map]
/* >>> file start: js/core/angular/ljRemoveRepost.js */
//= require js/core/angular/api.js
//= require js/core/angular/bubble.js
Site.page.template['angular/ljRemoveRepost.ng.tmpl'] = '<div ng-controller=\"RemoveRepostCtrl as remove\">\n\n    <div\n        class=\"b-removerepost\"\n        ng-class=\"{ \'b-removerepost-loading\': loading }\"\n        >\n        <!-- intro -->\n        <p class=\"b-removerepost-intro\">\n            <span\n                lj-ml=\"repost.confirm.delete\"\n                ></span>\n        </p>\n\n        <!-- footer -->\n         <div\n            class=\"b-removerepost-footer\"\n            >\n            <div class=\"b-popup-submit-options\">\n                <span class=\"b-popup-preloader\">\n                    <span\n                        class=\"b-popup-preloader-inner\"\n                        >\n                        <button\n                            class=\"\n                                b-flatbutton\n                                b-flatbutton-simple\n                                \"\n                            type=\"button\"\n                            ng-click=\"remove.submit()\"\n                            lj-ml=\"confirm.bubble.yes\"\n                            ></button>\n                        <i class=\"preloader\"></i>\n                    </span>\n                    <button\n                        href=\"\"\n                        class=\"\n                            b-flatbutton\n                            b-flatbutton-simple\n                            b-flatbutton-neutral\n                            \"\n                        ng-click=\"remove.cancel()\"\n                        lj-ml=\"confirm.bubble.no\"\n                        ></button>\n                </span>\n            </div>\n        </div>\n    </div>\n</div>\n';
//= require_ml repost.confirm.delete
//= require_ml confirm.bubble.yes
//= require_ml confirm.bubble.no
LJ.injectStyle('/* >>> file start: stc/popup/popup-delete-repost.css */\n.b-removerepost{width:200px;margin:0;padding:0;text-align:left}.b-removerepost-head{margin:0 0 .5em;padding:0;font:700 1.13em/1.1 Arial,sans-serif;color:#000}.b-removerepost-intro{margin:0 0 .3em}.b-removerepost-footer{margin:1em 0 0}.b-removerepost-loading{background:url(/img/preloader/preloader-blue-gray.gif?v=16423) 50% 50% no-repeat}.b-removerepost-loading .b-removerepost-footer,.b-removerepost-loading .b-removerepost-head,.b-removerepost-loading .b-removerepost-intro{visibility:hidden}\n/* <<< file end: stc/popup/popup-delete-repost.css */\n\n/*# sourceMappingURL=popup-delete-repost.css.map */\n');
!function(e){return e}(),function(){"use strict";angular.module("LJ.RemoveRepost",["LJ.Bubble","LJ.Api"]).run(["Bubble",function(e){e.register({name:"removeRepost",template:"ljRemoveRepost.ng.tmpl",recalculateOnScroll:!0,alwaysBottom:!0})}]).directive("ljRemoveRepost",["Api","Bubble",function(e,o){return{scope:{post:"=ljRemoveRepost"},link:function(e,t){function n(n){n.preventDefault(),o.open("removeRepost",{post:e.post},t),e.$evalAsync()}t.on("click",n),e.$on("$destroy",function(){t.off("click",n)})}}}]).controller("RemoveRepostCtrl",["$scope","$rootScope","Api",function(e,o,t){var n,l=e.bubble;e.$on("bubble:open:removeRepost",function(e,o,t){n=t.post}),this.submit=function(){t.call("repost.delete",{url:n.permalink_url}).then(function(){o.$emit("feed:item:remove",n.itemid),l.close()})},this.cancel=function(){l.close()}}])}(jQuery);
/* <<< file end: js/core/angular/ljRemoveRepost.js */

//# map link was there [ljRemoveRepost.js.map]
/* >>> file start: js/core/angular/ljTour.js */
//= require js/core/angular/bubble.js
//= require js/core/angular/api.js
//= require js/core/angular/ref.js
Site.page.template['angular/bubbletour.ng.tmpl'] = '<div class=\"b-helptour\">\n    <header class=\"b-helptour-header\" ng-hide=\"current.length < 2\">\n        <span class=\"b-helptour-stage\">\n            <span class=\"b-helptour-stage-prev\" ng-bind=\"index\"></span>\n            <span class=\"b-helptour-stage-hr\">/</span>\n            <span class=\"b-helptour-stage-next\" ng-bind=\"current.length\"></span>\n        </span>\n    </header>\n    <div class=\"b-helptour-content b-text\">\n        <span lj-ml=\"{{step.tourText}}\" lj-ml-dynamic=\"index\"></span>\n    </div>\n    <footer class=\"b-helptour-footer\">\n        <ul class=\"b-helptour-controls b-helptour-state\">\n            <li class=\"b-helptour-control b-helptour-control-skip\"\n                ng-hide=\"step.tourNoSkip || index === current.length\">\n                <a class=\"b-helptour-skip-link b-helptour-link\" href=\"javascript:void(0)\" lj-ml=\"tour.steps.skip\"\n                   ng-click=\"end()\"></a>\n            </li>\n        </ul>\n        <ul class=\"b-helptour-controls b-helptour-step\">\n            <li class=\"b-helptour-control b-helptour-control-prev\"\n                ng-hide=\"step.tourNoBack || index === 1\">\n                <a class=\"b-helptour-prev-link b-helptour-link\" href=\"javascript:void(0)\" lj-ml=\"tour.steps.prev\"\n                   ng-click=\"prev()\"></a>\n            </li>\n            <li class=\"b-helptour-control b-helptour-control-next\"\n                ng-hide=\"step.tourNoNext || index === current.length\">\n                <a class=\"b-helptour-next-link b-helptour-link\" href=\"javascript:void(0)\" lj-ml=\"tour.steps.next\"\n                   ng-click=\"next()\"></a>\n            </li>\n            <li class=\"b-helptour-control b-helptour-control-done\"\n                ng-hide=\"index !== current.length\">\n                <a class=\"b-helptour-done-link b-helptour-link\" href=\"javascript:void(0)\" lj-ml=\"tour.steps.done\"\n                   ng-click=\"end()\"></a>\n            </li>\n        </ul>\n    </footer>\n</div>\n';
LJ.injectStyle('/* >>> file start: stc/tour/ljtour.css */\n.b-bubble-tour{z-index:5001}.b-bubble-tour .b-popup-inner{padding:0}.b-helptour{width:350px}.b-helptour-header{margin:0 0 .3em;padding:10px 16px 0}.b-helptour-footer:after,.b-helptour-header:after{display:table;width:100%;clear:both;content:\"\"}.b-helptour-stage-title{margin-right:10px}.b-helptour P:first-child{margin:0 0 .3em}.b-helptour-content{margin:10px 0 .6em;padding:0 16px}.b-helptour-content P{margin:.3em 0}.b-helptour-content LI,.b-helptour-content UL{margin:0;padding:0;list-style:none}.b-helptour-footer{padding:6px 15px;border-radius:0 0 5px 5px;background-color:#DAE3E6}.b-helptour-controls{margin:0;padding:0}.b-helptour-state{float:left}.b-helptour-step{float:right}.b-helptour-control{display:inline;margin-right:4px;cursor:pointer}.b-helptour-control-done:after{display:inline-block;content:\"\";width:14px;height:12px;background-image:url(/img/icons/unit_v3.png?v=42878);background-repeat:no-repeat;background-position:0 -223px}.b-helptour-control-done A{padding-left:8px}.b-helptour-control-done A:link,.b-helptour-control-done A:visited,.b-helptour-control-next A:link,.b-helptour-control-prev A:link{color:#00A3D9}.b-helptour-control-skip A:link,.b-helptour-control-skip A:visited{color:#7A9199}.b-helptour-control A{font-size:13px}.b-helptour-control A:active,.b-helptour-control A:focus,.b-helptour-control A:hover{color:#0086b3}.p-ljtour .b-lenta .l-flatslide-container{position:static}.p-ljtour .l-flatslide-menu-controls{position:absolute;top:auto!important}.p-ljtour.p-openpopup .w-cs{overflow:visible}@media all and (max-width:650px){.p-ljtour.p-openpopup .b-fader{display:none!important}.b-bubble-tour{display:none}}\n/* <<< file end: stc/tour/ljtour.css */\n\n/*# sourceMappingURL=ljtour.css.map */\n');
//= require_ml tour.steps.prev
//= require_ml tour.steps.next
//= require_ml tour.steps.skip
//= require_ml tour.steps.done
!function(e){return e}(),function(e){"use strict";angular.module("LJ.Tour",["LJ.Bubble","LJ.Templates","LJ.Directives","LJ.Api"]).factory("Tour",["Api",function(e){var t={};return t.queue={},t.checkAvailable=function(){var n=Object.keys(t.queue);return e.call("tour.is_available",{tours:n}).then(function(e){n.forEach(function(n){0===e.states[n]&&delete t.queue[n]})})},t.setDone=function(t){return e.call("tour.set_done",{tour:t})},t}]).directive("ljTour",["$timeout","$document","Bubble","Ref","Tour",function(t,n,r,u,o){return{scope:!0,link:function(i){function c(){e("body").find("[data-tour]").each(function(){var t=e(this),n=angular.extend({element:t},t.data());Array.isArray(O[n.tour])||(O[n.tour]=[]),O[n.tour].push(n)})}function a(){var e=Object.keys(O)[0],t=O[e];i.current=t.filter(function(e){return b(e)&&v(e)}).sort(function(e,t){return(e.tourStep||1)>t.tourStep}),i.current.forEach(function(e){u.add(e.tour+e.tourStep,e.element)}),delete O[e],m(i.current[0])?f():l()}function l(){Object.keys(O).length&&a()}function s(){r.close(),S.fadeOut(),angular.element("body").removeClass("p-ljtour").off("ljsale-load",y),o.setDone(i.step.tour),S.off("click",s),i.current=null,i.step=null,l()}function f(){return angular.element("body").addClass("p-ljtour").on("ljsale-load",function(e){e.originalEvent.data.slot&&y()}),S.is(":visible")?void t(f,300):(d(),S.on("click",s).fadeIn(),void(i.current=i.current.filter(function(e){return g(e.element)})))}function d(){var e=i.current.indexOf(i.step);e<i.current.length-1?(i.step=i.current[++e],i.index=++e,h()):s()}function p(){var e=i.current.indexOf(i.step);e>0&&(i.step=i.current[--e],i.index=++e,h())}function b(e){return e.hasOwnProperty("tourOwner")?LJ.get("remote.username")===LJ.get("journal.username"):!0}function v(e){return e.hasOwnProperty("tourSkipIf")?e.tourSkipIf.split(",").every(function(e){return e=e.trim(),"!"===e.charAt(0)?LJ.get(e.slice(1)):!LJ.get(e)}):!0}function g(e){return e.is(":visible")&&0!==e.css("opacity")&&"hidden"!==e.css("visibility")}function m(e){return e?e.hasOwnProperty("tourStartPage")?new RegExp(e.tourStartPage,"i").test(location.pathname):1===e.tourStep:!1}function y(){angular.element(window).trigger("resize"),k()}function h(){if(i.step){if(!i.step.element.is(":visible"))return d();r.current&&r.close(),t(function(){var e=r.options("tour")||{};r.open("tour",angular.extend(e,i.step.tourBubble),i.step.element),k()}),LJ.Event.once("visual_editor_ready",function(){t(y)})}}function k(){u.scrollTo(i.step.tour+i.step.tourStep,{onlyOutOfScreen:!0})}function J(e){if(i.current&&i.current.length){switch(e.which){case 27:s();break;case 37:p();break;case 39:d()}i.$apply()}}var L,O=o.queue,S=angular.element(document.querySelector(".b-fader")),w=!1;L=r.register({name:"tour",template:"bubbletour.ng.tmpl",closeControl:!1},i),!LJ.Flags.isEnabled("friendsfeed_tour")||LJ.Support.isMobile()||w||(w=!0,t(function(){c(),o.checkAvailable().then(l)})),i.next=d,i.prev=p,i.end=s,n.on("keydown",J),i.$on("$destroy",function(){n.off("keydown",J),L()})}}}])}(jQuery);
/* <<< file end: js/core/angular/ljTour.js */

//# map link was there [ljTour.js.map]
/* >>> file start: js/widgets/likus.js */
var _extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};
//= require js/core/angular/ljUser.js
//= require js/core/angular/api.js
//= require js/core/angular/bubble.js
Site.page.template['angular/widgets/likus/likusMain.ng.tmpl'] = '<a\n    class=\"ljlikus-button ljlikus--like\"\n    ng-class=\"{\'ljlikus--like-active\': likus.liked}\"\n    ng-href=\"#\"\n    ng-click=\"likus.vote($event)\"\n    ng-if=\"likus.show && !likus.link\"\n    >\n      <span class=\"ljlikus-icon\" lj-svg-icon=\"flaticon--like\"></span>\n</a>\n<a\n    class=\"ljlikus-action\"\n    ng-href=\"#\"\n    ng-if=\"likus.show && likus.count && !likus.link\"\n    ng-click=\"likus.preventClick($event)\"\n    ng-mouseover=\"likus.users($event)\"\n    >\n      <span class=\"ljlikus-counter\">{{likus.count}}</span>\n</a>\n\n<!-- no actions -->\n<a\n    class=\"ljlikus--like ljlikus-no-action\"\n    ng-href=\"{{likus.link}}\"\n    ng-if=\"likus.show && likus.link\"\n    >\n      <span class=\"ljlikus-icon\" lj-svg-icon=\"flaticon--like\"></span>\n      <span\n        class=\"ljlikus-counter\"\n        ng-if=\"likus.show && likus.link && likus.count\"\n      >\n        {{likus.count}}\n      </span>\n</a>\n';
Site.page.template['angular/widgets/likus/likusUsers.ng.tmpl'] = '<ul class=\"ljlikus-list\">\n    <li class=\"ljlikus__item\" ng-repeat=\"user in users\">\n        <span lj-user-by-id=\"user\" />\n    </li>\n    <li\n        ng-if=\"users.length > 1\"\n        class=\"ljlikus__item ljlikus--more\"\n        >\n            <a href=\"#\" class=\"ljlikus__item--more\" ng-click=\"more($event)\">More</a>\n    </li>\n</ul>\n';
Site.page.template['angular/widgets/likus/likusBubble.ng.tmpl'] = '<!-- Bubble -->\n<div class=\"ljlikus-bubble\">\n\n    <!-- header -->\n    <header class=\"ljlikus-bubble__header\">\n        <span class=\"ljlikus-bubble__title\">They liked it</span>\n        <span class=\"ljlikus-counter\">{{likusBubble.count}}</span>\n        <span\n            class=\"ljlikus-bubble__close\"\n            lj-svg-icon=\"flaticon--cross\"\n            ng-click=\"likusBubble.close($event)\"\n        ></span>\n    </header> <!-- /header -->\n\n    <!-- body -->\n    <div class=\"ljlikus-bubble__body\">\n\n        <!-- list -->\n        <ul class=\"ljlikus-list ljlikus-list--full\">\n            <li ng-repeat=\"user in likusBubble.users\" class=\"ljlikus__item\">\n                <span class=\"ljlikus__item-userpic\">\n                  <img ng-src=\"{{user.userpic}}\" alt=\"\" >\n                </span>\n                <div class=\"ljlikus__item-meta\">\n                  <span lj-html=\"user.entry_title\" />\n                  <p class=\"ljlikus__item-usertitle\">{{user.title}}</p>\n                </div>\n                <span class=\"ljlikus__item-sc\">{{user.weight}}</span>\n            </li>\n            <li\n                class=\"ljlikus__item ljlikus__item--more\"\n                ng-if=\"likusBubble.hasMore\"\n            >\n                <a\n                    class=\"b-flatbutton b-flatbutton-simple\"\n                    href=\"#\"\n                    ng-click=\"likusBubble.loadMore($event)\"\n                >show more</a><!--\n            --></li>\n            <li\n                class=\"ljlikus__item ljlikus__item--loading\"\n                ng-if=\"likusBubble.loading\"\n            >\n                <span\n                    class=\"svgpreloader-16 svgpreloader-tag\"\n                >\n\n                </span>\n            </li>\n        </ul> <!-- /list -->\n\n    </div> <!-- /body -->\n</div> <!-- /bubble -->\n';
!function(){"use strict";function e(){return{scope:{noActions:"@ljLikusNoActions",medius:"@ljLikusMedius",journal:"@ljLikusJournal",item:"@ljLikusItem",token:"@ljLikusToken",uri:"@ljLikusUri"},templateUrl:"likusMain.ng.tmpl",controllerAs:"likus",controller:n}}function n(e,n,t,r,s,o,i){function l(){i.close("likus-users"),angular.isFunction(d)&&d(),o.showUsers(c,{likes_signature:h})}function u(e){v.count=e.count,v.liked=Boolean(e.liked),a=[].concat(e.users)}var a,c,d,k,v=this,g=e.noActions||!1,f=e.medius,p=e.journal,m=e.item,b=e.uri||r.LJ.get("currentEntry"),h=e.token||r.LJ.get("likes_signature"),j=r.LJ.Flags.isEnabled("likes"),L=r.LJ.Flags.isEnabled("medius"),w=r.LJ.Flags.isEnabled("likes_display"),y=r.LJ.get("remote"),$=angular.element("body");return j?f&&!L?void n.remove():(p&&m&&(c={journal:p,item:m,uniq:""+p+"-"+m}),!c&&b&&(c={uri:b,uniq:b}),void(c&&h&&(w&&n.removeClass("lj-likus--hidden"),v.show=w,v.count=0,v.liked=!1,v.link=g,o.getVote(c,{token:h}).then(u),v.vote=function(e){return y?k?void s.log("You don't want to vote so quickly!"):(k=!0,v.preventClick(e),void o.setVote(c,{mark:+v.liked}).then(u).then(function(){k=!1})):void $.addClass("p-loginform")},v.users=function(n){var r=t.$new();r.users=a,r.more=l,d=i.register({name:"likus-users",template:"likusUsers.ng.tmpl",closeControl:!1,closeOnScroll:!0,autoClose:200},r),i.open("likus-users",angular.element(n.currentTarget)),e.$on("bubble:close:likus-users",d)},v.preventClick=function(e){e.preventDefault()}))):void n.remove()}function t(){return{scope:!0,templateUrl:"likusBubble.ng.tmpl",controllerAs:"likusBubble",controller:r}}function r(e,n,t){function r(){return t.showUsers()}function s(e){return e?(d.addClass(a),i.count=t.getCached(e),void o(e)):(d.removeClass(a),i.users=[],i.count=0,void(u=null))}function o(e){i.loading=!0,i.hasMore=!1,t.getUsers(e,{limit:l,lastid:u}).then(function(e){i.loading=!1,u=(e[l-1]||{}).id,i.hasMore=Boolean(u),i.users=i.users.concat(i.lastid?e.slice(1):e)})}var i=this,l=40,u=null,a="ljlikus-bubble--full",c=n.LJ.Flags.isEnabled("likes"),d=angular.element("body");c&&(i.loading=!1,i.hasMore=!1,i.users=[],i.count=0,i.close=function(e){i.preventClick(e),t.showUsers(!1)},i.loadMore=function(e){i.preventClick(e),o(t.showUsers())},i.preventClick=function(e){e.preventDefault()},e.$watch(r,s))}function s(e,n,t,r){function s(t,r){var s=n.defer();return c.hasOwnProperty(r.token)||(c[r.token]={},e(i.bind(null,r.token),50)),c[r.token][t.uniq]={entity:t,params:r,resolve:s.resolve,reject:s.reject},s.promise}function o(e,n){var t=_extends({},e,n);return r.call("likes.vote",t).then(function(e){return e.result?(d[t.uniq]=e.result.count,e.result):(LJ.Messages.error("An error has occurred."),{})})}function i(e){var n,s,o;return c.hasOwnProperty(e)?(n=c[e],delete c[e],s=Object.keys(n).map(function(e){return n[e].entity}),o={entities:s,mode:"feed",type:"full",likes_signature:e},void r.call("likes.get_votes",o).then(function(e){var r=e.result;return angular.isArray(r)?void r.map(function(e){var t=n[e.uniq];d[e.uniq]=e.count,t&&t.resolve(e)}):void t.log("Unexpected response [getVotes / ljkus]")})):void t.log("Unhandled error [getVotes / ljkus]")}function l(e){return d[e.uniq]||0}function u(e,n){var t=_extends({},e,n);return r.call("likes.get_users",t).then(function(e){return e.result})}function a(e,n){return angular.isDefined(e)&&!e&&(k=!1),angular.isObject(e)&&(k=_extends({},e,n)),k}var c={},d={},k=!1;return{getVote:s,setVote:o,getCached:l,getUsers:u,showUsers:a}}angular.module("LJ.Likus",["LJ.Directives","LJ.User","LJ.Bubble","LJ.Api"]).run(function(){LJ.Flags.isEnabled("likes")&&(angular.element("body").addClass("j-p-likus"),angular.element("[ng-app]").append("<div lj-likus-bubble></div>"))}).factory("LikusService",s).directive("ljLikus",e).directive("ljLikusBubble",t),n.$inject=["$scope","$element","$rootScope","$window","$log","LikusService","Bubble"],r.$inject=["$scope","$window","LikusService"],s.$inject=["$timeout","$q","$log","Api"]}();
/* <<< file end: js/widgets/likus.js */

//# map link was there [likus.js.map]
/* >>> file start: js/core/angular/radioGroup.js */
!function(t){return t}(),function(){"use strict";function t(){function t(){this._models={}}function o(o){return e[o]?e[o]:(e[o]=new t,e[o])}var e={};return t.prototype.models=function(){return this._models},t.prototype.reset=function(){var t,o=this._models;for(t in o)o.hasOwnProperty(t)&&o[t]&&(this._models[t]=!1);return this},t.prototype.set=function(t,o){return o?this.reset()._models[t]=!0:this._models[t]=!1,this},t.prototype.on=function(t){return this.set(t,!0)},t.prototype.off=function(t){return"undefined"==typeof t?this.reset():this.set(t,!1),this},t.prototype.toggle=function(t){this._models[t]?this.off(t):this.on(t)},o}angular.module("LJ.RadioGroup",[]),angular.module("LJ.RadioGroup").factory("radioGroup",t)}();
/* <<< file end: js/core/angular/radioGroup.js */

//# map link was there [radioGroup.js.map]
/* >>> file start: js/node_modules/angular-sanitize/angular-sanitize.js */
!function(e,t,r){"use strict";function n(){this.$get=["$$sanitizeUri",function(e){return function(t){var r=[];return i(t,l(r,function(t,r){return!/^unsafe/.test(e(t,r))})),r.join("")}}]}function a(e){var r=[],n=l(r,t.noop);return n.chars(e),r.join("")}function s(e){var t,r={},n=e.split(",");for(t=0;t<n.length;t++)r[n[t]]=!0;return r}function i(e,r){function n(e,n,s,i){if(n=t.lowercase(n),C[n])for(;w.last()&&A[w.last()];)a("",w.last());k[n]&&w.last()==n&&a("",n),i=$[n]||!!i,i||w.push(n);var c={};s.replace(h,function(e,t,r,n,a){var s=r||n||a||"";c[t]=o(s)}),r.start&&r.start(n,c,i)}function a(e,n){var a,s=0;if(n=t.lowercase(n))for(s=w.length-1;s>=0&&w[s]!=n;s--);if(s>=0){for(a=w.length-1;a>=s;a--)r.end&&r.end(w[a]);w.length=s}}"string"!=typeof e&&(e=null===e||"undefined"==typeof e?"":""+e);var s,i,c,l,w=[],x=e;for(w.last=function(){return w[w.length-1]};e;){if(l="",i=!0,w.last()&&D[w.last()]?(e=e.replace(new RegExp("(.*)<\\s*\\/\\s*"+w.last()+"[^>]*>","i"),function(e,t){return t=t.replace(b,"$1").replace(v,"$1"),r.chars&&r.chars(o(t)),""}),a("",w.last())):(0===e.indexOf("<!--")?(s=e.indexOf("--",4),s>=0&&e.lastIndexOf("-->",s)===s&&(r.comment&&r.comment(e.substring(4,s)),e=e.substring(s+3),i=!1)):m.test(e)?(c=e.match(m),c&&(e=e.replace(c[0],""),i=!1)):d.test(e)?(c=e.match(f),c&&(e=e.substring(c[0].length),c[0].replace(f,a),i=!1)):g.test(e)&&(c=e.match(p),c?(c[4]&&(e=e.substring(c[0].length),c[0].replace(p,n)),i=!1):(l+="<",e=e.substring(1))),i&&(s=e.indexOf("<"),l+=0>s?e:e.substring(0,s),e=0>s?"":e.substring(s),r.chars&&r.chars(o(l)))),e==x)throw u("badparse","The sanitizer was unable to parse the following block of html: {0}",e);x=e}a()}function o(e){if(!e)return"";var t=S.exec(e),r=t[1],n=t[3],a=t[2];return a&&(T.innerHTML=a.replace(/</g,"&lt;"),a="textContent"in T?T.textContent:T.innerText),r+a+n}function c(e){return e.replace(/&/g,"&amp;").replace(w,function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return"&#"+(1024*(t-55296)+(r-56320)+65536)+";"}).replace(x,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function l(e,r){var n=!1,a=t.bind(e,e.push);return{start:function(e,s,i){e=t.lowercase(e),!n&&D[e]&&(n=e),n||E[e]!==!0||(a("<"),a(e),t.forEach(s,function(n,s){var i=t.lowercase(s),o="img"===e&&"src"===i||"background"===i;O[i]!==!0||F[i]===!0&&!r(n,o)||(a(" "),a(s),a('="'),a(c(n)),a('"'))}),a(i?"/>":">"))},end:function(e){e=t.lowercase(e),n||E[e]!==!0||(a("</"),a(e),a(">")),e==n&&(n=!1)},chars:function(e){n||a(c(e))}}}var u=t.$$minErr("$sanitize"),p=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,f=/^<\/\s*([\w:-]+)[^>]*>/,h=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,g=/^</,d=/^<\//,b=/<!--(.*?)-->/g,m=/<!DOCTYPE([^>]*?)>/i,v=/<!\[CDATA\[(.*?)]]>/g,w=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,x=/([^\#-~| |!])/g,$=s("area,br,col,hr,img,wbr"),z=s("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),y=s("rp,rt"),k=t.extend({},y,z),C=t.extend({},z,s("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),A=t.extend({},y,s("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),D=s("script,style"),E=t.extend({},$,C,A,k),F=s("background,cite,href,longdesc,src,usemap"),O=t.extend({},F,s("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),T=document.createElement("pre"),S=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",n),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var r=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"]/,n=/^mailto:/;return function(s,i){function o(e){e&&h.push(a(e))}function c(e,r){h.push("<a "),t.isDefined(i)&&(h.push('target="'),h.push(i),h.push('" ')),h.push('href="',e.replace('"',"&quot;"),'">'),o(r),h.push("</a>")}if(!s)return s;for(var l,u,p,f=s,h=[];l=f.match(r);)u=l[0],l[2]==l[3]&&(u="mailto:"+u),p=l.index,o(f.substr(0,p)),c(u,l[0].replace(n,"")),f=f.substring(p+l[0].length);return o(f),e(h.join(""))}}])}(window,window.angular);
/* <<< file end: js/node_modules/angular-sanitize/angular-sanitize.js */

//# map link was there [angular-sanitize.js.map]
/* >>> file start: js/widgets/discoverytimes.js */
//= require js/core/angular/radioGroup.js
//= require js/node_modules/angular-sanitize/angular-sanitize.js
//= require js/core/angular/api.js
//= require js/core/angular/users.js
//= require js/core/angular/ljUser.js
!function(){"use strict";function e(){var e=angular.element(".b-discoverytimes-wrapper[lj-discovery-times]");e.injector()||angular.bootstrap(e,["LJ.DiscoveryTimes"])}function i(){function e(e,i){i.removeAttr("lj-discovery-times")}return{scope:!0,link:e,controller:n,controllerAs:"times"}}function n(e,i,n,t,o,m){function r(){f+=1,f>=d.items.length&&(f=0),l.on(d.items[f].itemid)}function s(){0!==d.items.length&&(r(),c=i(r,a),e.$on("$destroy",i.cancel.bind(i,c)))}var c,d=this,u=LJ.Flags.isEnabled("medius_ui")?m:o,l=n("active"),a=5e3,f=-1;d.items=[],d.active=l.reset().models(),d.isRecommend=!1,d.showRecommend=!1,d.showRandom=!1,d.close=function(){},d.recommend=function(){u.setRecommend().then(function(){d.isRecommend=u.isRecommend})},u.getRecommend().then(function(){d.showRecommend=u.showRecommend,d.showRandom=!d.showRecommend,d.isRecommend=u.isRecommend}),u.getFeed().then(function(e){d.items=e.items.filter(Boolean),t.Cache.add(d.items.map(LJ.Function.get("user")))}).then(s)}function t(e){function i(){return m.limit=m.itemshow,m.is_published=!0,e.call("medius.get_public_items",m).then(n)}function n(e){return e.items=e.items.filter(function(e){return e.author}).map(function(e){return e.itemid=e.jitem_id,e.url=e.link,e.subject=e.title,e}),e}function t(){return s.showRecommend?e.call("discovery.is_recommend",r).then(function(e){"ok"===e.status&&(s.isRecommend=e.is_recommend)}):Promise.resolve()}function o(){return s.showRecommend?e.call("discovery.recommend",r).then(function(e){"ok"===e.status&&(s.isRecommend=!0)}):Promise.resolve()}var m={itemshow:10},r={entry:Boolean(LJ.get("entry")),remoteid:LJ.get("remote.id"),journalid:LJ.get("journal.id"),publicEntry:LJ.get("entry.is_public"),ditemid:LJ.get("entry.ditemid")},s={getFeed:i,isRecomend:!1,getRecommend:t,setRecommend:o,showRecommend:!1};return s}function o(e){function i(){return e.call("discovery.get_feed",o)}function n(){return r.showRecommend?e.call("discovery.is_recommend",m).then(function(e){"ok"===e.status&&(r.isRecommend=e.is_recommend)}):Promise.resolve()}function t(){return r.showRecommend?e.call("discovery.recommend",m).then(function(e){"ok"===e.status&&(r.isRecommend=!0)}):Promise.resolve()}var o={itemshow:10},m={entry:Boolean(LJ.get("entry")),remoteid:LJ.get("remote.id"),journalid:LJ.get("journal.id"),publicEntry:LJ.get("entry.is_public"),ditemid:LJ.get("entry.ditemid")},r={getFeed:i,isRecomend:!1,getRecommend:n,setRecommend:t,showRecommend:m.entry&&m.journalid&&m.remoteid&&m.publicEntry&&m.journalid!==m.remoteid};return r}t.$inject=["Api"],o.$inject=["Api"],n.$inject=["$scope","$interval","radioGroup","Users","DiscoveryTimesService","MediusTimesService"],angular.element("body").ready(e),angular.module("LJ.DiscoveryTimes",["ngSanitize","LJ.Directives","LJ.RadioGroup","LJ.Api","LJ.User","Users"]),angular.module("LJ.DiscoveryTimes").directive("ljDiscoveryTimes",i).factory("MediusTimesService",t).factory("DiscoveryTimesService",o)}();
/* <<< file end: js/widgets/discoverytimes.js */

//# map link was there [discoverytimes.js.map]
/* >>> file start: js/s2.js */
//= require js/jquery/jquery.calendarEvents.js
//= require js/discovery/directives.js
//= require js/core/angular/ljMemories.js
//= require js/core/angular/share.js
//= require js/core/angular/ljRemoveRepost.js
//= require js/core/angular/ljTour.js
//= require js/widgets/likus.js
//= require js/widgets/discoverytimes.js
!function(e){return e}(),function(e){"use strict";angular.module("S2Layout",["Discovery.Tags","LJ.Memories","LJ.Share","LJ.RemoveRepost","LJ.Tour","LJ.Likus","LJ.DiscoveryTimes","LJ.Sale"]).value("$anchorScroll",null).run(function(){e("a:not([target])").attr("target","_self")}).config(["$locationProvider",function(e){LJ.Support.history||0!==angular.element("base").length?e.html5Mode(!0):angular.element("<base />").attr("href",location.href).appendTo("head")}]).controller("S2LayoutCtrl",[function(){var e=angular.element("body");this.asideToggle=function(){e.toggleClass("js--sidebar-opened")},e.on("click",function(n){angular.element(n.target).parents(".js-sidebar").length||e.toggleClass("js--sidebar-opened",!1)}),this.isSidebarOpened=!1,this.toggleSidebar=function(){this.isSidebarOpened=!this.isSidebarOpened}}]).directive("sidebarControlsPosition",["$timeout",function(n){return{link:function(a,t){function o(){m&&(r(),i(),l(),LJ.Support.isMobile()&&d())}function r(){0===h&&(h=parseInt(t.css("top"),10),J=f.height(),p=h-J),L=u.offset().top}function i(){if(m!==!1){var n={},t=e(window).scrollTop(),o="vertical",r=L-t,i=e(window).width(),s=e(window).height(),l=r+p;i>1.5*s&&400>s&&(o="horizontal"),0>r?l=30:"horizontal"===o&&(l=r+30),n.top=l,a.controlsTop=n}}function s(){r(),i(),a.$apply()}function l(){b.children().length&&c(b)}function c(){--w<0||(0===b.height()?n(c,C):(r(),i()))}function d(){if(!(--y<0)){var e=angular.element(".b-smartappbanner"),a=e.find(".b-smartappbanner-close");0===e.length?n(d,C):(r(),i(),a.on("click",function(){n(s,C)}))}}var u=angular.element(".js--journal-wrapper"),f=angular.element("#lj_controlstrip_new, .s-header"),h=0,p=0,m=t.is(":visible"),g=m,b=angular.element(".pagewide-wrapper"),v=b.find(".common-banner-close"),w=10,y=10,L=0,J=0,C=1500,S=LJ.Function.throttle(i,30);o(),e(window).on("scroll",S),a.$on("$destroy",function(){e(window).off("scroll",S)}),e(window).on("resize",function(){m=t.is(":visible"),g!==m&&(g=m,m&&(o(),a.$apply()))}),v.on("click",s)}}}]).directive("commentsResizeImages",[function(){return{link:function(n,a){function t(){var n=d.css("top"),a=2*parseFloat(n);v=e(window).width()-a,w=e(window).height()-a}function o(){var n=e(this),a=n[0],t=n.width(),o=a.naturalWidth,i=(a.naturalHeight,n.width()*b),s=n.height()*b;if(o>t&&o>=i&&v>=i&&w>=s){if(n.hasClass(g))return;n.addClass(g);var l=e("<span>").addClass(m);n.wrap(l),n.on("click",function(){r(this)})}else n.hasClass(g)&&(n.off(),n.unwrap(),n.removeClass(g));return n}function r(n){l.attr("src",e(n).attr("src")),e("body").addClass(p);var a=[0,0,l.width(),l.height()].join(" ");u[0].setAttribute("viewBox",a);var t=f[0].width.baseVal.value,o=l.width()-t-h,r=[o,h].join(",");f.attr("transform","translate("+r+")")}var i=a.find(".j-c-resize-images"),s=i.find("img"),l=e(".fullsize-image"),c=e(".fullsize-image-fader"),d=e(".fullsize-image-wrapper"),u=e(".fullsize-image-svg-glass"),f=e(".fullsize-image-close"),h=5,p="js--wrapper-shown",m="scaled-image-wrapper",g="img--scaled",b=1.5,v=e(window).width(),w=e(window).height();s.length>0&&(t(),s.map(o),u.on("click",function(){e("body").removeClass(p)}),c.on("click",function(){e("body").removeClass(p)}),e(window).on("resize",function(){t(),s.map(o)}))}}}]),LJ.Event.on("page_load",function(){var n=e(".sidebar-cal");e.fn.hasOwnProperty("inlineCalendar")&&(n.inlineCalendar({selectors:{month:".sbar-cal-nav-month",year:".sbar-cal-nav-year",prevMonth:".sbar-cal-nav-month .sbar-cal-nav-prev",nextMonth:".sbar-cal-nav-month .sbar-cal-nav-next",prevYear:".sbar-cal-nav-year .sbar-cal-nav-prev",nextYear:".sbar-cal-nav-year .sbar-cal-nav-next",monthLabel:".sbar-cal-nav-month .sbar-cal-month",yearLabel:".sbar-cal-nav-year .sbar-cal-year"},classNames:{current:"today",nextDisabled:"disabled",prevDisabled:"disabled"},dayRef:LJ.get("currentJournalBase")+"/%Y/%M/%D",monthRef:LJ.get("currentJournalBase")+"/%Y/%M",yearRef:LJ.get("currentJournalBase")+"/%Y",endMonth:new Date,startAtSunday:!0}).on("daySelected",function(e){e.preventDefault()}),e.fn.hasOwnProperty("calendarEvents")&&n.calendarEvents({calendarType:"inlineCalendar"}))}),LJ.Event.on("page_load",function(){var n="hover",a=e(".sidebar dl"),t=e(".sidebar dt"),o=!1;0!==e(".sidebar-friendstimes").length&&(LJ.Support.touch?(t.on("touchstart",function(){e(this).parent().toggleClass(n).siblings().removeClass(n)}),a.on("touchstart",function(){o=!0}),e(document).on("touchstart",function(){o?o=!1:a.removeClass(n)})):a.on({mouseenter:function(){e(this).addClass("hover")},mouseleave:function(){e(this).removeClass("hover")}}))}),LJ.Event.on("page_load",function(){LJ.get("LJ_cmtinfo")&&(window.LJ_cmtinfo=LJ.get("LJ_cmtinfo")),e.fn.subjecticons&&e(".b-subjecticons").subjecticons(),e.fn.commentator&&e.fn.authtype&&e.fn.quotescreator&&e("#postform-wrapper").commentator({publicKey:LJ.get("captcha_public"),captchaContainerId:"captcha-container"}).authtype({forceStartupCaptcha:!!Number(LJ.get("need_captcha")),selectors:{authTypeRadios:".b-postform-login-{authType} .b-postform-login-radio"}}).quotescreator(),e.fn.placeholder&&e("#cookieusername").placeholder(),e(document.body).on("click","[data-s2-helper-scrollTop]",function(n){n.preventDefault(),e("body,html").animate({scrollTop:0},500)}),LJ.define("LJ.S2Comments"),LJ.S2Comments=!0}),e(function(){e("body").on("click",".b-lenta-msg-close",function(n){n.preventDefault(),LJ.Api.call("friendsfeed.close_friendsfeed_line",{},function(){e(".b-lenta-msg").remove(),e("body").addClass("b-lenta-msg-hidden")})})})}(jQuery);
/* <<< file end: js/s2.js */

//# map link was there [s2.js.map]
/* >>> file start: js/deprecated/dom.js */
function _textSpan(){return _textElements("span",arguments)}function _textDiv(){return _textElements("div",arguments)}function _textElements(t,e){for(var n=[],r=0;r<e.length;r++){var u=document.createElement(t);u.innerHTML=e[r],n.push(u)}return 1==n.length?n[0]:n}
/* <<< file end: js/deprecated/dom.js */

//# map link was there [dom.js.map]
/* >>> file start: js/ippu.js */
function changeOpac(e,t){var i=$(e);if(i&&i.style){var s=i.style;s&&(IPPU.isSafari()&&t>=100&&(t=99.99),s.filters&&(s.filters.alpha.opacity=100*t),s.opacity=t)}}IPPU=new Class(Object,{setFixedPosition:function(e){IPPU.isIE()||(this.fixedPosition=e,this.updateContent())},clickHandler:function(e){if(this.clickToClose&&this.visible()){e=Event.prep(e);var t=e.target;DOM.getAncestorsByClassName(t,"ippu",!0).length>0||this.cancel()}},setCancelledCallback:function(e){this.cancelledCallback=e},cancel:function(){this.cancelledCallback&&this.cancelledCallback(),this.hide()},setHiddenCallback:function(e){this.hiddenCallback=e},setupClickCapture:function(){if(this.visible()&&!this.clickHandlerSetup&&(this.clickToClose||this.modal)){if(this.clickHandlerFunc=this.clickHandler.bindEventListener(this),this.modal){if(this.overlay)return;this.overlay=document.createElement("div"),this.overlay.style.left="0px",this.overlay.style.top="0px",this.overlay.style.margin="0px",this.overlay.style.padding="0px",this.overlay.style.backgroundColor="#000000",this.overlay.style.zIndex="900",IPPU.isIE()?(this.overlay.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=50)",this.overlay.style.position="absolute",this.overlay.style.width=document.body.scrollWidth,this.overlay.style.height=document.body.scrollHeight):this.overlay.style.position="fixed",this.ele.parentNode.insertBefore(this.overlay,this.ele),this.updateOverlay(),DOM.addEventListener(this.overlay,"click",this.clickHandlerFunc)}else DOM.addEventListener(document,"click",this.clickHandlerFunc);this.clickHandlerSetup=!0}},updateOverlay:function(){if(this.overlay){var e=DOM.getClientDimensions();this.overlay.style.width=e.x-1+"px",IPPU.isIE()||(this.overlay.style.height=e.y-1+"px"),this.visibleOverlay?(this.overlay.backgroundColor="#000000",changeOpac(this.overlay,.5)):(this.overlay.backgroundColor="#FFFFFF",changeOpac(this.overlay,0))}},resizeHandler:function(e){this.updateContent()},removeClickHandlers:function(){if(this.clickHandlerSetup){DOM.removeEventListener(document,"click",this.clickHandlerFunc,!1),this.overlay&&(DOM.removeEventListener(this.overlay,"click",this.clickHandlerFunc,!0),this.overlay.parentNode.removeChild(this.overlay),this.overlay=void 0),this.clickHandlerFunc=void 0,this.clickHandlerSetup=!1}},setClickToClose:function(e){if(this.clickToClose=e,!this.clickHandlerSetup&&e&&this.visible()){var t=this.setupClickCapture.bind(this);window.setTimeout(t,100)}else!e&&this.clickHandlerSetup&&this.removeClickHandlers();this.updateContent()},setModal:function(e){var t=this.modal==e;e&&this.setClickToClose(!1),this.modal=e,t&&(this.removeClickHandlers(),this.updateContent())},setOverlayVisible:function(e){this.visibleOverlay=e,this.updateContent()},updateContent:function(){this.autoCenter(),this.updateTitlebar(),this.updateOverlay(),this.titlebar&&this.setTitlebarClass(this.titlebar.className);var e=this.setupClickCapture.bind(this);window.setTimeout(e,100),this.fixedPosition&&"fixed"!=this.ele.style.position?this.ele.style.position="fixed":this.fixedPosition||"fixed"!=this.ele.style.position||(this.ele.style.position="absolute")},getTitlebarElement:function(){return this.titlebar},setTitlebarClass:function(e){this.titlebar&&(this.titlebar.className=e)},setOverflow:function(e){this.ele&&(this.ele.style.overflow=e)},visible:function(){return this.shown},setTitlebar:function(e){if(this.showTitlebar=e,e){if(!this.titlebar){var t=document.createElement("div");if(!t)return;t.style.width="100%",this.title&&(t.innerHTML=this.title),this.ele.insertBefore(t,this.content),this.titlebar=t}}else this.titlebar&&(this.ele.removeChild(this.titlebar),this.titlebar=!1)},setTitle:function(e){this.title=e,this.updateTitlebar()},updateTitlebar:function(){this.showTitlebar&&this.titlebar&&this.title!=this.titlebar.innerHTML&&(this.titlebar.innerHTML=this.title)},addClass:function(e){DOM.addClassName(this.ele,e)},removeClass:function(e){DOM.removeClassName(this.ele,e)},setAutoCenterCallback:function(e){this.autoCenterCallback=e},autoCenter:function(){if(this.visible&&this.visible()){if(this.autoCenterCallback)return void this.autoCenterCallback(this);this.autoCenterX&&this.centerX(),this.autoCenterY&&this.centerY()}},center:function(){this.centerX(),this.centerY()},centerOnWidget:function(e,t,i){t=t||0,i=i||0,this.setAutoCenter(!1,!1),this.setAutoCenterCallback(null);var s=DOM.getAbsoluteDimensions(e),n=DOM.getAbsoluteDimensions(this.ele),l=s.absoluteRight-s.offsetWidth/2-n.offsetWidth/2+i,o=s.absoluteBottom-s.offsetHeight/2-n.offsetHeight/2+t;l=0>l?0:l,o=0>o?0:o,DOM.setLeft(this.ele,l),DOM.setTop(this.ele,o)},centerX:function(){if(this.visible&&this.visible()){var e=DOM.getClientDimensions(),t=e.x/2-this.ele.offsetWidth/2;if(!this.fixedPosition){var i=DOM.getWindowScroll();t+=i.left}DOM.setLeft(this.ele,t)}},centerY:function(){if(this.visible&&this.visible()){var e=DOM.getClientDimensions(),t=e.y/2-this.ele.offsetHeight/2;if(!this.fixedPosition){var i=DOM.getWindowScroll();t+=i.top}DOM.setTop(this.ele,t)}},setAutoCenter:function(e,t){return this.autoCenterX=e||!1,this.autoCenterY=t||!1,e||t?void this.autoCenter():void this.setAutoCenterCallback(null)},setDimensions:function(e,t){e+="",t+="",e.match(/^\d+$/)&&(e+="px"),t.match(/^\d+$/)&&(t+="px"),this.ele.style.width=e,this.ele.style.height=t},moveForward:function(e){e||(e=1),this.ele&&(this.ele.style.zIndex+=e)},moveBackward:function(e){e||(e=1),this.ele&&(this.ele.style.zIndex-=e)},setLocation:function(e,t){this.setLeft(e),this.setTop(t)},setTop:function(e){"string"!=typeof e&&(e+="px"),this.ele.style.top=e},setLeft:function(e){"string"!=typeof e&&(e+="px"),this.ele.style.left=e},getElement:function(){return this.ele},setContent:function(e){this.content.innerHTML=e},setContentElement:function(e){for(;this.content.firstChild;)this.content.removeChild(this.content.firstChild);!function(e){return e}(),this.content.appendChild(e)},setFadeIn:function(e){this.fadeIn=e},setFadeOut:function(e){this.fadeOut=e},setFadeSpeed:function(e){this.fadeSpeed=e},show:function(){if(this.shown=!0,this.fadeIn){var e=.01;changeOpac(this.ele,e)}document.body.appendChild(this.ele),this.ele.style.position="absolute",(this.autoCenterX||this.autoCenterY)&&this.center(),this.updateContent(),this.resizeHandlerFunc||(this.resizeHandlerFunc=this.resizeHandler.bindEventListener(this),DOM.addEventListener(window,"resize",this.resizeHandlerFunc,!1)),this.fadeIn&&this.fade("in"),this.hideSelects()},fade:function e(t,i){var s,n,l=10;"in"==t?(n=1/l,s=.1):(s=this.ele.style.opacity?finiteFloat(this.ele.style.opacity):.99,n=-1/l);var o=this.fadeSpeed;o||(o=1);var a=l/o*5;this.fadeMode=t;var h=this,e=function r(){return s+=n,h.fadeMode&&h.fadeMode!=t?void(i&&i.call(h,[])):.1>=s?(i&&i.call(h,[]),void(h.fadeMode=null)):s>=1?(i&&i.call(h,[]),void(h.fadeMode=null)):(changeOpac(h.ele,s),void window.setTimeout(r,a))};e()},hide:function(){this.visible()&&(this.fadeOut&&this.ele?this.fade("out",this._hide.bind(this)):this._hide())},_hide:function(){this.hiddenCallback&&this.hiddenCallback(),this.shown=!1,this.removeClickHandlers(),this.ele&&document.body.removeChild(this.ele),this.resizeHandlerFunc&&DOM.removeEventListener(window,"resize",this.resizeHandlerFunc),this.showSelects()},setAutoHideSelects:function(e){this.autoHideSelects=e,this.updateContent()},hideSelects:function(){if(this.autoHideSelects&&IPPU.isIE())for(var e,t=document.getElementsByTagName("select"),i=0;i<t.length;i++)e=t[i],e&&(DOM.getAncestorsByClassName(e,"ippu",!0).length>0||"hidden"!=e.style.visibility&&(e.style.visibility="hidden",this.hiddenSelects.push(e)))},showSelects:function(){if(this.autoHideSelects)for(var e;e=this.hiddenSelects.pop();)e.style.visibility=""},init:function(e){var t=document.createElement("div");this.ele=t,this.shown=!1,this.autoCenterX=!1,this.autoCenterY=!1,this.titlebar=null,this.title="",this.showTitlebar=!1,this.clickToClose=!1,this.modal=!1,this.clickHandlerSetup=!1,this.docOverlay=!1,this.visibleOverlay=!1,this.clickHandlerFunc=!1,this.resizeHandlerFunc=!1,this.fixedPosition=!1,this.autoCenterCallback=null,this.cancelledCallback=null,this.autoHideSelects=!1,this.hiddenCallback=null,this.fadeOut=!1,this.fadeIn=!1,this.hiddenSelects=[],this.fadeMode=null,t.style.position="absolute",t.style.top=0,t.style.zIndex="1000",DOM.addClassName(t,"ippu"),this.content=document.createElement("div"),this.content.innerHTML=e,this.ele.appendChild(this.content)}}),IPPU.center=function(e){e.centerX(),e.centerY()},IPPU.centerX=function(e){e.centerX()},IPPU.centerY=function(e){e.centerY()},IPPU.isIE=function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")?!0:!1},IPPU.isSafari=function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("safari")?!0:!1};
/* <<< file end: js/ippu.js */

//# map link was there [ippu.js.map]
/* >>> file start: js/lj_ippu.js */
//= require js/deprecated/dom.js
//= require js/ippu.js
LJ_IPPU=new Class(IPPU,{init:function(e){e||(e=""),LJ_IPPU.superClass.init.apply(this,[]),this.uniqId=this.generateUniqId(),this.cancelThisFunc=this.cancel.bind(this),this.setTitle(e),this.setTitlebar(!0),this.setTitlebarClass("lj_ippu_titlebar"),this.addClass("lj_ippu"),this.setAutoCenterCallback(IPPU.center),this.setDimensions(514,"auto"),this.setFixedPosition(!0),this.setClickToClose(!0),this.setAutoHideSelects(!0)},setTitle:function(e){var t="      <div style='float:right; padding-right: 8px'><img src='"+Site.imgprefix+"/CloseButton.gif?v=7618' width='15' height='15' id='"+this.uniqId+"_cancel' /></div>"+e;LJ_IPPU.superClass.setTitle.apply(this,[t])},generateUniqId:function(){var e=new Date;return"lj_ippu_"+e.getHours()+e.getMinutes()+e.getMilliseconds()},show:function(){LJ_IPPU.superClass.show.apply(this);var e=this.setup_lj_ippu.bind(this);this.timerSetup=window.setTimeout(e,300)},setup_lj_ippu:function(e){var t=this.cancelThisFunc;$(this.uniqId+"_cancel").onclick=function(){t()}},hide:function(){clearInterval(this.timerSetup),LJ_IPPU.superClass.hide.apply(this)}}),LJ_IPPU.showNote=function(e,t,i,s){var n=document.createElement("div");return n.innerHTML=e,LJ_IPPU.showNoteElement(n,t,i,s)},LJ_IPPU.showErrorNote=function(e,t,i){return LJ_IPPU.showNote(e,t,i,"ErrorNote")},LJ_IPPU.showNoteElement=function(e,t,i,s){var n=new IPPU;n.init();var o=document.createElement("div");DOM.addClassName(o,"Inner"),o.appendChild(e),n.setContentElement(o),n.setTitlebar(!1),n.setFadeIn(!0),n.setFadeOut(!0),n.setFadeSpeed(4),n.setDimensions("auto","auto"),s||(s="Note"),n.addClass(s);var a;if(!t||(a=DOM.getAbsoluteDimensions(t))){var l=DOM.getClientDimensions();if(l){if(a){n.setAutoCenter(!1,!1),n.setLocation(a.absoluteLeft,a.absoluteBottom+4),n.show();var u=DOM.getAbsoluteDimensions(n.getElement());u.absoluteRight>l.x&&n.setLocation(l.x-u.offsetWidth-30,a.absoluteBottom+4)}else n.setAutoCenter(!0,!0),n.show();return n.setClickToClose(!0),n.moveForward(),void 0===i&&(i=5e3),i&&window.setTimeout(function(){n&&n.hide()},i),n}}},LJ_IPPU.textPrompt=function(e,t,i,s){s=s||{},e+="";var n=new LJ_IPPU(e),o=document.createElement("div");DOM.addClassName(o,"ljippu_textprompt"),t&&o.appendChild(_textDiv(t));var a=document.createElement("textarea");DOM.addClassName(a,"htmlfield"),a.cols=40,a.rows=5,o.appendChild(a);var l=document.createElement("div");DOM.addClassName(l,"submitbtncontainer");var u=document.createElement("input");DOM.addClassName(u,"submitbtn"),u.type="button",u.value="Insert",l.appendChild(u),o.appendChild(l),n.setContentElement(o),n.setAutoCenter(!0,!0),n.setDimensions(s.width||"60%","auto"),n.show(),a.focus(),DOM.addEventListener(u,"click",function(e){n.hide(),i&&i.apply(null,[a.value])})};
/* <<< file end: js/lj_ippu.js */

//# map link was there [lj_ippu.js.map]
/* >>> file start: js/esn.js */
//= require js/lj_ippu.js
//= require js/deprecated/dom.js
var ESN={};!function(t,e){e.initCheckAllBtns=function(){var e=t("ntypeids"),n=t("catids");e&&n&&(ntidList=e.value,catidList=n.value,ntidList&&catidList&&(e=ntidList.split(","),n=catidList.split(","),n.forEach(function(n){e.forEach(function(e){var r="SubscribeCheckbox-"+n+"-"+e,i=new CheckallButton;i.init({"class":r,button:t("CheckAll-"+n+"-"+e),parent:t("CategoryRow-"+n)})})})))},e.initTrackBtns=function(t){if(LJ.get("remote")){t=t||document;var n=DOM.getElementsByTagAndClassName(t,"img","TrackButton");n.forEach(function(t){t&&t.getAttribute&&(t.getAttribute("lj_subid")||t.getAttribute("lj_journalid"))&&(!t.getAttribute("lj_dtalkid")||LJ.get("remote_can_track_threads"))&&DOM.addEventListener(t,"click",e.trackBtnClickHandler.bindEventListener(t))})}},e.trackBtnClickHandler=function(t){var n=t.target;if(!n||"img"!=n.tagName.toLowerCase())return!0;Event.stop(t);var r={};["arg1","arg2","etypeid","newentry_etypeid","newentry_token","newentry_subid","journalid","subid","auth_token"].forEach(function(t){r[t]=n.getAttribute("lj_"+t)});var i=document.createElement("div"),a=_textDiv("Email me when");DOM.addClassName(a,"track_title"),i.appendChild(a);var o=function(t,e){var n=document.createElement("div"),r=document.createElement("input");r.type="checkbox",r.id="newentrytrack"+Unique.id();var a=document.createElement("label");return a.setAttribute("for",r.id),a.innerHTML=t,n.appendChild(r),n.appendChild(a),i.appendChild(n),r.checked=e?!0:!1,r};e.trackPopup&&(e.trackPopup.hide(),e.trackPopup=null);var u=document.createElement("input");u.type="button",u.value="Save Changes",DOM.addClassName(u,"track_savechanges");var s,c,d=Number(r.newentry_subid)?1:0,l=Number(r.subid)?1:0;n.getAttribute("lj_dtalkid")?c=o("someone replies in this comment thread",1):(s=o(n.getAttribute("lj_username")+" posts a new entry",d),c=o("someone comments on this post",l)),DOM.addEventListener(u,"click",function(){e.toggleSubscriptions(r,t,n,{newEntry:s?s.checked:!1,newComments:c.checked}),e.trackPopup&&e.trackPopup.hide()});var b=document.createElement("div");DOM.addClassName(b,"track_btncontainer"),i.appendChild(b),b.appendChild(u);var p=document.createElement("a");return p.href=n.parentNode.href,b.appendChild(p),p.innerHTML="More Options",DOM.addClassName(p,"track_moreopts"),e.trackPopup=new LJ_IPPU.showNoteElement(i,n,0),DOM.addEventListener(p,"click",function(t){return Event.stop(t),document.location.href=n.parentNode.href,e.trackPopup&&e.trackPopup.hide(),!1}),!1},e.toggleSubscriptions=function(t,n,r,i){if(t.subid=Number(t.subid),(t.subid&&!i.newComments||!t.subid&&i.newComments)&&e.toggleSubscription(t,n,r,"newComments"),t.newentry_subid=Number(t.newentry_subid),t.newentry_subid&&!i.newEntry||!t.newentry_subid&&i.newEntry){var a=new Object(t);a.subid=Number(r.getAttribute("lj_newentry_subid")),e.toggleSubscription(a,n,r,"newEntry")}},e.toggleSubscription=function(t,n,r,i){var a="",o={auth_token:"newEntry"==i?t.newentry_token:t.auth_token};if(Number(t.subid))a="delsub",o.subid=t.subid;else{a="addsub";var u;"newEntry"==i?(o.etypeid=t.newentry_etypeid,u=["journalid"]):u=["journalid","arg1","arg2","etypeid"],u.forEach(function(e){Number(t[e])&&(o[e]=parseInt(t[e]))})}o.action=a;var s={method:"POST",url:LiveJournal.getAjaxUrl("esn_subs"),data:HTTPReq.formEncoded(o)},c=function(t){if(!t)return LJ_IPPU.showNote("Error changing subscription",r);if(t.error)return LJ_IPPU.showNote(t.error,r);if(t.success){if(t.msg&&LJ_IPPU.showNote(t.msg,r),t.subscribed){t.subid&&r.setAttribute("lj_subid",t.subid),t.newentry_subid&&r.setAttribute("lj_newentry_subid",t.newentry_subid),r.setAttribute("title","Untrack This");var n=r.getAttribute("lj_dtalkid");n?e.updateThreadIcons(n,"on"):r.src=LJ.get("imgprefix")+"/btn_tracking.gif?v=17312"}else{"LJ::Event::JournalNewComment"==t.event_class?r.setAttribute("lj_subid",0):"LJ::Event::JournalNewEntry"==t.event_class&&r.setAttribute("lj_newentry_subid",0),r.setAttribute("title","Track This");var n=r.getAttribute("lj_dtalkid");if(n){for(var i,a="off",o=n;(i=e.getThreadParentBtn(o))&&(o=i.getAttribute("lj_dtalkid"));)if(Number(i.getAttribute("lj_subid"))){a="parent";break}e.updateThreadIcons(n,a)}else r.src=LJ.get("imgprefix")+"/btn_track.gif?v=17312"}t.auth_token&&r.setAttribute("lj_auth_token",t.auth_token),t.newentry_token&&r.setAttribute("lj_newentry_token",t.newentry_token)}};s.onData=c,s.onError=function(t){LJ_IPPU.showNote("Error: "+t)},HTTPReq.getJSON(s)},e.getThreadParentBtn=function(e){var n=LJ_cmtinfo[e+""];if(!n)return null;var r=n.parent;return r?t("lj_track_btn_"+r):null},e.updateThreadIcons=function(n,r){var i=t("lj_track_btn_"+n);if(i){var a=LJ_cmtinfo[n+""];if(a&&(!Number(i.getAttribute("lj_subid"))||"on"==r)){a.rc&&a.rc.length&&a.rc.forEach(function(t){window.setTimeout(function(){var n;switch(r){case"on":n="parent";break;case"off":n="off";break;case"parent":n="parent";break;default:alert("Unknown tracking state "+r)}e.updateThreadIcons(t,n)},300)});var o;switch(r){case"on":o="/btn_tracking.gif?v=17312";break;case"off":o="/btn_track.gif?v=17312";break;case"parent":o="/btn_tracking_thread.gif?v=17312";break;default:alert("Unknown tracking state "+r)}i.src=LJ.get("imgprefix")+o}}},jQuery(function(t){e.initCheckAllBtns(),e.initTrackBtns(),t("#settings_form").on("click","a.delete-group",function(e){var n=this.search.match(/delete_group=([-\d]+)/),r=n?n[1]:null;e.preventDefault(),r&&(t.post(location.href,{delete_group:r}),t(this).closest("tr").remove())})})}(DOM.getElement,ESN);
/* <<< file end: js/esn.js */

//# map link was there [esn.js.map]
/* >>> file start: js/jquery/jquery.lj.confirmbubble.js */
LJ.UI.registerTemplate('templates-Widgets-popupcontent', "<div class=\" b-popup-content {{if $data.options_centered}} b-popup-options-centered {{/if}} \" > {{if $data.show_header}} <div class=\"b-popup-content-header\"> <span> {{html $data.header_text}} </span> </div> {{/if}} <div class=\"b-popup-content-confirm\"> {{html $data.confirm_text}} </div> {{if $data.show_check}} <div class=\"b-popup-content-inner\"> <input id=\"b-popup-check\" type=\"checkbox\" class=\"b-popup-check\" > <label for=\"b-popup-check\" class=\"b-popup-check-text\" >{{html $data.check_text}}</label> </div> {{/if}} <div class=\"b-popup-submit-options\"> <button type=\"button\" class=\"b-popup-btn b-flatbutton b-flatbutton-simple\" >{{html $data.yes_text}}</button> <button type=\"button\" class=\"b-popup-cancel b-flatbutton b-flatbutton-simple b-flatbutton-neutral\" >{{html $data.no_text}}</button> </div> </div> ", 'JQuery.stat');
!function(t,e){t.widget("lj.confirmbubble",t.lj.basicWidget,{options:{selectors:{ok:".b-popup-btn",cancel:".b-popup-cancel",check:".b-popup-check"},templates:{content:"templates-Widgets-popupcontent"},confirm:jQuery.noop,confirmText:"",yesText:"",noText:"",checkText:"",headerText:"",showCheck:!1,showHeader:!1},_create:function(){t.lj.basicWidget.prototype._create.apply(this),this._content=this._tmpl("content",{confirm_text:this.options.confirmText,yes_text:this.options.confirmYes||LJ.ml("confirm.bubble.yes"),no_text:this.options.confirmNo||LJ.ml("confirm.bubble.no"),show_check:this.options.showCheck,show_header:this.options.showHeader,header_text:this.options.headerText,check_text:this.options.checkText}),this._bindControls(),this._content.bubble({showOn:"click",target:this.element}),this.options.showCheck&&this._content.find(this._s("ok")).attr("disabled",!0),Function.defer(this._content.bubble.bind(this._content,"show"))},_bindControls:function(){var e=this,o=this._content,i=o.find(this._s("ok")),n=this.options;t.lj.basicWidget.prototype._bindControls.apply(this),o.on("click",this._s("ok"),function(t){o.bubble("hide"),n.confirm()}).on("change",this._s("check"),function(e){t(this).attr("checked")?i.removeAttr("disabled"):i.attr("disabled",!0)}).on("click",this._s("cancel"),function(t){o.bubble("hide")}).on("bubblehide",function(t){e._trigger("hide")}).on("bubbleshow",function(t){e._trigger("show")})},show:function(){this._content.bubble("show")},hide:function(){this._content.bubble("hide")}})}(jQuery,this);
/* <<< file end: js/jquery/jquery.lj.confirmbubble.js */

//# map link was there [jquery.lj.confirmbubble.js.map]
/* >>> file start: js/jquery/jquery.lj.ljcut.js */
!function(t){return t}(),function(t){"use strict";var e=[];t.widget("lj.ljcut",t.lj.basicWidget,{options:{journalid:null,ditemid:null,cutid:null,placeholders:0,sticky:!1,selectors:{expand:".ljcut-link-expand",collapse:".ljcut-link-collapse",collapseLink:".ljcut-pseudolink-collapse",stickyLink:".b-sticky-cut-link"},classNames:{preloader:"ljcut-link-expanding",expanded:"ljcut-expanded","sticky-cut-visible":"b-sticky-cut-visible",cut:".b-sticky-cut"}},_create:function(){t.lj.basicWidget.prototype._create.apply(this),this._window=t(window),this.cut=t(this._cl("cut")),this._stickyCollapseHandler=this._collapse.bind(this),this.content=null,this._isMac=/Mac/.test(navigator.userAgent),this._isOpera=/Opera/.test(navigator.userAgent),this._collapseNode=t('<span class="ljcut-pseudolink"><span class="ljcut-decor"><span class="ljcut-pseudolink-collapse">{close}</span></span></span>'.supplant({close:this._ml("collapse")})),this._bindControls(),this._id=e.length,e[this._id]=!1},_bindControls:function(){var e=!1,i=[this._s("expand"),this._s("collapse")].join(", ");t.lj.basicWidget.prototype._bindControls.apply(this),this.element.on("click",this._s("expand"),this._expand.bind(this)),this.element.on("click",this._s("collapse"),this._collapse.bind(this)),this.element.on("touchstart",i,function(){e=!0}),this.element.on("touchmove",i,function(){e=!1}),this.element.on("touchend",i,function(i){e&&(t(i.target).trigger("click"),i.preventDefault())}),t(document).on("keydown",this._shortcuts.bind(this)),this._window.on("scroll",this._scrolling.bind(this))},_shortcuts:function(t){var e=this._isMac&&this._isOpera?t.metaKey:t.ctrlKey,i=t.altKey;if(e&&i){switch(t.which){case 61:case 187:this.expand();break;case 173:case 31:case 109:case 189:this.collapse()}t.preventDefault()}},_togglePreloader:function(t){this.element.toggleClass(this._cl("preloader"),t)},_toggleContent:function(e,i){var s,n=this;!this.locked()&&this.content&&(this._lock(),"function"!=typeof i&&(i=t.noop),this.element.toggleClass(n._cl("expanded"),e),e?this._showContent(i):(s=this.element.offset().top-30,this.element.is(":screenable")?this._hideContent(i):t("body,html").animate({scrollTop:s},300,function(){setTimeout(n._hideContent.bind(n,i),50)})))},_showContent:function(t){var e=this;this.content.show(50,function(){e._trigger("show",null,e),t(),e._unlock()})},_hideContent:function(t){var e=this;this.content.slideUp(50,function(){e._trigger("hide",null,e),t(),e._unlock()})},_requestContent:function(e){var i=this;this._lock(),this._togglePreloader(!0),LJ.Api.call("event.get_lj_cut",e,function(e){i.content=t("<div />",{html:e.text}).hide(),i.content.find("a:not([target])").attr("target","_self"),i.element.after(i.content),i._unlock(),i._togglePreloader(!1),i._toggleContent(!0,i._addHandlers.bind(i)),e.counter_image_url&&LJ.Stat.addCounter(e.counter_image_url)})},_addHandlers:function(){this.content.ljLikes(),LJ.Event.trigger("social:widgets:parse")},expand:function(){this.locked()||(this.content?this._toggleContent(!0):this._requestContent({journalid:this.options.journalid,ditemid:this.options.ditemid,cutid:this.options.cutid,placeholders:this.options.placeholders}))},collapse:function(){this.locked()||(this._toggleContent(!1),this._toggleStickyClass(!1))},_expand:function(t){return t.metaKey||t.ctrlKey?!0:(t.preventDefault(),void this.expand())},_collapse:function(t){return t.metaKey||t.ctrlKey?!0:(t.preventDefault(),e[this._id]=!1,void this.collapse())},_scrolling:function(){this._updateStickyCutState()},_updateStickyCutState:function(){var i,s,n,o,l,c,a;this._isExpanded()&&this.options.sticky&&this.content&&(i=this._window.height(),s=t(document).scrollTop(),n=this.content.height(),o=this.content.offset().top,l=o+n,a=this.element.find(this._s("collapse")),c=s>o&&l-i>s,e[this._id]=c,this._toggleStickyClass(c))},_toggleStickyClass:function(i){this.cut.toggleClass(this._cl("sticky-cut-visible"),e.indexOf(!0)>-1),i?t(document).on("click",this._s("stickyLink"),this._stickyCollapseHandler):t(document).off("click",this._s("stickyLink"),this._stickyCollapseHandler)},_addBottomCollapser:function(){return!this._bottomCloser&&this.options.sticky&&(this._bottomCloser=this._collapseNode.appendTo(this.content),this._bottomCloser.find(this._s("collapseLink")).on("click",this._bottomCloserClickHandler.bind(this))),this._bottomCloser},_bottomCloserClickHandler:function(){event.preventDefault(),this.collapse()},_isExpanded:function(){return this.element.hasClass(this._cl("expanded"))},_isCollapsed:function(){return!this._isExpanded()}})}(jQuery);
/* <<< file end: js/jquery/jquery.lj.ljcut.js */

//# map link was there [jquery.lj.ljcut.js.map]
/* >>> file start: js/fb-select-image.js */
jQuery(function(){function e(e,t){jQuery("<div>"+t+"</div>").find("img").each(function(){e.push(this.src)})}function t(e){g.close()}var i=$("repost_facebook"),s=$("repost_facebook_thumbnail"),a=$("select-fb-thumbnail"),n=$("select-fb-thumbnail-comments"),r=$("userpic_preview_image"),o=$("fbimg_select_window"),p=$("fbimg_select_window_nav"),l=a||n,c="nothumb",h="userpic";if(null!=l){var u={};u=a?{getText:function(){return window.switchedRteOn?CKEDITOR.instances.draft.getData():jQuery("#draft").val()},getUserPic:function(){return r?r.src:""}}:{getText:function(){var e=$("commenttext")||$("body");return e.value},getUserPic:function(){var e=jQuery("#userpics > [name=prop_picture_keyword]");if(0==e.length&&(e=jQuery("#prop_picture_keyword")),0==e.length)return"";var t=e.val();return t in userpicmap?userpicmap[t]:defaultpicurl||""}};var g={init:function(){this.opened=!1,this.page=1,this.totalImages=1,this.pager={prev:jQuery(p).children(".i-repost-nav-prev"),next:jQuery(p).children(".i-repost-nav-next"),counter:jQuery(p).children(".i-repost-nav-counter")},this.listWrapper=jQuery(o).children(".b-repost-pics-wrapper"),this.list=this.listWrapper.children(".b-repost-pics-items"),this.pagerSize=4,this.pagesNum=1,this.cellWidth=0,this.pager.prev.click(function(){g.changePage(-1)}),this.pager.next.click(function(){g.changePage(1)}),this.firstLi=this.list.children("span:first").click(function(){g.setPicture(c)})},setPicture:function(e){s.value=e,this.close()},updatePager:function(){p.style.display=this.totalImages<this.pagerSize?"none":"block",this.pager.prev[1==this.page?"addClass":"removeClass"]("i-repost-nav-prev-dis"),this.pager.next[this.page==this.pagesNum?"addClass":"removeClass"]("i-repost-nav-next-dis"),this.pager.counter.html(this.page+"/"+this.pagesNum)},makeListItem:function(e,t,i){var s=i?"b-repost-pics-active":"";return jQuery("<span>").addClass(s).append(jQuery("<img>").attr("src",e)).click(function(){g.setPicture(t)})},open:function(e){this.list.children("span:gt(0)").remove(),this.totalImages=e.length,this.page=1,0!=e.length&&-1!=jQuery.inArray(s.value,e)||s.value==h||s.value==c||(s.value="");var t=u.getUserPic();if(t.length>0){var i=t;this.makeListItem(i,h,h==s.value).appendTo(this.list),this.totalImages++}this.pagesNum=Math.ceil((this.totalImages+1)/this.pagerSize),this.totalImages>1&&""==s.value&&(s.value=e[0]);for(var a=1,n=0;n<e.length;++n)e[n]==s.value&&(a=Math.floor((n+1+(t.length>0?1:0))/this.pagerSize)+1),this.makeListItem(e[n],e[n],e[n]==s.value).appendTo(this.list);this.firstLi[this.totalImages<=1&&""==s.value||s.value==c?"addClass":"removeClass"]("b-repost-pics-active"),o.style.display="block",this.opened=!0,this.firstLi.each(function(){g.cellWidth=this.offsetWidth+this.offsetLeft});var r=this.pagerSize>this.totalImages?this.cellWidth*(this.totalImages+1)+"px":"";this.listWrapper.css("width",r),this.changePage(a-1)},changePage:function(e){this.page+=e,this.page=this.page<1?1:this.page>this.pagesNum?this.pagesNum:this.page;var t=-this.cellWidth*(this.page-1)*this.pagerSize;this.list.css("left",t+"px"),this.updatePager()},close:function(){o.style.display="none",this.opened=!1}};g.init(),o.onmousedown=function(e){e=e||window.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},l.onmousedown=function(e){e=e||window.event,g.opened&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},l.onclick=function(s){s=s||window.event;var a=[];(null===i.getAttribute("disabled")||i.getAttribute("disabled")===!1)&&(g.opened?t():(a.length=0,e(a,u.getText()),g.open(a),setTimeout(function(){DOM.addEventListener(document,"mousedown",t,!1)},0))),s.preventDefault?s.preventDefault():s.returnValue=!1}}});
/* <<< file end: js/fb-select-image.js */

//# map link was there [fb-select-image.js.map]
/* >>> file start: js/quickreply.js */
QuickReply={lastDiv:"qrdiv",reply:function(e,r,a){var t="ljqrt"+e,l="ljcmt"+e,u=$("parenttalkid"),i=$("replyto"),d=$("dtid"),o=$("qrdiv"),n=$(t),c=$("qrformdiv"),v=$("qrform"),s=$("subject");if(!(u&&i&&d&&o&&n&&v&&c&&s))return!0;u.value=r,d.value=e,i.value=r,"qrdiv"==QuickReply.lastDiv?o.style.display="block":QuickReply.lastDiv!=e;var p=$("comments"),l=$(l);return p&&-1!==p.className.indexOf("entry-comments-s1")&&l?l.appendChild(o):(n.parentNode.insertBefore(o,n),QuickReply._scrollForm()),QuickReply.lastDiv=t,s.value&&s.value!=s.defaultValue&&"Re: "!=s.value.substr(0,4)||(s.value=a,s.defaultValue=a),c.className=n.className||"",!1},more:function(){var e=$("qrform_hidden"),r=$("basepath"),a=$("dtid"),t=$("parenttalkid");return e&&r&&a&&t?(a.value>0&&t.value>0?e.action=r.value+"replyto="+a.value+"#add_comment":e.action=r.value+"mode=reply#add_comment",e.submit(),!1):!1},submit:function e(){var r=$("submitmoreopts"),e=$("submitpost");if(!r||!e)return!1;e.disabled=!0,r.disabled=!0;var a=$("dtid");Number(a.value)||(a.value=0);var t=$("qrform_hidden");return t.action=Site.siteroot+"/talkpost_do.bml",t.submit(),!1},check:function(){var e=$("qrform_hidden");if(!e)return!0;var r=e.body.value.length;return r>4300?(alert("Sorry, but your comment of "+r+" characters exceeds the maximum character length of 4300. Please try shortening it and then post again."),!1):!0},save:function(){var e=$("qrform_hidden");if(!e)return!1;var r=$("do_spellcheck"),a=$("prop_picture_keyword");return $("saved_body").value=e.body.value,$("saved_subject").value=$("subject").value,$("saved_dtid").value=$("dtid").value,$("saved_ptid").value=$("parenttalkid").value,r&&($("saved_spell").value=r.checked),a&&($("saved_upic").value=a.selectedIndex),!1},restore:function(){setTimeout(function(){var e=$("saved_body"),r=$("saved_dtid"),a=$("saved_subject"),t="",l=$("qrform_hidden");if(e&&""!=e.value&&l&&r){a&&(t=a.value),QuickReply.reply(r.value,parseInt($("saved_ptid").value,10),t),l.body.value=e.value;var u=$("prop_picture_keyword");u&&(u.selectedIndex=$("saved_upic").value)}},100)},cloneForm:function(e){var r=jQuery("#qrform"),a=r.find("input"),t=r.find("textarea, select"),l=jQuery("#qrform_hidden");(l.length?l.empty():jQuery('<form id="qrform_hidden" name="qrform" method="POST">')).hide().append(a.clone()).append(t.clone().each(function(e,r){jQuery(r).val(t.eq(e).val())})).appendTo("body"),QuickReply[e]()&&QuickReply.submit()},userpicSelect:function(){var e=new UserpicSelect;e.init(),e.setPicSelectedCallback(function(e,r){var a=$("prop_picture_keyword");if(a){var t=a.options;r.forEach(function(e){for(var r=0;r<t.length;r++){var l=t[r];if(l.value==e)return void(a.selectedIndex=r)}})}}),e.show()},_scrollForm:function(){var e=jQuery("html, body"),r=jQuery(window).scrollTop(),a=r+jQuery(window).height(),t=jQuery("#qrform"),l=t.offset().top,u=l+t.height();(l>r||a>l||u>r||a>u)&&(e.animate({scrollTop:l},"300"),t.find("textarea").focus())}},jQuery(QuickReply.restore),DOM.addEventListener(window,"unload",QuickReply.save);
/* <<< file end: js/quickreply.js */

//# map link was there [quickreply.js.map]
/* >>> file start: js/md5.js */
function array(t){for(i=0;i<t;i++)this[i]=0;this.length=t}function integer(t){return t%4294967296}function shr(t,e){return t=integer(t),e=integer(e),t-2147483648>=0?(t%=2147483648,t>>=e,t+=1073741824>>e-1):t>>=e,t}function shl1(t){return t%=2147483648,t&!0?(t-=1073741824,t*=2,t+=2147483648):t*=2,t}function shl(t,e){t=integer(t),e=integer(e);for(var n=0;e>n;n++)t=shl1(t);return t}function and(t,e){t=integer(t),e=integer(e);var n=t-2147483648,r=e-2147483648;return n>=0?r>=0?(n&r)+2147483648:n&e:r>=0?t&r:t&e}function or(t,e){t=integer(t),e=integer(e);var n=t-2147483648,r=e-2147483648;return n>=0?r>=0?(n|r)+2147483648:(n|e)+2147483648:r>=0?(t|r)+2147483648:t|e}function xor(t,e){t=integer(t),e=integer(e);var n=t-2147483648,r=e-2147483648;return n>=0?r>=0?n^r:(n^e)+2147483648:r>=0?(t^r)+2147483648:t^e}function not(t){return t=integer(t),4294967295-t}function F(t,e,n){return or(and(t,e),and(not(t),n))}function G(t,e,n){return or(and(t,n),and(e,not(n)))}function H(t,e,n){return xor(xor(t,e),n)}function I(t,e,n){return xor(e,or(t,not(n)))}function rotateLeft(t,e){return or(shl(t,e),shr(t,32-e))}function FF(t,e,n,r,i,o,a){return t=t+F(e,n,r)+i+a,t=rotateLeft(t,o),t+=e}function GG(t,e,n,r,i,o,a){return t=t+G(e,n,r)+i+a,t=rotateLeft(t,o),t+=e}function HH(t,e,n,r,i,o,a){return t=t+H(e,n,r)+i+a,t=rotateLeft(t,o),t+=e}function II(t,e,n,r,i,o,a){return t=t+I(e,n,r)+i+a,t=rotateLeft(t,o),t+=e}function transform(t,e){var n=0,r=0,o=0,a=0,u=transformBuffer;for(n=state[0],r=state[1],o=state[2],a=state[3],i=0;i<16;i++)for(u[i]=and(t[4*i+e],255),j=1;j<4;j++)u[i]+=shl(and(t[4*i+j+e],255),8*j);n=FF(n,r,o,a,u[0],S11,3614090360),a=FF(a,n,r,o,u[1],S12,3905402710),o=FF(o,a,n,r,u[2],S13,606105819),r=FF(r,o,a,n,u[3],S14,3250441966),n=FF(n,r,o,a,u[4],S11,4118548399),a=FF(a,n,r,o,u[5],S12,1200080426),o=FF(o,a,n,r,u[6],S13,2821735955),r=FF(r,o,a,n,u[7],S14,4249261313),n=FF(n,r,o,a,u[8],S11,1770035416),a=FF(a,n,r,o,u[9],S12,2336552879),o=FF(o,a,n,r,u[10],S13,4294925233),r=FF(r,o,a,n,u[11],S14,2304563134),n=FF(n,r,o,a,u[12],S11,1804603682),a=FF(a,n,r,o,u[13],S12,4254626195),o=FF(o,a,n,r,u[14],S13,2792965006),r=FF(r,o,a,n,u[15],S14,1236535329),n=GG(n,r,o,a,u[1],S21,4129170786),a=GG(a,n,r,o,u[6],S22,3225465664),o=GG(o,a,n,r,u[11],S23,643717713),r=GG(r,o,a,n,u[0],S24,3921069994),n=GG(n,r,o,a,u[5],S21,3593408605),a=GG(a,n,r,o,u[10],S22,38016083),o=GG(o,a,n,r,u[15],S23,3634488961),r=GG(r,o,a,n,u[4],S24,3889429448),n=GG(n,r,o,a,u[9],S21,568446438),a=GG(a,n,r,o,u[14],S22,3275163606),o=GG(o,a,n,r,u[3],S23,4107603335),r=GG(r,o,a,n,u[8],S24,1163531501),n=GG(n,r,o,a,u[13],S21,2850285829),a=GG(a,n,r,o,u[2],S22,4243563512),o=GG(o,a,n,r,u[7],S23,1735328473),r=GG(r,o,a,n,u[12],S24,2368359562),n=HH(n,r,o,a,u[5],S31,4294588738),a=HH(a,n,r,o,u[8],S32,2272392833),o=HH(o,a,n,r,u[11],S33,1839030562),r=HH(r,o,a,n,u[14],S34,4259657740),n=HH(n,r,o,a,u[1],S31,2763975236),a=HH(a,n,r,o,u[4],S32,1272893353),o=HH(o,a,n,r,u[7],S33,4139469664),r=HH(r,o,a,n,u[10],S34,3200236656),n=HH(n,r,o,a,u[13],S31,681279174),a=HH(a,n,r,o,u[0],S32,3936430074),o=HH(o,a,n,r,u[3],S33,3572445317),r=HH(r,o,a,n,u[6],S34,76029189),n=HH(n,r,o,a,u[9],S31,3654602809),a=HH(a,n,r,o,u[12],S32,3873151461),o=HH(o,a,n,r,u[15],S33,530742520),r=HH(r,o,a,n,u[2],S34,3299628645),n=II(n,r,o,a,u[0],S41,4096336452),a=II(a,n,r,o,u[7],S42,1126891415),o=II(o,a,n,r,u[14],S43,2878612391),r=II(r,o,a,n,u[5],S44,4237533241),n=II(n,r,o,a,u[12],S41,1700485571),a=II(a,n,r,o,u[3],S42,2399980690),o=II(o,a,n,r,u[10],S43,4293915773),r=II(r,o,a,n,u[1],S44,2240044497),n=II(n,r,o,a,u[8],S41,1873313359),a=II(a,n,r,o,u[15],S42,4264355552),o=II(o,a,n,r,u[6],S43,2734768916),r=II(r,o,a,n,u[13],S44,1309151649),n=II(n,r,o,a,u[4],S41,4149444226),a=II(a,n,r,o,u[11],S42,3174756917),o=II(o,a,n,r,u[2],S43,718787259),r=II(r,o,a,n,u[9],S44,3951481745),state[0]+=n,state[1]+=r,state[2]+=o,state[3]+=a}function init(){for(count[0]=count[1]=0,state[0]=1732584193,state[1]=4023233417,state[2]=2562383102,state[3]=271733878,i=0;i<digestBits.length;i++)digestBits[i]=0}function update(t){var e;e=and(shr(count[0],3),63),count[0]<4294967288?count[0]+=8:(count[1]++,count[0]-=4294967296,count[0]+=8),buffer[e]=and(t,255),e>=63&&transform(buffer,0)}function finish(){var t,e=new array(8),n=0,r=0,i=0;for(n=0;4>n;n++)e[n]=and(shr(count[0],8*n),255);for(n=0;4>n;n++)e[n+4]=and(shr(count[1],8*n),255);for(r=and(shr(count[0],3),63),i=56>r?56-r:120-r,t=new array(64),t[0]=128,n=0;i>n;n++)update(t[n]);for(n=0;8>n;n++)update(e[n]);for(n=0;4>n;n++)for(j=0;j<4;j++)digestBits[4*n+j]=and(shr(state[n],8*j),255)}function hexa(t){var e="0123456789abcdef",n="",r=t;for(hexa_i=0;hexa_i<8;hexa_i++)n=e.charAt(Math.abs(r)%16)+n,r=Math.floor(r/16);return n}function MD5(t){var e,n,r,o,a,u,S;for(init(),r=0;r<t.length;r++)e=t.charAt(r),update(ascii.lastIndexOf(e));for(finish(),o=a=u=S=0,i=0;i<4;i++)o+=shl(digestBits[15-i],8*i);for(i=4;i<8;i++)a+=shl(digestBits[15-i],8*(i-4));for(i=8;i<12;i++)u+=shl(digestBits[15-i],8*(i-8));for(i=12;i<16;i++)S+=shl(digestBits[15-i],8*(i-12));return n=hexa(S)+hexa(u)+hexa(a)+hexa(o)}function teste(){testOk||(document.test.o1.value=MD5(document.test.i1.value),document.test.o2.value=MD5(document.test.i2.value),document.test.o3.value=MD5(document.test.i3.value),document.test.o4.value=MD5(document.test.i4.value),document.test.o5.value=MD5(document.test.i5.value),document.test.o6.value=MD5(document.test.i6.value),document.test.o7.value=MD5(document.test.i7.value),testOk=!0)}var state=new array(4),count=new array(2);count[0]=0,count[1]=0;var buffer=new array(64),transformBuffer=new array(16),digestBits=new array(16),S11=7,S12=12,S13=17,S14=22,S21=5,S22=9,S23=14,S24=20,S31=4,S32=11,S33=16,S34=23,S41=6,S42=10,S43=15,S44=21,ascii="01234567890123456789012345678901 !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",testOk=!1;
/* <<< file end: js/md5.js */

//# map link was there [md5.js.map]
/* >>> file start: js/thread_expander.js */
Expander=function(){this.__caller__,this.url,this.id,this.stored_caller,this.iframe,this.is_S1},Expander.Collection={},Expander.make=function(t,e,n,i){var r=(new Expander).set({__caller__:t,url:e.replace(/#.*$/,""),id:n,is_S1:!!i});r.get()},Expander.prototype.set=function(t){for(var e in t)this[e]=t[e];return this},Expander.prototype.getCanvas=function(t,e){return e.document.getElementById("ljcmt"+t)},Expander.prototype.parseLJ_cmtinfo=function(t,e){var n,i,r={},a=t.LJ_cmtinfo;if(!a)return!1;for(i in a)/^\d*$/.test(i)&&(n=this.getCanvas(i,t))&&(r[i]={info:a[i],canvas:n},"function"==typeof e&&e(i,r[i]));return r},Expander.prototype.loadingStateOn=function(){this.stored_caller=this.__caller__.cloneNode(!0),this.__caller__.setAttribute("already_clicked","already_clicked"),this.__caller__.onclick=function(){return!1},this.__caller__.style.color="#ccc"},Expander.prototype.loadingStateOff=function(){this.__caller__&&(this.__caller__.removeAttribute("already_clicked","already_clicked"),this.__caller__.parentNode&&this.__caller__.parentNode.replaceChild(this.stored_caller,this.__caller__));var t=this;window.setTimeout(function(){t.killFrame()},100)},Expander.prototype.killFrame=function(){document.body.removeChild(this.iframe)},Expander.prototype.isFullComment=function(t){return!!Number(t.info.full)},Expander.prototype.killDuplicate=function(t){var e,n,i,r;for(var a in t)/^\d*$/.test(a)&&(r=t[a].canvas,n=r.id,e=n.replace(/_$/,""),i=document.getElementById(e),null!=i?r.parentNode.removeChild(r):(r.id=e,window.ContextualPopup&&ContextualPopup.searchAndAdd(r),window.setupAjax&&setupAjax(r),window.ESN&&ESN.initTrackBtns(r)))},Expander.prototype.getS1width=function(t){var e,n;n=t.getElementsByTagName("img");for(var i=0;i<n.length;i++)if(e=n[i],/dot\.gif$/.test(e.src)){if(e.width)return Number(e.width);break}return!1},Expander.prototype.setS1width=function(t,e){var n,i;i=t.getElementsByTagName("img");for(var r=0;r<i.length;r++)if(n=i[r],/dot\.gif$/.test(n.src)){n.setAttribute("width",e);break}},Expander.prototype.onLoadHandler=function(t){var e=t.contentDocument||t.contentWindow;e=e.document||e;var n=this,i=e.defaultView||e.parentWindow,r={},a=this.parseLJ_cmtinfo(window);this.parseLJ_cmtinfo(i,function(t,e){if(t in a&&(a[t].canvas.id=a[t].canvas.id+"_",r[t]=a[t],!n.isFullComment(a[t])&&n.isFullComment(e)||t===n.id)){var i;n.is_S1&&(i=n.getS1width(a[t].canvas)),a[t].canvas.innerHTML=e.canvas.innerHTML,n.is_S1&&i!==!1&&n.setS1width(a[t].canvas,i),LJ_cmtinfo[t].full=1,LJ_cmtinfo[t].expanded=1}});return this.killDuplicate(r),this.loadingStateOff(),!0},Expander.prototype.toString=function(){return"__"+this.id+"__"},Expander.prototype.get=function(){if(this.__caller__.getAttribute("already_clicked"))return!1;this.loadingStateOn();var t;return t=document.createElement("iframe"),t.onload=function(e){return function(){e.onLoadHandler(t)}}(this),t.style.height="1px",t.style.width="1px",t.style.display="none",t.src=this.url,t.id=this.id,document.body.appendChild(t),this.iframe=t,!0};
/* <<< file end: js/thread_expander.js */

//# map link was there [thread_expander.js.map]
/* >>> file start: js/thread_expander.ex.js */
ExpanderEx=function(){this.__caller__,this.url,this.id,this.stored_caller,this.is_S1},ExpanderEx.Collection={},ExpanderEx.ReqCache={},ExpanderEx.make=function(e,t,n,r,a){var o=(new ExpanderEx).set({__caller__:t,url:n.replace(/#.*$/,""),id:r,is_S1:!!a});o.get(),jQuery.event.fix(e).preventDefault()},ExpanderEx.collapse=function(e,t,n,r,a){var o=(new ExpanderEx).set({__caller__:t,url:n.replace(/#.*$/,""),id:r,is_S1:!!a});o.collapseThread(),jQuery.event.fix(e).preventDefault()},ExpanderEx.prototype.set=function(e){for(var t in e)this[t]=e[t];return this},ExpanderEx.prototype.getCanvas=function(e,t){return t.document.getElementById("ljcmt"+e)},ExpanderEx.prototype.parseLJ_cmtinfo=function(e,t){var n,r,a={},o=e.LJ_cmtinfo;if(!o)return!1;for(r in o)/^\d*$/.test(r)&&(n=this.getCanvas(r,e))&&(a[r]={info:o[r],canvas:n},"function"==typeof t&&t(r,a[r]));return a},ExpanderEx.preloadImg=function(){(new Image).src=Site.imgprefix+"/preloader-s.gif?v=9673"},ExpanderEx.prototype.addPreloader=function(){this.loader=new Image,this.loader.src=Site.imgprefix+"/preloader-s.gif?v=9673",this.loader.className="i-exp-preloader",this.__caller__.parentNode.appendChild(this.loader)},ExpanderEx.prototype.removePreloader=function(){this.loader&&(this.loader.parentNode&&this.loader.parentNode.removeChild(this.loader),delete this.loader)},ExpanderEx.prototype.loadingStateOn=function(){this.addPreloader(),this.stored_caller=this.__caller__.cloneNode(!0),this.__caller__.setAttribute("already_clicked","already_clicked"),this.__caller__.onclick=function(){return!1},this.__caller__.style.color="#ccc"},ExpanderEx.prototype.loadingStateOff=function(){this.__caller__&&(this.__caller__.removeAttribute("already_clicked","already_clicked"),this.__caller__.parentNode&&this.__caller__.parentNode.replaceChild(this.stored_caller,this.__caller__),this.removePreloader())},ExpanderEx.prototype.killFrame=function(){document.body.removeChild(this.iframe)},ExpanderEx.prototype.isFullComment=function(e){return!!Number(e.info.full)},ExpanderEx.prototype.expandThread=function(e){function t(t){for(var n,r=t+1;r<e.length;++r){if(n=e[r].state,"expanded"===n)return!1;if("collapsed"===n)return!0}return!1}this.loadingStateOff();for(var n,r,a=0;a<e.length;++a)if("deleted"===e[a].state&&(LJ_cmtinfo[e[a].thread].is_deleted=!0),e[a].thread in LJ_cmtinfo&&(!e[a].state||"expanded"===e[a].state)){n=e[a].thread,r=ExpanderEx.prepareCommentBlock(jQuery(e[a].html),n,t(a));var o=LiveJournal.CommentManager.updateCell(n,r);n in ExpanderEx.Collection||(ExpanderEx.Collection[n]=o)}for(var a=0;a<e.length;++a)n=e[a].thread,LJ_cmtinfo[n].parent=this.id,e[a].state&&"expanded"===e[a].state&&this.initCommentBlock(jQuery("#ljcmt"+n)[0],n);return!0},ExpanderEx.prototype.collapseThread=function(e){var t=e||this.id;this.collapseBlock(t);for(var n=LJ_cmtinfo[t].rc,r=0;r<n.length;++r)this.collapseThread(n[r])},ExpanderEx.prototype.collapseBlock=function(e){e in ExpanderEx.Collection&&(LiveJournal.CommentManager.updateCell(e,ExpanderEx.Collection[e]),this.initCommentBlock(LiveJournal.CommentManager.getCell(e)[0],e,!0),delete ExpanderEx.Collection[e])},ExpanderEx.prototype.initCommentBlock=function(e,t,n){n?(LJ_cmtinfo[t].full=LJ_cmtinfo[t].oldvars.full,LJ_cmtinfo[t].expanded=LJ_cmtinfo[t].oldvars.expanded,delete LJ_cmtinfo[t].oldvars):(LJ_cmtinfo[t].oldvars={full:LJ_cmtinfo[t].full||0,expanded:LJ_cmtinfo[t].expanded||0},LJ_cmtinfo[t].full=1,LJ_cmtinfo[t].expanded=1),window.ContextualPopup&&ContextualPopup.searchAndAdd(e),window.ESN&&ESN.initTrackBtns(e)},ExpanderEx.prototype.toString=function(){return"__"+this.id+"__"},ExpanderEx.prototype.get=function(){if(this.__caller__.getAttribute("already_clicked"))return!1;this.loadingStateOn();var e=this;return setTimeout(function(){LiveJournal.CommentManager.getThreadJSON(e.id,function(t){e.expandThread(t),ExpanderEx.ReqCache[e.id]=t},!1,!1,!0)},0),!0},ExpanderEx.prepareCommentBlock=function(e,t,n){return this.showExpandLink(t,e,n),e},ExpanderEx.showExpandLink=function(e,t,n){var r,a,o="#expand_"+e,i="#collapse_"+e;LJ_cmtinfo[e].has_link>0?(n?(r=i,a=o):(r=o,a=i),t.find(a).css("display","")):r=i+","+o,t.find(r).css("display","none")},ExpanderEx.preloadImg();
/* <<< file end: js/thread_expander.ex.js */

//# map link was there [thread_expander.ex.js.map]
/* >>> file start: js/commentmanage.js */
//!= require js/livejournal.js
function setStyle(e,t,n){if(document.getElementById){var o=document.getElementById(e);o&&o.style&&(o.style[t]=n)}}function setInner(e,t){if(document.getElementById){var n=document.getElementById(e);n&&(n.innerHTML=t)}}function hideElement(e){if(document.getElementById){var t=document.getElementById(e);t&&(t.style.display="none")}}function setAttr(e,t,n){if(document.getElementById){var o=document.getElementById(e);o&&o.setAttribute(t,n)}}function multiformSubmit(e,t){var n=e.mode.value;if(!n)return alert(t.no_action),!1;if("all:"!==n.substring(0,4)){for(var o=-1,r=!1;e[++o];)if("selected_"===e[o].name.substring(0,9)&&e[o].checked){r=!0;break}return r?"delete"===n||"deletespam"===n?confirm(t.conf_delete):void 0:(alert(t.no_comments),!1)}}function getLocalizedStr(e,t){return LJ.ml(e,t)}function hsv_to_rgb(e,t,n){if(0===t)return n*=255,[n,n,n];e*=6;var o=Math.floor(e),r=e-o,i=n*(1-t),a=n*(1-t*r),l=n*(1-t*(1-r));return n=Math.floor(255*n+.5),l=Math.floor(255*l+.5),i=Math.floor(255*i+.5),a=Math.floor(255*a+.5),0===o?[n,l,i]:1===o?[a,n,i]:2===o?[i,n,l]:3===o?[i,a,n]:4===o?[l,i,n]:[n,i,a]}function deleteComment(e,t){t=t||"delete";var n,o,r,i,a=""!==Site.currentJournal?Site.currentJournal:window.LJ_cmtinfo.journal,l=$("ljdelopts"+e),d=$("ljcmt"+e),m=0,c=LiveJournal.getAjaxUrl("delcomment")+"?mode=js&journal="+a+"&id="+e,u="confirm=1";l&&"delete"===t?(l.ban&&l.ban.checked&&(u+="&ban=1"),l.spam&&l.spam.checked&&(u+="&spam=1"),l.delthread&&l.delthread.checked&&(u+="&delthread=1",n=!0),l.delauthor&&l.delauthor.checked&&(u+="&delauthor=1",o=!0),l.deleverywhere&&l.deleverywhere.checked&&(u+="&deleverywhere=1")):"markAsSpam"===t&&(o=n=!0,u+="&ban=1&spam=1&delauthor=1"),u+="&lj_form_auth="+decodeURIComponent(window.LJ_cmtinfo.form_auth);var s={url:c,data:u,method:"POST",onData:function(e){r=!!e,i=!r},onError:function(t){t.indexOf("alert")<0&&alert("Error deleting "+e),i=!0}};HTTPReq.getJSON(s);var p=function f(){var t=hsv_to_rgb(0,Math.cos((m+1)/2),1);m+=3.14159/5;var a="rgb("+t[0]+","+t[1]+","+t[2]+")";if(d.style.border="2px solid "+a,i)d.style.border="";else if(r){if(removeComment(e,n),o&&""!==window.LJ_cmtinfo[e].u)for(var l in window.LJ_cmtinfo)window.LJ_cmtinfo[l].u!==window.LJ_cmtinfo[e].u||window.LJ_cmtinfo[l].is_deleted||removeComment(l,!1)}else window.setTimeout(f,50)};window.setTimeout(p,5)}function removeComment(e,t){if("iframe"!==LiveJournal.CommentManager.getState()){var n=e;LiveJournal.CommentManager.getThreadJSON(n,function(e){LiveJournal.CommentManager.processThreadJSON(e,function(e,t,o){window.LJ_cmtinfo[n].u===window.LJ_cmtinfo[e].u&&(t=ExpanderEx.prepareCommentBlock(t,e),LiveJournal.CommentManager.updateCell(e,t),o.is_deleted&&e in ExpanderEx.Collection&&delete ExpanderEx.Collection[e])})},!0)}else{var o=document.getElementById("ljcmt"+e);if(o){o.style.display="none";var r=window.userhook_delete_comment_ARG;r&&r(e)}}if(t)for(var i=window.LJ_cmtinfo[e],a=0;a<i.rc.length;a++)removeComment(i.rc[a],!0)}function createDeleteFunction(e,t,n){return n=n||"delete",function(o){o=jQuery.event.fix(o||window.event),o.stopPropagation(),o.preventDefault();var r=0;if(o.shiftKey)return r=1,deleteComment(t,n),!0;if(!window.LJ_cmtinfo)return!0;var i=window.LJ_cmtinfo[t],a=window.LJ_cmtinfo[t].u,l=window.LJ_cmtinfo.remote;if(!i||!l)return!0;var d=window.LJ_cmtinfo.canAdmin,m=1===Site.remote_is_maintainer&&""!==i.u?"comment.mark.spam.":"comment.mark.spam2.";if("markAsSpam"===n)return window.ctrlPopup||(window.ctrlPopup=jQuery('<div class="b-popup-ctrlcomm" />').delegate("input.spam-comment-button","click",function(){window.ctrlPopup.bubble("hide")})),window.ctrlPopup.html('<div class="b-popup-group"><div class="b-popup-row b-popup-row-head"><strong>'+getLocalizedStr(m+"title",{username:a})+'</strong></div><div class="b-popup-row">'+getLocalizedStr(m+"subject",{username:a})+'</div><div class="b-popup-row"><input type="button" class="spam-comment-button" onclick="deleteComment('+t+", '"+n+'\');" value="'+getLocalizedStr(m+"button",{username:a})+'"></div><div>',e,o,"spamComment"+t).bubble().bubble("show",e),!0;if("delete"===n){var c,u=['<form id="ljdelopts'+t+'"><div class="b-popup-group"><div class="b-popup-row b-popup-row-head"><strong>'+getLocalizedStr("comment.delete.q",{username:a})+"</strong></div>"];""!==i.username&&i.username!==l&&d&&(c="ljpopdel"+t+"ban",u.push('<div class="b-popup-row"><input type="checkbox" name="ban" id="'+c+'"> <label for="'+c+'">'+getLocalizedStr("comment.ban.user",{username:a})+"</label></div>")),i.rc&&i.rc.length&&d&&(c="ljpopdel"+t+"thread",u.push('<div class="b-popup-row"><input type="checkbox" name="delthread" id="'+c+'"> <label for="'+c+'">'+getLocalizedStr("comment.delete.all.sub",{username:a})+"</label></div>")),i.username===l&&(c="ljpopdel"+t+"author",u.push('<div class="b-popup-row"><input type="checkbox" name="delauthor" id="'+c+'"> <label for="'+c+'">'+getLocalizedStr("comment.delete.all.my")+"</label></div>")),""!==i.username&&i.username!==l&&d&&(c="ljpopdel"+t+"author",u.push('<div class="b-popup-row"><input type="checkbox" name="delauthor" id="'+c+'"> <label for="'+c+'">'+getLocalizedStr("comment.delete.all.author",{author:a})+"</label></div>"),c="ljpopdel"+t+"everywhere",LJ.Flags.isEnabled("superban_step2")&&u.push('<div class="b-popup-row"><input type="checkbox" name="deleverywhere" id="'+c+'"> <label for="'+c+'"> '+getLocalizedStr("comment.delete.all.everywhere",{author:a})+"</label></div>")),u.push('<div class="b-popup-row"><input class="delete-comment-button" type="button" value="'+getLocalizedStr("comment.delete",{username:a})+'" onclick="deleteComment('+t+');" /></div></div><div class="b-bubble b-bubble-alert b-bubble-noarrow"><i class="i-bubble-arrow-border"></i><i class="i-bubble-arrow"></i>'+getLocalizedStr("comment.delete.no.options",{username:a})+"</div></form>"),window.delPopup||(window.delPopup=jQuery('<div class="b-popup-delcomm" />').delegate("input.delete-comment-button","click",function(){window.delPopup.bubble("hide")}));var s,p,f=function(e){return e.length>0&&e.attr("checked")};window.delPopup.bind("bubbleshow",function(){s=jQuery("#ljpopdel"+t+"author"),p=jQuery("#ljpopdel"+t+"everywhere")}).delegate("input[type=checkbox]","click",function(){this===p[0]&&f(p)&&s.attr("checked",!0),this!==s[0]||f(s)||p.attr("checked",!1)}),window.delPopup.html(u.join(" ")).bubble().bubble("show",e)}else"unspam"===n&&deleteComment(t,n)}}function poofAt(e){var t=document.createElement("div");t.style.position="absolute",t.style.background="#FFF",t.style.overflow="hidden";var n=1,o=e.y,r=e.x,i=5,a=5;document.body.appendChild(t);var l=function d(){n-=.15,i+=10,a+=10,o-=5,r-=5,.1>=n?t.parentNode.removeChild(t):(t.style.left=r+"px",t.style.top=o+"px",t.style.height=a+"px",t.style.width=i+"px",t.style.filter="alpha(opacity="+Math.floor(100*n)+")",t.style.opacity=n,window.setTimeout(d,20))};l()}function updateLink(e,t,n){e.href=t.newurl;var o=window["userhook_"+t.mode+"_comment_ARG"],r=0;n&&n.src&&n.src===t.oldimage&&(n.src=t.newimage,r=1),o&&(o(t.id),r=1),r||(e&&e.style&&(e.style.display="none"),n&&n.style&&(n.style.dispay="none"))}function createModerationFunction(control,dItemid,action){action=action||"screen";var comUser=window.LJ_cmtinfo[dItemid].u;return function(e){function sendModerateRequest(){var t="unspam"===action?"spamcomment":"talkscreen",n=control.href.replace(new RegExp(".+"+t+".bml"),LiveJournal.getAjaxUrl(t)),o={confirm:"Y",lj_form_auth:decodeURIComponent(window.LJ_cmtinfo.form_auth)};"unspam"===action&&(n+="&jsmode=1"),hourglass=jQuery(e).hourglass()[0],jQuery.post(n,o,function(e){if(tsInProg[dItemid]=0,"unspam"===action){if(e=jQuery.parseJSON(e),e.result)return removeEmptyMarkup(dItemid),hourglass.hide(),!0;alert(e.errormsg)}if("iframe"!==LiveJournal.CommentManager.getState())handleNew();else{var t=checkRcForNoCommentsPage(e);handleIframe(t)}})}function handleNew(){var e,t,n,o=dItemid,r=!(!window.LJ_cmtinfo[o].oldvars||!window.LJ_cmtinfo[o].full),i=function(o){LiveJournal.CommentManager.processThreadJSON(o,function(o,r){if(window.LJ_cmtinfo[o].full){if(e=!("oldvars"in window.LJ_cmtinfo[o]),!e)for(n=window.LJ_cmtinfo[o].rc,t=0;t<n.length;++t)window.LJ_cmtinfo[n[t]].full||window.LJ_cmtinfo[n[t]].is_deleted||(e=!0);r||removeEmptyMarkup(o);var i=ExpanderEx.prepareCommentBlock(r,o,e);LiveJournal.CommentManager.updateCell(o,i)}}),hourglass.hide(),poofAt(pos)};LiveJournal.CommentManager.getThreadJSON(o,function(e){r&&window.LJ_cmtinfo[o].oldvars.full?LiveJournal.CommentManager.getThreadJSON(o,function(t){ExpanderEx.Collection[o]=ExpanderEx.prepareCommentBlock(jQuery("<div>"+t[0].html+"</div>"),o,!0).html(),i(e)},!0,!0):i(e)},!1,!r)}function handleIframe(ids){jQuery.ajax({url:location.href,type:"GET",dataType:"html",complete:function complete(res,status){if("success"===status||"notmodified"===status){var nodes=jQuery("<div/>").append(res.responseText.replace(/<script(.|\s)*?\/script>/gi,"")).find(ids).each(function(){var id=this.id.replace(/[^0-9]/g,"");if(window.LJ_cmtinfo[id].expanded){var expand=this.innerHTML.match(/Expander\.make\(.+?\)/)[0];(function(){eval(expand)}).apply(document.createElement("a"))}else jQuery("#"+this.id).replaceWith(this)});hourglass.hide(),poofAt(pos)}}})}function checkRcForNoCommentsPage(json){function mapComms(e){for(var t,n=-1;t=window.LJ_cmtinfo[e].rc[++n];)window.LJ_cmtinfo[t].full&&(commsArray.push(t),mapComms(String(t)))}var commsArray=[dItemid],ids;if(window.LJ_cmtinfo[dItemid].rc)/mode=(un)?freeze/.test(control.href)&&mapComms(dItemid),ids="#ljcmt"+commsArray.join(",#ljcmt");else{var rpcRes;if(eval(json),updateLink(control,rpcRes,control.getElementsByTagName("img")[0]),!document.getElementById("ljcmtbar"+dItemid))return hourglass.hide(),void poofAt(pos);ids="#ljcmtbar"+dItemid}return ids}e=jQuery.event.fix(e||window.event);var pos={x:e.pageX,y:e.pageY},modeParam=LiveJournal.parseGetArgs(location.href).mode,hourglass;return e.stopPropagation(),e.preventDefault(),sendModerateRequest(),!1}}function removeEmptyMarkup(e){jQuery("#ljcmt"+e).remove()}function LJ_Mul(e,t){return parseInt(e,10)*parseInt(t,10)}function LJ_JoinURL(e){var t=[].slice.call(arguments,1).join("&");return e+=e.indexOf("?")>-1?"&":"?",e+t}function LJ_Concat(){return[].slice.call(arguments,0).join("")}window.getLocalizedStr=getLocalizedStr;var tsInProg={};!function(e,t){t.LiveJournal.CommentManager=function(){this.bindLinks()},LiveJournal.CommentManager.prototype.bindLinks=function(){e("body").delegate("a","click",function(e){var n,o,r=/id=(\d+)/,i=this;if(-1!==i.href.indexOf("talkscreen.bml")){if(n=r.exec(i.href),!n)return;if(o=n[1],!document.getElementById("ljcmt"+o))return;if(t.LJ_cmtinfo&&createModerationFunction(i,o)(e),!LJ.Flags.isEnabled("recent_comments_v5"))return}else if(-1!==i.href.indexOf("delcomment.bml")){if(t.LJ_cmtinfo&&t.LJ_cmtinfo.disableInlineDelete)return;if(n=r.exec(i.href),!n)return;if(o=n[1],!document.getElementById("ljcmt"+o))return;var a=-1!==i.href.indexOf("spam=1")?"markAsSpam":"delete";if(!LJ.Flags.isEnabled("recent_comments_v5"))return;createDeleteFunction(i,o,a)(e)}else{if(-1===i.href.indexOf("spamcomment.bml"))return;if(n=r.exec(i.href),!n)return;if(o=n[1],!document.getElementById("ljcmt"+o))return;createModerationFunction(i,o,"unspam")(e)}e.preventDefault(),e.stopPropagation()})};t.LiveJournal.CommentManager;t.LiveJournal.CommentManager.getState=function(){return t.LJ_cmtinfo.use_old_thread_expander?"iframe":"old"},LiveJournal.CommentManager.updateCell=function(t,n){var o=e("#ljcmt"+t),r=e("<div></div>").append(o.clone());return o.replaceWith(e(n).filter("#ljcmt"+t)),r.html()},LiveJournal.CommentManager.getCell=function(t){return e("#ljcmt"+t)},LiveJournal.CommentManager.getThreadJSON=function(e,n,o){var r=location.href.match(/\/(\d+).html/)[1],i=LiveJournal.parseGetArgs(location.href).mode,a={journal:Site.currentJournal,itemid:r,thread:e,depth:t.LJ_cmtinfo[e].depth};o&&(a.single="1"),i&&(a.mode=i);var l=LiveJournal.parseGetArgs(location.href);l&&l.style&&"mine"===l.style&&(a.style="mine");var d=LiveJournal.getAjaxUrl("get_thread");jQuery.get(LiveJournal.constructUrl(d,a),n,"json")},LiveJournal.CommentManager.processThreadJSON=function(n,o){for(var r,i,a=0;a<n.length;++a)n[a].thread in t.LJ_cmtinfo&&(r={},r.is_deleted="deleted"===n[a].state,r.is_deleted&&(t.LJ_cmtinfo[n[a].thread].is_deleted=!0),i=e(n[a].html).filter("#ljcmt"+n[a].thread),o(n[a].thread,i,r))},e(function(){new LiveJournal.CommentManager})}(jQuery,window);
/* <<< file end: js/commentmanage.js */

//# map link was there [commentmanage.js.map]
/* >>> file start: js/ljwidget.js */
LJWidget=new Class(Object,{updateContent:function(t){t||(t={}),this._show_frame=t.showFrame,t.method&&(method=t.method),t._widget_update=1,this.doAjaxRequest(t)&&this.hilightFrame()},getWidget:function(){return $(this.widgetId)},doPost:function(t){t||(t={}),this._show_frame=t.showFrame;var e={},i=this.widgetClass;i="Widget["+i.replace(/::/g,"_")+"]_";for(var a in t){var r=a;a.match(/^Widget\[/)||"lj_form_auth"==a||a.match(/^_widget/)||(r=i+a),e[r]=t[a]}e._widget_post=1,this.doAjaxRequest(e)},doPostAndUpdateContent:function(t){t||(t={}),t._widget_update=1,this.doPost(t)},postForm:function(t){if(!t)return!1;for(var e={},i=0;i<t.elements.length;i++){var a=t.elements[i],r=a.name,o=a.value;e[r]=o}this.doPost(e)},init:function(t,e,i){LJWidget.superClass.init.apply(this,arguments),this.widgetId=t,this.widgetClass=e,this.authToken=i},hilightFrame:function(){if(1==this._show_frame&&!this._frame){var t=this.getWidget();if(t){var e=t.parentNode;if(e){var i=document.createElement("fieldset");i.style.borderColor="red";var a=document.createElement("legend");a.innerHTML="Updating...",i.appendChild(a),e.appendChild(i),i.appendChild(t),this._frame=i}}}},removeHilightFrame:function(){if(1==this._show_frame){var t=this.getWidget();if(t&&this._frame){var e=this._frame.parentNode;e&&(e.appendChild(t),e.removeChild(this._frame),this._frame=null)}}},method:"POST",endpoint:"widget",requestParams:{},doAjaxRequest:function(t){if(t||(t={}),this._ajax_updating)return!1;this._ajax_updating=!0,t._widget_id=this.widgetId,t._widget_class=this.widgetClass,t.auth_token=this.authToken,$("_widget_authas")&&(t.authas=$("_widget_authas").value);var e={method:this.method,data:HTTPReq.formEncoded(t),url:LiveJournal.getAjaxUrl(this.endpoint),onData:this.ajaxDone.bind(this),onError:this.ajaxError.bind(this)};for(var i in t)e[i]=t[i];return HTTPReq.getJSON(e),!0},ajaxDone:function(t){if(this._ajax_updating=!1,this.removeHilightFrame(),t._widget_body&&t._widget_body.match(/ajax:.[^"]+/)&&(this.authToken=t._widget_body.match(/ajax:.[^"]+/)[0]),t.auth_token&&(this.authToken=t.auth_token),t.errors&&""!=t.errors)return this.ajaxError(t.errors);if(t.error)return this.ajaxError(t.error);if(this.onData&&this.onData(t),t._widget_body){var e=this.getWidget();if(!e)return;e.innerHTML=t._widget_body,this.onRefresh&&this.onRefresh()}},ajaxError:function(t){this._ajax_updating=!1,this.skipError||(this.onError?this.onError(t):LiveJournal.ajaxError(t))}}),LJWidget.widgets=[];
/* <<< file end: js/ljwidget.js */

//# map link was there [ljwidget.js.map]
/* >>> file start: js/ljwidget_ippu.js */
//= require js/ljwidget.js
//= require js/lj_ippu.js
LJWidgetIPPU=new Class(LJWidget,{init:function(t,e){var i=t.title,n=t.widgetClass,s=t.authToken,a=t.nearElement,l=t.not_view_close;e||(e={}),this.reqParams=e;var o=new LJ_IPPU(i,a);this.ippu=o;var d=document.createElement("div");d.id="LJWidgetIPPU_"+Unique.id(),o.setContentElement(d),t.width&&t.height&&o.setDimensions(t.width,t.height),t.overlay&&(IPPU.isIE()?(this.ippu.setModal(!0),this.ippu.setOverlayVisible(!0),this.ippu.setClickToClose(!1)):(this.ippu.setModal(!0),this.ippu.setOverlayVisible(!0))),t.center&&o.center(),o.show(),l&&(o.titlebar.getElementsByTagName("img")[0].style.display="none");var h=document.createElement("div");h.style.fontSize="1.5em",h.style.fontWeight="bold",h.style.margin="5px",h.style.textAlign="center",h.innerHTML="Loading...",this.loadingText=h,d.appendChild(h);var u=[d.id,n,s];LJWidgetIPPU.superClass.init.apply(this,u);var r=this;return o.setCancelledCallback(function(){r.cancel&&r.cancel()}),n?(this.widgetClass=n,this.authToken=s,this.title=i,this.nearEle=a,window.setInterval(this.animateLoading.bind(this),20),this.loaded=!1,this.loadContent(),this):null},animateCount:0,animateLoading:function(t){var e=this.loadingText;if(this.loaded||!e)return void window.clearInterval(t);this.animateCount+=.05;var i=(Math.sin(this.animateCount)+1)/2*255,n=Math.round(i).toString(16);1==n.length&&(n="0"+n),n+=n+n,e.style.color="#"+n,this.ippu.center()},doAjaxRequest:function(t){t||(t={}),t._widget_ippu=1,document.getElementById("LJ__Setting__InvisibilityGuests_invisibleguests_self")&&(t["Widget[IPPU_SettingProd]_LJ__Setting__InvisibilityGuests_invisibleguests"]=1==document.getElementById("LJ__Setting__InvisibilityGuests_invisibleguests_self").checked?1:1==document.getElementById("LJ__Setting__InvisibilityGuests_invisibleguests_anon").checked?2:0),LJWidgetIPPU.superClass.doAjaxRequest.apply(this,[t])},close:function(){this.ippu.hide()},loadContent:function(){var t=this.reqParams;this.updateContent(t)},method:"POST",onData:function(t){this.loaded=!0},render:function(t){}});
/* <<< file end: js/ljwidget_ippu.js */

//# map link was there [ljwidget_ippu.js.map]
/* >>> file start: js/jquery/jquery.lj.itemlist.js */
!function(t){t.widget("lj.itemList",t.lj.basicWidget,{options:{classNames:{hover:"ljappippu_share_person_hover",lastItem:"ljappippu_share_person_last"},selectors:{last:":last",item:"li"},onNewElement:function(t){return t},onSelect:function(t){},items:[]},_create:function(){if(this.items={},this._length=0,this.options.items.length>0){for(var t=0;t<this.options.items.length;++t)this.add(this.options.items[t]);this.updateLast()}},add:function(s,e){if(!this.hasItem(s)){var e=e||this.options.onNewElement(s);if(e.length){var i=this.options.hoverClass;e.unbind(".itemList"),i&&e.bind("mouseover.itemList",function(){t(this).addClass(i)}).bind("mouseout.itemList",function(){t(this).removeClass(i)}),e.bind("click.itemList",s,this.options.onSelect),this.element[0]!=e[0].parentNode&&this.element.append(e),this.items[s]=e,this._length++}}},hasItem:function(t){return t in this.items},updateLast:function(){if(this.options.classNames.lastItem){this._lastItem&&this._lastItem.removeClass(this.options.classNames.lastItem);var t=this.element.children(this.options.selectors.last);t.size()>0?(this._lastItem=t,this._lastItem.addClass(this.options.classNames.lastItem)):this._lastItem=null}},nodes:function(){var t=jQuery();for(var s in this.items)this.items.hasOwnProperty(s)&&(t=t.add(this.items[s]));return t.length>0?t:null},remove:function(t){this.hasItem(t)&&(this.items[t].unbind(".itemList").remove(),delete this.items[t],this._length--)},empty:function(){for(var t in this.items)this.remove(t)},length:function(){return this._length},item:function(t){return this.items[t]||jQuery()}})}(jQuery);
/* <<< file end: js/jquery/jquery.lj.itemlist.js */

//# map link was there [jquery.lj.itemlist.js.map]
/* >>> file start: js/apps.js */
//= require js/ljwidget_ippu.js
//= require js/jquery/jquery.lj.itemlist.js
var appManager=function(e){return{CONFIG:{globalLJVarName:"LiveJournal",accessRequestElemId:"appPopup_accessRequest",accessSubmitElemId:"appPopup_accessSubmit",accessCancelElemId:"appPopup_accessCancel",accessTitleElemId:"appPopup_accessTitle",accessDescElemId:"appPopup_accessDesc"},init:function(i){var t=this.CONFIG;e.extend(t,i);var s=this.quiz.elems;s.container=e("#"+t.accessRequestElemId),s.submit=e("#"+t.accessSubmitElemId),s.cancel=e("#"+t.accessCancelElemId),s.title=e("#"+t.accessTitleElemId),s.desc=e("#"+t.accessDescElemId),s.buttons=s.submit.add(s.cancel).removeAttr("disabled"),s.userAccessField=s.container.find("input[name=user_access]"),s.idField=s.container.find("input[name=id]"),s.actionField=s.container.find("input[name=action]"),s.extraField=s.container.find("input[name=extra]"),s.userAccessCheckboxes=s.container.find("input[name=user_access_cb]"),this.queryArgs=window[t.globalLJVarName].parseGetArgs(window.location.href),this.action=this.queryArgs.act,this.extra=this.queryArgs.extra||"",this.returnTo=this.queryArgs["return"]||"",this.bindEvents(),this.startDialog()},startDialog:function(){this.quiz.appId=this.queryArgs.id,this.quiz.elems.formToSend=this.quiz.elems.container,this.quiz.action=this.action,this.quiz.extra=this.extra,this.quiz.returnTo=this.returnTo,this.quiz.start()},bindEvents:function(){var e=this;this.quiz.elems.submit.click(function(i){i.preventDefault(),e.quiz.sendResults()}),this.quiz.elems.userAccessCheckboxes.change(function(){var i=e.quiz.elems.userAccessCheckboxes,t=[];i.filter(":checked").each(function(){t.push(this.value)}),e.quiz.results=t.join(",")}).change(),this.quiz.elems.cancel.click(function(i){i.preventDefault(),e.quiz.stop()})},quiz:{appsUrl:"/games",appsSettingsUrl:"/manage/settings/?cat=userapps",appId:"",action:"",elems:{},results:[],start:function(){},stop:function(){this.action="cancel",this.cancelAction()},cancelAction:function(){this.returnTo.length>0&&"settings"==this.returnTo?document.location=this.appsSettingsUrl:document.location=this.appsUrl},sendResults:function(){this.elems.buttons.attr("disabled","disabled"),this.elems.userAccessField.val(this.results),this.elems.idField.val(this.appId),this.elems.actionField.val(this.action),this.elems.extraField.val(this.extra),this.elems.formToSend.submit()}}}}(jQuery),recipientsSelector=function(e){function i(){this._friends=[],this._visibleArr=[],this._needRebuild=!0}function t(e){if(!(0>=e)){var i=s(e);if(!i)return 1===e?c.itemList("empty"):t(e-1),void n();d=e,c.itemList("empty");for(var r=0;r<i.length;++r)c.itemList("add",i[r]);c.itemList("updateLast"),n()}}function s(e){var i,t;if(0===u.perPage?(i=0,t=p.getVisibleLength()):(i=(e-1)*u.perPage,t=e*u.perPage),i>=p.getVisibleLength())return!1;for(var s,n=[],r=i;t>r&&(s=p.getVisibleFriend(r),s);++r)n.push(s.username);return 0===n.length?!1:n}function n(){if(0!==u.perPage){var e=Math.ceil(p.getVisibleLength()/u.perPage);el.counterTotal.html(e),el.counterCurrent.html(d||0),el.firstLink[0===e||1===d?"addClass":"removeClass"](u.firstLinkDis),el.lastLink[0===e||d===e?"addClass":"removeClass"](u.lastLinkDis),el.prevLink[0===e||1===d?"addClass":"removeClass"](u.prevLinkDis),el.nextLink[0===e||d===e?"addClass":"removeClass"](u.nextLinkDis)}}function r(){t(d)}function a(){el.firstLink.mousedown(function(e){t(1),e.preventDefault()}),el.lastLink.mousedown(function(e){var i=Math.ceil(p.getVisibleLength()/u.perPage);t(i),e.preventDefault()}),el.prevLink.mousedown(function(e){t(d-1),e.preventDefault()}),el.nextLink.mousedown(function(e){t(d+1),e.preventDefault()})}function l(e){p.filterFriends(e),t(d)}var o={perPage:20,personsContainerSelector:".ljappippu_share_persons",personsTpl:"#ljappippu_share_person",firstLink:".i-qotd-nav-first",lastLink:".i-qotd-nav-last",prevLink:".i-qotd-nav-prev",nextLink:".i-qotd-nav-next",firstLinkDis:"i-qotd-nav-first-dis",lastLinkDis:"i-qotd-nav-last-dis",prevLinkDis:"i-qotd-nav-prev-dis",nextLinkDis:"i-qotd-nav-next-dis",counterCurrent:".i-pages-current",counterTotal:".i-pages-total",onSelect:function(e){}};i.prototype._rebuildVisible=function(){this._visibleArr=[];for(var e=0;e<this._friends.length;++e)this._friends[e].visible&&this._friends[e].filtered&&this._visibleArr.push(this._friends[e]);this._needRebuild=!1},i.prototype.add=function(e,i){this._friends.push({username:e,visible:i,filtered:!0}),i&&this._visibleArr.push(this._friends)},i.prototype.setVisible=function(e,i){var t=this.getFriend(e);return t&&t.username===e?t.visible!=i?(t.visible=i,this._needRebuild=!0,!0):!1:void 0},i.prototype.getVisibleLength=function(){return this._needRebuild&&this._rebuildVisible(),this._visibleArr.length},i.prototype.getVisibleFriend=function(i){return this._needRebuild&&this._rebuildVisible(),i>=0&&i<this._visibleArr.length?e.extend({},this._visibleArr[i]):null},i.prototype.getFriend=function(e){for(var i=0;i<this._friends.length;++i)if(this._friends[i].username===e)return this._friends[i];return null},i.prototype.filterFriends=function(e){e=e||"";for(var i,t,s=0;s<this._friends.length;++s)t=this._friends[s],i=t.filtered,t.filtered=e.length>0?-1!==t.username.indexOf(e):!0,i!==t.filtered&&(this._needRebuild=!0);this._needRebuild&&this._rebuildVisible()};var u,c,d,p;return{init:function(s){u=e.extend({},o,s),el={firstLink:e(u.firstLink),lastLink:e(u.lastLink),prevLink:e(u.prevLink),nextLink:e(u.nextLink),counterCurrent:e(u.counterCurrent),counterTotal:e(u.counterTotal),personsContainer:e(u.personsContainer),personsTpl:e(u.personsTpl)},c=e(".ljappippu_share_persons").itemList({classNames:{hover:"ljappippu_share_person_hover"},onNewElement:function(e){return el.personsTpl.tmpl({username:e})},onSelect:function(e){var i=e.data;u.onSelect(p.getFriend(i)),p.setVisible(i,!1)&&r(),e.preventDefault()}}),p=new i;for(var n=0;n<u.friends.length;++n)p.add(u.friends[n].display_name,!u.friends[n].selected);a(),t(1)},add:function(e){p.setVisible(e,!0)&&r()},filter:function(e){l(e)}}}(jQuery);
/* <<< file end: js/apps.js */

//# map link was there [apps.js.map]
/* >>> file start: js/apps/appcontainer.js */
function _typeof(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}var gadgets=window.gadgets||{},shindig=window.shindig||{},osapi=window.osapi||{},livejournal=window.livejournal||{};gadgets.util=gadgets.util||{},gadgets.util.makeClosure=function(e,t){for(var n=[],i=2,r=arguments.length;r>i;++i)n.push(arguments[i]);return function(){for(var i=n.slice(),r=0,a=arguments.length;a>r;++r)i.push(arguments[r]);return t.apply(e,i)}},gadgets.util.makeEnum=function(e){var t,n,i={};for(t=0;n=e[t];++t)i[n]=n;return i},gadgets.util=gadgets.util||{},function(){gadgets.util.createElement=function(e){var t;if(!document.body||document.body.namespaceURI)try{t=document.createElementNS("http://www.w3.org/1999/xhtml",e)}catch(n){}return t||document.createElement(e)},gadgets.util.createIframeElement=function(e){var t=gadgets.util.createElement("iframe");try{var n,i,r=["<","iframe"],a=e||{};for(i in a)a.hasOwnProperty(i)&&(r.push(" "),r.push(i),r.push('="'),r.push(gadgets.util.escapeString(a[i])),r.push('"'));r.push("></"),r.push("iframe"),r.push(">"),n=r.join("");var s=gadgets.util.createElement(n);s&&(!t||s.tagName==t.tagName&&s.namespaceURI==t.namespaceURI)&&(t=s)}catch(o){}n=t,e=e||{};for(var d in e)e.hasOwnProperty(d)&&(n[d]=e[d]);return t},gadgets.util.getBodyElement=function(){if(document.body)return document.body;try{var e=document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","body");if(e&&1==e.length)return e[0]}catch(t){}return document.documentElement||document}}(),gadgets.util=gadgets.util||{},gadgets.util.attachBrowserEvent=function(e,t,n,i){"undefined"!=typeof e.addEventListener?e.addEventListener(t,n,i):"undefined"!=typeof e.attachEvent?e.attachEvent("on"+t,n):gadgets.warn("cannot attachBrowserEvent: "+t)},gadgets.util.removeBrowserEvent=function(e,t,n,i){e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent?e.detachEvent("on"+t,n):gadgets.warn("cannot removeBrowserEvent: "+t)},gadgets.util=gadgets.util||{},function(){var e=[];gadgets.util.registerOnLoadHandler=function(t){e.push(t)},gadgets.util.runOnLoadHandlers=function(){for(var t=0,n=e.length;n>t;++t)e[t]()}}(),gadgets.util=gadgets.util||{},function(){function e(e,t){return String.fromCharCode(t)}var t={0:!1,10:!0,13:!0,34:!0,39:!0,60:!0,62:!0,92:!0,8232:!0,8233:!0,65282:!0,65287:!0,65308:!0,65310:!0,65340:!0};gadgets.util.escape=function(e,t){if(!e)return e;if("string"==typeof e)return gadgets.util.escapeString(e);if("array"==typeof e)for(var n=0,i=e.length;i>n;++n)e[n]=gadgets.util.escape(e[n]);else if("object"===("undefined"==typeof e?"undefined":_typeof(e))&&t){n={};for(i in e)e.hasOwnProperty(i)&&(n[gadgets.util.escapeString(i)]=gadgets.util.escape(e[i],!0));return n}return e},gadgets.util.escapeString=function(e){if(!e)return e;for(var n,i,r=[],a=0,s=e.length;s>a;++a)n=e.charCodeAt(a),i=t[n],i===!0?r.push("&#",n,";"):i!==!1&&r.push(e.charAt(a));return r.join("")},gadgets.util.unescapeString=function(t){return t?t.replace(/&#([0-9]+);/g,e):t}}(),gadgets.util=gadgets.util||{},function(){var e=null;gadgets.util.getUrlParameters=function(t){var n="undefined"==typeof t;if(null!==e&&n)return e;var i={};t=t||document.location.href;var r=t.indexOf("?"),a=t.indexOf("#");t=(-1===a?t.substr(r+1):[t.substr(r+1,a-r-1),"&",t.substr(a+1)].join("")).split("&"),r=window.decodeURIComponent?decodeURIComponent:unescape,a=0;for(var s=t.length;s>a;++a){var o=t[a].indexOf("=");if(-1!==o){var d=t[a].substring(0,o);o=t[a].substring(o+1),o=o.replace(/\+/g," ");try{i[d]=r(o)}catch(g){}}}return n&&(e=i),i}}(),gadgets.util.getUrlParameters(),gadgets.util=gadgets.util||{},function(){function e(e){t=e["core.util"]||{}}var t={},n={};gadgets.config&&gadgets.config.register("core.util",null,e),gadgets.util.getFeatureParameters=function(e){return"undefined"==typeof t[e]?null:t[e]},gadgets.util.hasFeature=function(e){return"undefined"!=typeof t[e]},gadgets.util.getServices=function(){return n}}(),window.JSON&&window.JSON.parse&&window.JSON.stringify&&(gadgets.json=function(){function e(e){return this[e]}var t=/___$/;return{parse:function(e){try{return window.JSON.parse(e)}catch(t){return!1}},stringify:function(n){function i(t){return r.call(this,t,e)}var r=window.JSON.stringify,a=Array.prototype.toJSON&&'"[{\\"x\\": 1}]"'===r([{x:1}])?i:r;try{return a(n,function(e,n){return t.test(e)?void 0:n})}catch(s){return null}}}}()),window.JSON&&window.JSON.parse&&window.JSON.stringify||(gadgets.json=function(){function a(e){return 10>e?"0"+e:e}function b(e){var t,n,i;switch(t=/[\"\\\x00-\x1f\x7f-\x9f]/g,"undefined"==typeof e?"undefined":_typeof(e)){case"string":return t.test(e)?'"'+e.replace(t,function(e){var t=c[e];return t?t:(t=e.charCodeAt(),"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16))})+'"':'"'+e+'"';case"number":return isFinite(e)?String(e):"null";case"boolean":case"null":return String(e);case"object":if(!e)return"null";if(t=[],"number"==typeof e.length&&!e.propertyIsEnumerable("length")){for(i=e.length,n=0;i>n;n+=1)t.push(b(e[n])||"null");return"["+t.join(",")+"]"}for(n in e)/___$/.test(n)||e.hasOwnProperty(n)&&"string"==typeof n&&(i=b(e[n]))&&t.push(b(n)+":"+i);return"{"+t.join(",")+"}"}return""}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",a(this.getUTCMonth()+1),"-",a(this.getUTCDate()),"T",a(this.getUTCHours()),":",a(this.getUTCMinutes()),":",a(this.getUTCSeconds()),"Z"].join("")};var c={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return{stringify:b,parse:function parse(d){return/^[\],:{}\s]*$/.test(d.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))?eval("("+d+")"):!1}}}()),gadgets.json.flatten=function(e){var t={};if(null===e||void 0===e)return t;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];null===i||void 0===i||(t[n]="string"==typeof i?i:gadgets.json.stringify(i))}return t},gadgets.log=function(){function e(e,t){n>e||!i||(2===e&&i.warn?i.warn(t):3===e&&i.error?i.error(t):i.log&&i.log(t))}var t=function(t){e(1,t)};gadgets.warn=function(t){e(2,t)},gadgets.error=function(t){e(3,t)},gadgets.setLogLevel=function(e){n=e},t.INFO=1,t.WARNING=2,t.NONE=4;var n=1,i=window.console?window.console:window.opera?window.opera.postError:void 0;return t}(),window.gadgets.config||(gadgets.config=function(){function e(t,n){for(var i in n)n.hasOwnProperty(i)&&("object"===_typeof(t[i])&&"object"===_typeof(n[i])?e(t[i],n[i]):t[i]=n[i])}function t(){var e=document.scripts||document.getElementsByTagName("script");if(!e||0==e.length)return null;var t;if(a.u)for(var n=0;!t&&n<e.length;++n){var i=e[n];i.src&&0==i.src.indexOf(a.u)&&(t=i)}return t||(t=e[e.length-1]),t.src?t:null}function n(e){var t="";if(3==e.nodeType||4==e.nodeType)t=e.nodeValue;else if(e.innerText)t=e.innerText;else if(e.innerHTML)t=e.innerHTML;else if(e.firstChild){for(t=[],e=e.firstChild;e;e=e.nextSibling)t.push(n(e));t=t.join("")}return t}function i(i){var r=t();if(r){var s;r=n(r);try{s=new Function("return ("+r+"\n)")()}catch(o){}if("object"===("undefined"==typeof s?"undefined":_typeof(s)))s=s;else{try{s=new Function("return ({"+r+"\n})")()}catch(d){}s="object"===("undefined"==typeof s?"undefined":_typeof(s))?s:{}}a.f&&1==a.f.length&&(s[a.f[0]]||(r={},r[a.f[0]]=s,s=r)),e(i,s),(s=window.___cfg)&&e(i,s)}}function r(e){for(var t in s)if(s.hasOwnProperty(t))for(var n=s[t],i=0,r=n.length;r>i;++i)e(t,n[i])}var a,s={},o={};return{register:function(e,t,n,i){var r=s[e];r||(r=[],s[e]=r),r.push({validators:t||{},callback:n,callOnUpdate:i})},get:function(e){return e?o[e]||{}:o},init:function(t,n){a=window.___jsl||{},e(o,t),i(o),e(o,window.___config||{}),r(function(e,t){var i=o[e];if(i&&!n){var r,a=t.validators;for(r in a)if(a.hasOwnProperty(r)&&!a[r](i[r]))throw Error('Invalid config value "'+i[r]+'" for parameter "'+r+'" in component "'+e+'"')}t.callback&&t.callback(o)})},update:function(t,n){var i=[];r(function(e,r){(t.hasOwnProperty(e)||n&&o&&o[e])&&r.callback&&r.callOnUpdate&&i.push(r.callback)}),o=n?{}:o||{},e(o,t);for(var a=0,s=i.length;s>a;++a)i[a](o)}}}()),gadgets.io=function(){function a(){var e;if("undefined"!=typeof shindig&&shindig.xhrwrapper&&shindig.xhrwrapper.createXHR)return shindig.xhrwrapper.createXHR();if("undefined"!=typeof ActiveXObject)return(e=new ActiveXObject("Msxml2.XMLHTTP"))||(e=new ActiveXObject("Microsoft.XMLHTTP")),e;if("undefined"!=typeof XMLHttpRequest||window.XMLHttpRequest)return new window.XMLHttpRequest;throw"no xhr available"}function b(e,t){if(4!==e.readyState)return!0;try{if(200!==e.status){var n=""+e.status;return e.responseText&&(n=n+" "+e.responseText),t({errors:[n],rc:e.status,text:e.responseText}),!0}}catch(i){return t({errors:[i.number+" Error not specified"],rc:i.number,text:i.description}),!0}return!1}function c(t,n,i,r){b(r,n)||n(e(i,{body:r.responseText}))}function d(j,m,l,o){if(!b(o,m)){o=o.responseText;var r=o.indexOf(k)+k.length;r<k.length||(o=o.substr(r),o=eval("("+o+")"),o=o[j],o.oauthState&&(h=o.oauthState),o.st&&shindig.auth.updateSecurityToken(o.st),m(e(l,o)))}}function e(e,t){var n={text:t.body,rc:t.rc||200,headers:t.headers,oauthApprovalUrl:t.oauthApprovalUrl,oauthError:t.oauthError,oauthErrorText:t.oauthErrorText,oauthErrorTrace:t.oauthErrorTrace,oauthErrorUri:t.oauthErrorUri,oauthErrorExplanation:t.oauthErrorExplanation,errors:[]};if(n.rc<200||n.rc>=400)n.errors=[n.rc+" Error"];else if(n.text)switch(n.rc>=300&&n.rc<400&&(e.CONTENT_TYPE="TEXT"),e.CONTENT_TYPE){case"JSON":case"FEED":n.data=gadgets.json.parse(n.text),n.data||(n.errors.push("500 Failed to parse JSON"),n.rc=500,n.data=null);break;case"DOM":var i;"undefined"!=typeof ActiveXObject?(i=new ActiveXObject("Microsoft.XMLDOM"),i.async=!1,i.validateOnParse=!1,i.resolveExternals=!1,i.loadXML(n.text)?n.data=i:(n.errors.push("500 Failed to parse XML"),n.rc=500)):(i=(new DOMParser).parseFromString(n.text,"text/xml"),"parsererror"===i.documentElement.nodeName?(n.errors.push("500 Failed to parse XML"),n.rc=500):n.data=i);break;default:n.data=n.text}return n}function f(e,t,n,i,r,s,o,d){var g=a();if(0==t.indexOf("//")&&(t=document.location.protocol+t),g.open(r,t,!0),n&&(g.onreadystatechange=gadgets.util.makeClosure(null,o,e,n,s,g)),null!==i){e="application/x-www-form-urlencoded","string"==typeof d&&(e=d,d={}),d=d||{},d["Content-Type"]||(d["Content-Type"]=e);for(var u in d)g.setRequestHeader(u,d[u])}g.send(i)}var i={},h,k="throw 1; < don't be evil' >";return gadgets.config.register("core.io",null,function(e){i=e["core.io"]||{}}),{makeRequest:function(t,n,r){r=r||{};var a,s,o=r.METHOD||"GET",g=r.REFRESH_INTERVAL;r.AUTHORIZATION&&"NONE"!==r.AUTHORIZATION?(a=r.AUTHORIZATION.toLowerCase(),s=shindig.auth.getSecurityToken()):"GET"===o&&void 0===g&&(g=3600);var u=!0;"undefined"!=typeof r.OWNER_SIGNED&&(u=r.OWNER_SIGNED);var c=!0;"undefined"!=typeof r.VIEWER_SIGNED&&(c=r.VIEWER_SIGNED);var p=r.HEADERS||{};"POST"!==o||p["Content-Type"]||(p["Content-Type"]="application/x-www-form-urlencoded");var l=gadgets.util.getUrlParameters();if(s={url:t,httpMethod:o,headers:gadgets.io.encodeValues(p,!1),postData:r.POST_DATA||"",authz:a||"",st:s||"",contentType:r.CONTENT_TYPE||"TEXT",numEntries:r.NUM_ENTRIES||"3",getSummaries:!!r.GET_SUMMARIES,signOwner:u,signViewer:c,gadget:l.url,container:l.container||l.synd||"default",bypassSpecCache:gadgets.util.getUrlParameters().nocache||"",getFullHeaders:!!r.GET_FULL_HEADERS},"oauth"===a||"signed"===a||"oauth2"===a){gadgets.io.oauthReceivedCallbackUrl_&&(s.OAUTH_RECEIVED_CALLBACK=gadgets.io.oauthReceivedCallbackUrl_,gadgets.io.oauthReceivedCallbackUrl_=null),s.oauthState=h||"";for(var m in r)r.hasOwnProperty(m)&&(0===m.indexOf("OAUTH_")||"code"===m)&&(s[m]=r[m])}a=i.jsonProxyUrl.replace("%host%",document.location.host);e:{if(gadgets.io.preloaded_&&"GET"===s.httpMethod)for(m=0;m<gadgets.io.preloaded_.length;m++)if((u=gadgets.io.preloaded_[m])&&u.id===s.url){delete gadgets.io.preloaded_[m],200!==u.rc?n({rc:u.rc,errors:[u.rc+" Error"]}):(u.oauthState&&(h=u.oauthState),n(e(r,{body:u.body,rc:u.rc,headers:u.headers,oauthApprovalUrl:u.oauthApprovalUrl,oauthError:u.oauthError,oauthErrorText:u.oauthErrorText,oauthErrorTrace:u.oauthErrorTrace,oauthErrorUri:u.oauthErrorUri,oauthErrorExplanation:u.oauthErrorExplanation,errors:[]}))),m=!0;break e}m=!1}m||("GET"===o&&g>0?(o="?refresh="+g+"&"+gadgets.io.encodeValues(s),f(t,a+o,n,null,"GET",r,d)):f(t,a,n,gadgets.io.encodeValues(s),"POST",r,d))},makeNonProxiedRequest:function(e,t,n,i){n=n||{},f(e,e,t,n.POST_DATA,n.METHOD,n,c,i)},clearOAuthState:function(){h=void 0},encodeValues:function(e,t){var n,i=!t,r=[],a=!1;for(n in e)e.hasOwnProperty(n)&&!/___$/.test(n)&&(a?r.push("&"):a=!0,r.push(i?encodeURIComponent(n):n),r.push("="),r.push(i?encodeURIComponent(e[n]):e[n]));return r.join("")},getProxyUrl:function(e,t){var n=i.proxyUrl;if(!n)return n;var r=t||{},a=r.REFRESH_INTERVAL;void 0===a&&(a="3600");var s=gadgets.util.getUrlParameters();return r=r.rewriteMime?"&rewriteMime="+encodeURIComponent(r.rewriteMime):"",n=n.replace("%url%",encodeURIComponent(e)).replace("%host%",document.location.host).replace("%rawurl%",e).replace("%refresh%",encodeURIComponent(a)).replace("%gadget%",encodeURIComponent(s.url)).replace("%container%",encodeURIComponent(s.container||s.synd||"default")).replace("%rewriteMime%",r),0==n.indexOf("//")&&(n=window.location.protocol+n),n}}}(),gadgets.io.RequestParameters=gadgets.util.makeEnum(["METHOD","CONTENT_TYPE","POST_DATA","HEADERS","AUTHORIZATION","NUM_ENTRIES","GET_SUMMARIES","GET_FULL_HEADERS","REFRESH_INTERVAL","OAUTH_SERVICE_NAME","OAUTH_USE_TOKEN","OAUTH_TOKEN_NAME","OAUTH_REQUEST_TOKEN","OAUTH_REQUEST_TOKEN_SECRET","OAUTH_RECEIVED_CALLBACK"]),gadgets.io.MethodType=gadgets.util.makeEnum(["GET","POST","PUT","DELETE","HEAD"]),gadgets.io.ContentType=gadgets.util.makeEnum(["TEXT","DOM","JSON","FEED"]),gadgets.io.AuthorizationType=gadgets.util.makeEnum(["NONE","SIGNED","OAUTH","OAUTH2"]),gadgets.rpctx=gadgets.rpctx||{},gadgets.rpctx.wpm||(gadgets.rpctx.wpm=function(){function e(e,t,n){"undefined"!=typeof window.addEventListener?window.addEventListener(e,t,n):"undefined"!=typeof window.attachEvent&&window.attachEvent("on"+e,t)}function t(e){var t=gadgets.json.parse(e.data);if(t&&t.f){var i=gadgets.rpc.getTargetOrigin(t.f);r&&("undefined"!=typeof e.origin?e.origin!==i:e.domain!==/^.+:\/\/([^:]+).*/.exec(i)[1])||n(t,e.origin)}}var n,i,r=!0;return{getCode:function(){return"wpm"},isParentVerifiable:function(){return!0},init:function(a,s){return gadgets.config.register("rpc",null,function(e){"true"===String((e?e.rpc:{}).disableForceSecure)&&(r=!1)}),n=a,i=s,e("message",t,!1),i("..",!0),!0},setup:function(e){return i(e,!0),!0},call:function(e,t,n){var i=gadgets.rpc.getTargetOrigin(e),r=gadgets.rpc._getTargetWin(e);return i?window.setTimeout(function(){r.postMessage(gadgets.json.stringify(n),i)},0):gadgets.error("No relay set (used as window.postMessage targetOrigin), cannot send cross-domain message"),!0}}}()),gadgets.rpctx=gadgets.rpctx||{},gadgets.rpctx.nix||(gadgets.rpctx.nix=function(){function e(){var o=a[".."];if(!o)if(++s>i)gadgets.warn("Nix transport setup failed, falling back..."),t("..",!1);else{if(!o&&window.opener&&"GetAuthToken"in window.opener&&(o=window.opener,o.GetAuthToken()==gadgets.rpc.getAuthToken(".."))){var d=gadgets.rpc.getAuthToken("..");return o.CreateChannel(window[n]("..",d),d),a[".."]=o,window.opener=null,void t("..",!0)}window.setTimeout(function(){e()},r)}}var t,n="GRPC____NIXVBS_get_wrapper",i=10,r=500,a={},s=0;return{getCode:function(){return"nix"},isParentVerifiable:function(){return!1},init:function(e,i){if(t=i,"unknown"!=typeof window[n]){window.GRPC____NIXVBS_handle_message=function(t){window.setTimeout(function(){e(gadgets.json.parse(t))},0)},window.GRPC____NIXVBS_create_channel=function(e,n,i){gadgets.rpc.getAuthToken(e)===i&&(a[e]=n,t(e,!0))};var r="Class GRPC____NIXVBS_wrapper\n Private m_Intended\nPrivate m_Auth\nPublic Sub SetIntendedName(name)\n If isEmpty(m_Intended) Then\nm_Intended = name\nEnd If\nEnd Sub\nPublic Sub SetAuth(auth)\n If isEmpty(m_Auth) Then\nm_Auth = auth\nEnd If\nEnd Sub\nPublic Sub SendMessage(data)\n GRPC____NIXVBS_handle_message(data)\nEnd Sub\nPublic Function GetAuthToken()\n GetAuthToken = m_Auth\nEnd Function\nPublic Sub CreateChannel(channel, auth)\n Call GRPC____NIXVBS_create_channel(m_Intended, channel, auth)\nEnd Sub\nEnd Class\nFunction "+n+"(name, auth)\nDim wrap\nSet wrap = New GRPC____NIXVBS_wrapper\nwrap.SetIntendedName name\nwrap.SetAuth auth\nSet "+n+" = wrap\nEnd Function";try{window.execScript(r,"vbscript")}catch(s){return!1}}return!0},setup:function(t,i){if(".."===t)return e(),!0;try{var r=document.getElementById(t),a=window[n](t,i);r.contentWindow.opener=a}catch(s){return!1}return!0},call:function(e,t,n){try{a[e]&&a[e].SendMessage(gadgets.json.stringify(n))}catch(i){return!1}return!0}}}()),window.gadgets.rpc||(gadgets.rpc=function(){function e(e,t){if(!C[e]){var n=x;t||(n=D),C[e]=n;for(var i=S[e]||[],r=0;r<i.length;++r){var a=i[r];a.t=v[e],n.call(e,a.f,a)}S[e]=[]}}function t(){function e(){k=!0}j||("undefined"!=typeof window.addEventListener?window.addEventListener("unload",e,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onunload",e),j=!0)}function n(e,n,i,r,a){v[n]&&v[n]===i||(gadgets.error("Invalid auth token. "+v[n]+" vs "+i),N(n,M)),a.onunload=function(){w[n]&&!k&&(N(n,L),gadgets.rpc.removeReceiver(n))},t(),r=gadgets.json.parse(decodeURIComponent(r))}function i(t,n){if(t&&"string"==typeof t.s&&"string"==typeof t.f&&t.a instanceof Array)if(v[t.f]&&v[t.f]!==t.t&&(gadgets.error("Invalid auth token. "+v[t.f]+" vs "+t.t),N(t.f,M)),"__ack"===t.s)window.setTimeout(function(){e(t.f,!0)},0);else{if(t.c&&(t.callback=function(e){gadgets.rpc.call(t.f,"__cb",null,t.c,e)}),n){var i=r(n);t.origin=n;var a=t.r;a&&r(a)==i||(a=n),t[f]=a}i=(m[t.s]||m[""]).apply(t,t.a),t.c&&"undefined"!=typeof i&&gadgets.rpc.call(t.f,"__cb",null,t.c,i)}}function r(e){if(!e)return"";e=e.toLowerCase(),0==e.indexOf("//")&&(e=window.location.protocol+e),-1==e.indexOf("://")&&(e=window.location.protocol+"//"+e);var t=e.substring(e.indexOf("://")+3),n=t.indexOf("/");-1!=n&&(t=t.substring(0,n)),e=e.substring(0,e.indexOf("://")),n="";var i=t.indexOf(":");if(-1!=i){var r=t.substring(i+1);t=t.substring(0,i),("http"===e&&"80"!==r||"https"===e&&"443"!==r)&&(n=":"+r)}return e+"://"+t+n}function a(e){if("/"==e.charAt(0)){var t=e.indexOf("|"),n=t>0?e.substring(1,t):e.substring(1);return e=t>0?e.substring(t+1):null,{id:n,origin:e}}return null}function s(e){if("undefined"==typeof e||".."===e)return window.parent;var t=a(e);return t?window.top.frames[t.id]:(e=String(e),(t=window.frames[e])?t:(t=document.getElementById(e))&&t.contentWindow?t.contentWindow:null)}function o(e,t){if(w[e]!==!0){"undefined"==typeof w[e]&&(w[e]=0);var n=s(e);if((".."===e||null!=n)&&x.setup(e,t)===!0)return void(w[e]=!0);w[e]!==!0&&w[e]++<10?window.setTimeout(function(){o(e,t)},500):(C[e]=D,w[e]=!0)}}function d(e){return(e=y[e])&&"/"===e.substring(0,1)&&(e="/"===e.substring(1,2)?document.location.protocol+e:document.location.protocol+"//"+document.location.host+e),e}function g(e,t,n){/http(s)?:\/\/.+/.test(t)||(0==t.indexOf("//")?t=window.location.protocol+t:"/"==t.charAt(0)?t=window.location.protocol+"//"+window.location.host+t:-1==t.indexOf("://")&&(t=window.location.protocol+"//"+t)),y[e]=t,"undefined"!=typeof n&&(_[e]=!!n)}function u(e,t){t=t||"",v[e]=String(t),o(e,t)}function c(e){e=(e.passReferrer||"").split(":",2),R=e[0]||"none",O=e[1]||"origin"}function p(t){"true"===String(t.useLegacyProtocol)&&(x=gadgets.rpctx.ifpc,x.init(i,e))}function l(e,t){function n(n){n=n?n.rpc:{},c(n);var i=n.parentRelayUrl||"";i=r(T.parent||t)+i,g("..",i,"true"===String(n.useLegacyProtocol)),p(n),u("..",e)}!T.parent&&t?n({}):gadgets.config.register("rpc",null,n)}function h(e,t,n){if(".."===e)l(n||T.rpctoken||T.ifpctok||"",t);else e:{var i=null;if("/"!=e.charAt(0)){if(!gadgets.util)break e;if(i=document.getElementById(e),!i)throw Error("Cannot set up gadgets.rpc receiver with ID: "+e+", element not found.")}i=i&&i.src,t=t||gadgets.rpc.getOrigin(i),g(e,t),t=gadgets.util.getUrlParameters(i),u(e,n||t.rpctoken)}}var f="referer",m={},y={},_={},v={},E=0,I={},w={},P={},T={},C={},S={},R=null,O=null,A=window.top!==window.self,b=window.name,N=function(){},L=1,M=2,G=window.console,U=G&&G.log&&function(e){G.log(e)}||function(){},D=function(){function e(e){return function(){U(e+": call ignored")}}return{getCode:function(){return"noop"},isParentVerifiable:function(){return!0},init:e("init"),setup:e("setup"),call:e("call")}}();gadgets.util&&(T=gadgets.util.getUrlParameters());var k=!1,j=!1,x=function(){return"flash"==T.rpctx?gadgets.rpctx.flash:"rmr"==T.rpctx?gadgets.rpctx.rmr:"function"==typeof window.postMessage?gadgets.rpctx.wpm:"object"===_typeof(window.postMessage)?gadgets.rpctx.wpm:window.ActiveXObject?gadgets.rpctx.flash?gadgets.rpctx.flash:gadgets.rpctx.nix:navigator.userAgent.indexOf("WebKit")>0?gadgets.rpctx.rmr:"Gecko"===navigator.product?gadgets.rpctx.frameElement:gadgets.rpctx.ifpc}();return m[""]=function(){U("Unknown RPC service: "+this.s)},m.__cb=function(e,t){var n=I[e];n&&(delete I[e],n.call(this,t))},{config:function(e){"function"==typeof e.securityCallback&&(N=e.securityCallback)},register:function(e,t){if("__cb"===e||"__ack"===e)throw Error("Cannot overwrite callback/ack service");if(""===e)throw Error("Cannot overwrite default service: use registerDefault");m[e]=t},unregister:function(e){if("__cb"===e||"__ack"===e)throw Error("Cannot delete callback/ack service");if(""===e)throw Error("Cannot delete default service: use unregisterDefault");delete m[e]},registerDefault:function(e){m[""]=e},unregisterDefault:function(){delete m[""]},forceParentVerifiable:function(){x.isParentVerifiable()||(x=gadgets.rpctx.ifpc)},call:function(e,t,n){e=e||"..";var i="..";".."===e?i=b:"/"==e.charAt(0)&&(i=gadgets.rpc.getOrigin(window.location.href),i="/"+b+(i?"|"+i:"")),++E,n&&(I[E]=n);var o,g={s:t,f:i,c:n?E:0,a:Array.prototype.slice.call(arguments,3),t:v[e],l:!!_[e]};e:if("bidir"===R||"c2p"===R&&".."===e||"p2c"===R&&".."!==e){o=window.location.href;var u="?";if("query"===O)u="#";else if("hash"===O){o=o;break e}u=o.lastIndexOf(u),u=-1===u?o.length:u,o=o.substring(0,u)}else o=null;if(o&&(g.r=o),".."===e||null!=a(e)||document.getElementById(e)){e:{if(o=e,"undefined"==typeof P[o]){if(P[o]=!1,u=d(o),r(u)!==r(window.location.href)){o=!1;break e}u=s(o);try{P[o]=u.gadgets.rpc.receiveSameDomain}catch(c){}}"function"==typeof P[o]?(P[o](g),o=!0):o=!1}o||(o=C[e],o||null===a(e)||(o=x),o?(_[e]&&(o=gadgets.rpctx.ifpc),o.call(e,i,g)===!1&&(C[e]=D,x.call(e,i,g))):S[e]?S[e].push(g):S[e]=[g])}},getRelayUrl:d,setRelayUrl:g,setAuthToken:u,setupReceiver:h,getAuthToken:function(e){return v[e]},removeReceiver:function(e){delete y[e],delete _[e],delete v[e],delete w[e],delete P[e],delete C[e]},getRelayChannel:function(){return x.getCode()},receive:function(e,t){e.length>4?x._receiveMessage(e,i):n.apply(null,e.concat(t))},receiveSameDomain:function(e){e.a=Array.prototype.slice.call(e.a),window.setTimeout(function(){i(e)},0)},getOrigin:r,getTargetOrigin:function(e){var t=null;return t=(t=d(e))?t:(t=a(e))?t.origin:".."==e?T.parent:document.getElementById(e).src,r(t)},init:function(){x.init(i,e)===!1&&(x=D),A?h(".."):gadgets.config.register("rpc",null,function(e){e=e.rpc||{},c(e),p(e)})},_getTargetWin:s,_parseSiblingId:a,ACK:"__ack",RPC_ID:b||"..",SEC_ERROR_LOAD_TIMEOUT:0,SEC_ERROR_FRAME_PHISH:L,SEC_ERROR_FORGED_MSG:M}}(),gadgets.rpc.init()),function(e){return e}(),gadgets.views=function(){function e(e){e||(e=window.event);var t;return e.target?t=e.target:e.srcElement&&(t=e.srcElement),3===t.nodeType&&(t=t.parentNode),"a"===t.nodeName.toLowerCase()&&(t=t.getAttribute("href"))&&"#"!==t[0]&&-1===t.indexOf("://")?(gadgets.views.requestNavigateTo(n,t),e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1,e.cancelBubble=!0,!1):!1}var t={},n=null,i={},r={};return gadgets.config.register("views",null,function(a){a=a.views||{};for(var s in a)if(a.hasOwnProperty(s)&&"rewriteLinks"!=s){var o=a[s],d=s.toUpperCase();if(t[d]=d,o){i[s]=new gadgets.views.View(s,o.isOnlyVisible),d=o.aliases||[];for(var g,u=0;g=d[u];++u)i[g]=new gadgets.views.View(s,o.isOnlyVisible)}}s=gadgets.util.getUrlParameters(),s["view-params"]&&(r=gadgets.json.parse(decodeURIComponent(s["view-params"]))||r,r.hasOwnProperty("app_id")&&delete r.app_id),n=i[s.view]||i["default"],a.rewriteLinks&&gadgets.util.attachBrowserEvent(document,"click",e,!1)}),{bind:function(e,t){function n(e,n){return t.hasOwnProperty(e)?t[e]:n}function i(e){if(!(s=e.match(u)))throw Error("Invalid variable : "+e)}function r(e,t,r){var a=e.split(",");for(e=0;e<a.length&&(i(a[e]),!r(t,n(s[1]),s[1]));++e);return t}if("string"!=typeof e)throw Error("Invalid urlTemplate");if("object"!==("undefined"==typeof t?"undefined":_typeof(t)))throw Error("Invalid environment");for(var a,s,o,d,g,u=/^([a-zA-Z0-9][a-zA-Z0-9_\.\-]*)(=([a-zA-Z0-9\-\._~]|(%[0-9a-fA-F]{2}))*)?$/,c=RegExp("\\{([^}]*)\\}","g"),p=/^-([a-zA-Z]+)\|([^|]*)\|(.+)$/,l=[],h=0;a=c.exec(e);)if(l.push(e.substring(h,a.index)),h=c.lastIndex,s=a[1].match(u))a=s[1],o=s[2]?s[2].substr(1):"",l.push(n(a,o));else{if(!(s=a[1].match(p)))throw Error("Invalid syntax : "+a[0]);switch(d=s[1],a=s[2],g=s[3],o=0,d){case"neg":o=1;case"opt":r(g,{flag:o},function(e,t){var n;if(n="undefined"!=typeof t){e:if("object"===("undefined"==typeof t?"undefined":_typeof(t))||"function"==typeof t){for(var i in t)if(t.hasOwnProperty(i)){n=!1;break e}n=!0}else n=!1;n=!n}return n?(e.flag=!e.flag,1):0}).flag&&l.push(a);break;case"join":l.push(r(g,[],function(e,t,n){if("string"==typeof t)e.push(n+"="+t);else if("object"===("undefined"==typeof t?"undefined":_typeof(t)))for(var i in t)t.hasOwnProperty(i)&&e.push(i+"="+t[i])}).join(a));break;case"list":i(g),d=n(s[1]),"object"===("undefined"==typeof d?"undefined":_typeof(d))&&"function"==typeof d.join&&l.push(d.join(a));break;case"prefix":o=1;case"suffix":i(g),d=n(s[1],s[2]&&s[2].substr(1)),"string"==typeof d?l.push(o?a+d:d+a):"object"===("undefined"==typeof d?"undefined":_typeof(d))&&"function"==typeof d.join&&l.push(o?a+d.join(a):d.join(a)+a);break;default:throw Error("Invalid operator : "+d)}}return l.push(e.substr(h)),l.join("")},requestNavigateTo:function(e,t,n){"string"!=typeof e&&(e=e.getName()),gadgets.rpc.call(null,"requestNavigateTo",null,e,t,n)},getCurrentView:function(){return n},getSupportedViews:function(){return i},getParams:function(){return r},ViewType:t}}(),gadgets.views.View=function(e,t){this.name_=e,this.isOnlyVisible_=!!t},gadgets.views.View.prototype.getName=function(){return this.name_},gadgets.views.View.prototype.getUrlTemplate=function(){return gadgets.config&&gadgets.config.views&&gadgets.config.views[this.name_]&&gadgets.config.views[this.name_].urlTemplate},gadgets.views.View.prototype.bind=function(e){return gadgets.views.bind(this.getUrlTemplate(),e)},gadgets.views.View.prototype.isOnlyVisibleGadget=function(){return this.isOnlyVisible_},LJAPP_IPPU=new Class(IPPU,{init:function(e){e||(e=""),LJAPP_IPPU.superClass.init.apply(this,[]),this.uniqId=this.generateUniqId(),this.setTitle(e),this.setTitlebar(!0),this.setTitlebarClass("lj_ippu_titlebar"),this.addClass("lj_ippu lj_ippu_app"),this.setAutoCenterCallback(IPPU.center),this.setDimensions(514,"auto"),this.setFixedPosition(!0),this.setOverlayVisible(!1),this.setModal(!0)},setTitle:function(e){LJAPP_IPPU.superClass.setTitle.apply(this,["<div class='ljappippu_button' id='"+this.uniqId+"_cancel'></div>"+e]),this.setup_lj_ippu()},updateTitlebar:function(){this.showTitlebar&&this.titlebar&&this.title!=this.titlebar.innerHTML&&(this.titlebar.innerHTML=this.title,this.setup_lj_ippu())},generateUniqId:function(){var e=new Date;return"lj_ippu_"+e.getHours()+e.getMinutes()+e.getMilliseconds()},show:function(){LJAPP_IPPU.superClass.show.apply(this)},setup_lj_ippu:function(){var e=this.cancel.bind(this);jQuery(this.ele).find("#"+this.uniqId+"_cancel").click(e)},hide:function(){clearInterval(this.timerSetup),LJAPP_IPPU.superClass.hide.apply(this)}}),LJAppWidget=new Class(Object,{init:function(e,t){var n=e.title,i=e.authToken;this.templateID=e.templateID||"",this.finishCallback=e.finishCallback||null,this.widgetName=e.widgetName||"LJAppwidget",t||(t={}),this.reqParams=t;var r=new LJAPP_IPPU(n);this.ippu=r,this.widgetId="LJAppWidget_"+Unique.id();var a=document.createElement("div");a.id=this.widgetId,this.widgetNode=a,r.setContentElement(a),r.setModal(!0),r.setOverlayVisible(!0),r.setClickToClose(!1),r.setDimensions("60%","auto"),r.setAutoCenter(!0,!0);var s=this;return this.ippu.setCancelledCallback(function(){s.cancel()}),this.cancelOnEscape(),e.center&&r.center(),this.authToken=i,this.title=n,this.loaded=!1,this},getWidget:function(){return this.widgetNode},loadContent:function(e){var t=this;e=e||"request",this.makeRequest(e,function(e){t.contentLoaded(e)})},submitData:function(e,t){var n=this;e=e||"set",t=t||null,this.makeRequest(e,function(e){n.onData(e)},t)},makeRequest:function(e,t,n){n||(n=this.reqParams),n=jQuery.extend({},n),n.auth_token=this.authToken,n.action=e,url="/__rpc_ljapp_"+this.widgetName;var i=this;jQuery.post(url,n,function(e){"ERROR"===e.status?i.onError(e):t(e)},"json")},cancelOnEscape:function(){var e=this;jQuery(window).add(document).keydown(function(t){27===t.keyCode&&e.ippu.visible()&&e.cancel()})},cancel:function(){this.onError({code:"canceled"}),this.close()},onData:function(e){this.onReturn("OK",e)},onError:function(e){this.onReturn("ERROR",e)},onReturn:function(e,t,n){n=n||!1,t=t||{},t.status=e,this.finishCallback&&this.finishCallback(t),n&&this.close()},contentLoaded:function(e){e=e||{},e.messages=e.messages||{},"auth_token"in e&&(this.authToken=e.auth_token);var t=jQuery.tmpl(jQuery("#"+this.templateID),e);jQuery(this.getWidget()).empty().append(t),this.loaded=!0,this.ippu.center(),"title"in e.messages&&this.ippu.setTitle(e.messages.title),this.bindControls(),this.ippu.show(),this.verifyFocus()},verifyFocus:function(){jQuery("<input>").css({position:"fixed",left:"-30000em",top:"0em"}).appendTo(jQuery(document.body)).focus().remove()},bindControls:function(){},close:function(){this.ippu.hide()}}),LJAppWidget_RequestPermission=new Class(LJAppWidget,{init:function(e){e.templateID="ljappippu_confirm",e.widgetName="permissions",LJAppWidget_RequestPermission.superClass.init.apply(this,arguments)},bindControls:function(){var e=jQuery(this.getWidget()),t=this;e.find("input.ljappippu_confirm_ok").click(function(){t.submitData()}),e.find("input.ljappippu_confirm_reject").click(function(){t.cancel()}),LJAppWidget_RequestPermission.superClass.bindControls.apply(this)},onData:function(e){this.onReturn("OK",e,!0)},contentLoaded:function(e){e=e||{},this.reqParams.permissions=e.permissions.join(","),LJAppWidget_RequestPermission.superClass.contentLoaded.call(this,e)}}),function(e){LJAppWidget_RequestShareApp=new Class(LJAppWidget,{init:function(e,t){e.templateID="ljappippu_share",e.widgetName="share_app",this.extra=t.extra,delete t.extra,LJAppWidget_RequestShareApp.superClass.init.apply(this,arguments),this.friends={},this.selectedCount=0,this.cachedData={}},initRecipientsList:function(t){var n=this,i=e(".ljappippu_share_selected").itemList({hoverClass:"ljappippu_share_selected_hover",onNewElement:function(e){return jQuery("#ljappippu_share_person").tmpl({username:e,hasCloseButton:!0})},onSelect:function(e){var r=e.data;i.itemList("remove",r).itemList("updateLast"),r in n.friends&&(n.selectedCount--,n.friends[r]=0,n.updateSendButton()),t&&t(r),e.preventDefault(),e.stopPropagation()}});this.selectedCount=0;for(var r in this.friends)this.friends[r].selected&&(i.itemList("add",r),this.selectedCount++);return i.itemList("updateLast"),this.updateSendButton(),i},setupFirstStage:function(e){var t=jQuery("#ljappippu_share_choose").tmpl(e),n=this.getWidget(),i=this;jQuery(n).find(".ljappippu_share_content").empty().append(t),n.className="firstStage",recipientsSelector.init({perPage:0,
friends:e.friends,onSelect:function(e){r.itemList("add",e.username).itemList("updateLast"),e.username in i.friends&&(i.friends[e.username].selected=1,i.selectedCount++,i.updateSendButton())}}),jQuery("#filter").placeholder().input(function(){recipientsSelector.filter(this.value)});var r=this.initRecipientsList(function(e){recipientsSelector.add(e)}),a=!1;jQuery("#ljappippu_share_message").keypress(function(e){a&&e.preventDefault();var t=this;setTimeout(function(){t.value.length>120&&(t.value=t.value.substring(0,120),a=!0,setTimeout(function(){a=!1},300))},0)}),jQuery(".ljappippu_share_send").click(function(e){i.sendInvitations(),e.preventDefault()});var s=jQuery("#ljappippu_share_message").labeledPlaceholder(),o=jQuery("#ljappippu_share_message").height()+"px";s.css({height:"1.5em"}).focus(function(){s.stop().animate({height:o},200)}).blur(function(){0===this.value.length&&s.stop().animate({height:"1.5em"},200)}),this.ippu.center()},updateSendButton:function(){jQuery(".ljappippu_share_send").attr("disabled",0===this.selectedCount)},setupSecondStage:function(){var e=jQuery("#ljappippu_share_invite").tmpl(),t=this.getWidget();jQuery(t).find(".ljappippu_share_content").empty().append(e),t.className="secondStage",this.ippu.center();var n=this;setTimeout(function(){n.close()},3e3)},sendInvitations:function(){var e,t=jQuery("#ljappippu_share_message").val()||"",n=[];for(e in this.friends)this.friends[e].selected&&n.push(this.friends[e].userid);t={message:t,recipients:n.join(",")},this.extra.length>0&&(t.extra=this.extra),this.submitData("send",jQuery.extend({},this.reqParams,t))},onData:function(e){this.setupSecondStage(),this.onReturn("OK",e,!1)},loadContent:function(){LJAppWidget_RequestShareApp.superClass.loadContent.call(this,"select")},contentLoaded:function(e){e=e||{},e.messages=e.messages||{},e.messages.title=e.messages.header,this.cachedData=e,LJAppWidget_RequestShareApp.superClass.contentLoaded.call(this,e),this.friends={};for(var t=0;t<e.friends.length;++t)this.friends[e.friends[t].display_name]=e.friends[t];e.messages.isEmptyList=0===e.friends.length,this.setupFirstStage(e)}})}(jQuery,window),function(e){LJAppWidget_RequestPayment=new Class(LJAppWidget,{init:function(e){e.templateID="ljappippu_payment",e.widgetName="payments",this.payment=e.payment,this.balance=0,this.paymentMade=!1,this.onSubmitPayment=e.onSubmitPayment||null,"stoken"in this.payment&&delete this.payment.stoken,LJAppWidget_RequestPayment.superClass.init.apply(this,arguments)},bindControls:function(){var t=this;jQuery(this.getWidget()).delegate(".ljappippu_payment_ok","click",function(){t.onSubmitPayment&&t.onSubmitPayment(+new Date);var n=e.extend({},t.reqParams,{payment:gadgets.json.stringify(t.payment)});t.submitData("pay",n)}).delegate(".ljappippu_payment_reject","click",function(){t.cancel()}).delegate(".ljappippu_payment_add","click",function(){var e=window.open(Site.siteroot+"/shop/tokens.bml");t.checkIfClosed(e)}),LJAppWidget_RequestPayment.superClass.bindControls.apply(this)},checkIfClosed:function(e){var t=this,n=!1;try{n=e.closed}catch(i){n=!0}n?this.refreshDialog():setTimeout(function(){t.checkIfClosed(e)},100)},refreshDialog:function(){this.loadContent("balance")},loadContent:function(e){this.isCorrectPayment()?(this.paymentMade=!1,LJAppWidget_RequestPayment.superClass.loadContent.call(this,e)):(gadgets.log("malformed payment"),this.onReturn("MALFORMED_REQUEST"))},contentLoaded:function(t){t=t||{},this.balance=parseInt(t.balance,10),e.extend(t,{balance:this.balance,payment:this.payment}),LJAppWidget_RequestPayment.superClass.contentLoaded.call(this,t)},onData:function(e){var t=jQuery("#ljappippu_payment_result").tmpl({hasErrors:"OK"!==e.responseCode,isDelivered:"delivered"===e.state}),n=this.getWidget();if(jQuery(n).find(".ljappippu_inner").empty().append(t),this.ippu.center(),this.paymentMade=!0,"OK"===e.responseCode){var i=this;setTimeout(function(){i.close()},3e3)}this.onReturn("OK",e,!1)},isCorrectPayment:function(){if(!("amount"in this.payment))return!1;for(var e=this.payment.amount,t=0;t<this.payment.items.length;++t)e-=this.payment.items[t].count*this.payment.items[t].price;return 0===Math.floor(e)},cancel:function(){this.paymentMade||this.onReturn("USER_CANCELLED",null,!0)}})}(jQuery,window),function(){LJAppWidget_RequestPaymentRecords=new Class(LJAppWidget,{init:function(e){e.templateID="ljappippu_payment_records",e.widgetName="payments",LJAppWidget_RequestPaymentRecords.superClass.init.apply(this,arguments)},contentLoaded:function(e){if(e.payments)for(var t=0;t<e.payments.length;++t)e.payments[t].orderedTimeStr=new Date(e.payments[t].orderedTime).toLocaleString();LJAppWidget_RequestPaymentRecords.superClass.contentLoaded.apply(this,arguments)}})}(jQuery,window),LJAppWidget_RequestCreatePost=new Class(LJAppWidget,{init:function(e,t){e.templateID="ljappippu_post_event",e.widgetName="post_event",this.post=this._parsePost(e.post);var n=this.post.journal;n&&(t.journal=n),LJAppWidget_RequestCreatePost.superClass.init.apply(this,arguments)},bindControls:function(){var e=this;jQuery(this.getWidget()).find("input.ljappippu_createpost_ok").click(function(){var t=jQuery.extend({},e.reqParams,e.post);t.also_my_journal=jQuery(".ljappippu_event_alsoinmy").prop("checked")?"1":"0",e.submitData("post",t)}),LJAppWidget_RequestCreatePost.superClass.bindControls.apply(this)},onData:function(e){this.onReturn("OK",e,!0)},refreshDialog:function(){this.loadContent("preview")},contentLoaded:function(e){e=jQuery.extend({},e,this.post),LJAppWidget_RequestCreatePost.superClass.contentLoaded.call(this,e)},_parsePost:function(e){var t=e.tags;return t=t&&t.join(", ")||"",{journal:e.journal||"",subject:e.subject||"",event:e.body||"",taglist:t}}}),LJAppWidget_RequestCreateComment=new Class(LJAppWidget,{init:function(e,t){e.templateID="ljappippu_post_comment",e.widgetName="post_comment",this.comment=this._parseComment(e.comment),t=jQuery.extend({},t,this.comment),LJAppWidget_RequestCreateComment.superClass.init.apply(this,arguments)},bindControls:function(){var e=this;jQuery(this.getWidget()).find("input.ljappippu_createcomment_ok").click(function(){e.submitData("post")}),LJAppWidget_RequestCreateComment.superClass.bindControls.apply(this)},onData:function(e){this.onReturn("OK",e,!0)},refreshDialog:function(){this.loadContent("preview")},contentLoaded:function(e){e=jQuery.extend({},e,this.comment),LJAppWidget_RequestCreatePost.superClass.contentLoaded.call(this,e)},_parseComment:function(e){return{journal:e.journal||"",subject:e.subject||"",comment:e.body||"",ditemid:e.ditemid||"",dtalkid:e.dtalkid||""}}}),LJAppWidget_OpenGadget=new Class(LJAppWidget,{init:function(e){e.templateID="ljappippu_open_gadget",e.widgetName="open_gadget",LJAppWidget_OpenGadget.superClass.init.apply(this,arguments),this.dialogId=e.dialogId},onData:function(e){this.onReturn("OK",e,!0)},close:function(){LJAppWidget_OpenGadget.superClass.close.apply(this,arguments)},cancel:function(){shindig.container.gadgetService.close(this.dialogId)},contentLoaded:function(e){LJAppWidget_OpenGadget.superClass.contentLoaded.apply(this,arguments);var t=this._iframe=jQuery(e.element),n=jQuery(this.getWidget());this.frameId=t.prop("id"),n.append(t),this.setHeight(),shindig.container.createGadget(t,"popup",this),t=shindig.container.gadgetService.getGadgetIdFromModuleId(t.prop("id")),n=shindig.container.getGadget(t),n.dialog_id=this.dialogId,n.frame_id=t},setHeight:function(e){e&&e>=300?(e=e>=300?e:300,this._iframe.height(e),e=e):e=this._iframe.height();var t=100,n=this._iframe.width();jQuery(this.getWidget());var i=jQuery(window).height();t=100,e>i-t&&this._iframe.height(i-t),this.ippu.setDimensions(n,"auto"),this.ippu.center()},setWidth:function(){},setTitle:function(e){this.ippu.setTitle(e)},refreshDialog:function(){this.loadContent("preview")}});var opensocial=opensocial||{};opensocial.requestShareApp=function(e,t,n,i){opensocial.Container.get().requestShareApp(e,t,n,i)},opensocial.hasPermission=function(e){return opensocial.Container.get().hasPermission(e)},opensocial.requestPermission=function(e,t,n){opensocial.Container.get().requestPermission(e,t,n)},opensocial.EscapeType={HTML_ESCAPE:"htmlEscape",NONE:"none"},Function.prototype.inherits=function(e){function t(){}this.superClass_=t.prototype=e.prototype,this.prototype=new t,this.prototype.constructor=this},opensocial.Container=function(){},opensocial.Container.container_=null,opensocial.Container.setContainer=function(e){opensocial.Container.container_=e},opensocial.Container.get=function(){return opensocial.Container.container_},opensocial.Container.prototype.requestShareApp=function(e,t,n){n&&window.setTimeout(function(){n(new opensocial.ResponseItem(null,null,opensocial.ResponseItem.Error.NOT_IMPLEMENTED,null))},0)},opensocial.Container.prototype.hasPermission=function(){return!1},opensocial.Container.prototype.requestPermission=function(e,t,n){n&&window.setTimeout(function(){n(new opensocial.ResponseItem(null,null,opensocial.ResponseItem.Error.NOT_IMPLEMENTED,null))},0)},opensocial.Container.isArray=function(e){return e instanceof Array},opensocial.Container.getField=function(e,t,n){return opensocial.Container.escape(e[t],n,!1)},opensocial.Container.escape=function(e,t,n){return t&&t[opensocial.DataRequest.DataRequestFields.ESCAPE_TYPE]==opensocial.EscapeType.NONE?e:gadgets.util.escape(e,n)},opensocial.ResponseItem=function(e,t,n,i){this.originalDataRequest_=e,this.data_=t,this.errorCode_=n,this.errorMessage_=i},opensocial.ResponseItem.prototype.hadError=function(){return!!this.errorCode_},opensocial.ResponseItem.Error={NOT_IMPLEMENTED:"notImplemented",UNAUTHORIZED:"unauthorized",FORBIDDEN:"forbidden",BAD_REQUEST:"badRequest",INTERNAL_ERROR:"internalError",LIMIT_EXCEEDED:"limitExceeded",CANCELED:"canceled"},opensocial.ResponseItem.prototype.getErrorCode=function(){return this.errorCode_},opensocial.ResponseItem.prototype.getErrorMessage=function(){return this.errorMessage_},opensocial.ResponseItem.prototype.getOriginalDataRequest=function(){return this.originalDataRequest_},opensocial.ResponseItem.prototype.getData=function(){return this.data_},opensocial.BillingItem=function(e){this.fields_=e||{},this.fields_[opensocial.BillingItem.Field.COUNT]=this.fields_[opensocial.BillingItem.Field.COUNT]||1},opensocial.BillingItem.Field={SKU_ID:"skuId",PRICE:"price",COUNT:"count",DESCRIPTION:"description",IMAGE_URL:"imageUrl",IMAGE_WIDTH:"imageWidth",IMAGE_HEIGHT:"imageHeight"},opensocial.BillingItem.prototype.getField=function(e,t){return opensocial.Container.getField(this.fields_,e,t)},opensocial.BillingItem.prototype.setField=function(e,t){return this.fields_[e]=t},opensocial.Payment=function(e){this.fields_=e||{},this.fields_[opensocial.Payment.Field.PAYMENT_TYPE]=this.fields_[opensocial.Payment.Field.PAYMENT_TYPE]||opensocial.Payment.PaymentType.PAYMENT},opensocial.Payment.prototype.isPayment=function(){return this.fields_[opensocial.Payment.Field.PAYMENT_TYPE]==opensocial.Payment.PaymentType.PAYMENT},opensocial.Payment.prototype.isCredit=function(){return this.fields_[opensocial.Payment.Field.PAYMENT_TYPE]==opensocial.Payment.PaymentType.CREDIT},opensocial.Payment.prototype.isComplete=function(){return!!this.fields_[opensocial.Payment.Field.PAYMENT_COMPLETE]},opensocial.Payment.Field={SANDBOX:"sandbox",ITEMS:"items",AMOUNT:"amount",MESSAGE:"message",PARAMETERS:"parameters",PAYMENT_TYPE:"paymentType",ORDER_ID:"orderId",ORDERED_TIME:"orderedTime",SUBMITTED_TIME:"submittedTime",EXECUTED_TIME:"executedTime",RESPONSE_CODE:"responseCode",RESPONSE_MESSAGE:"responseMessage",PAYMENT_COMPLETE:"paymentComplete"},opensocial.Payment.prototype.getField=function(e,t){return opensocial.Container.getField(this.fields_,e,t)},opensocial.Payment.prototype.setField=function(e,t){return this.fields_[e]=t},opensocial.Payment.PaymentType={PAYMENT:"payment",CREDIT:"credit"},opensocial.Payment.ResponseCode={APP_LOGIC_ERROR:"appLogicError",APP_NETWORK_FAILURE:"appNetworkFailure",INSUFFICIENT_MONEY:"insufficientMoney",INVALID_TOKEN:"invalidToken",MALFORMED_REQUEST:"malformedRequest",NOT_IMPLEMENTED:"notImplemented",OK:"ok",PAYMENT_ERROR:"paymentError",PAYMENT_PROCESSOR_ALREADY_OPENED:"paymentProcessorAlreadyOpened",UNKNOWN_ERROR:"unknownError",USER_CANCELLED:"userCancelled"},opensocial.Payment.RecordsRequestFields={MAX:"max",IS_COMPLETE:"is_complete",START_TIME:"start_time",TYPE:"type"};var JsonPayment=function e(t,n){t=t||{},n||e.constructArrayObject(t,"items",JsonBillingItem),opensocial.Payment.call(this,t)};JsonPayment.inherits(opensocial.Payment),JsonPayment.prototype.toJsonObject=function(){for(var e=JsonPayment.copyFields(this.fields_),t=e.items||[],n=[],i=0;i<t.length;i++)n[i]=t[i].toJsonObject();return e.items=n,e};var JsonBillingItem=function(e){opensocial.BillingItem.call(this,e)};JsonBillingItem.inherits(opensocial.BillingItem),JsonBillingItem.prototype.toJsonObject=function(){return JsonPayment.copyFields(this.fields_)},JsonPayment.constructArrayObject=function(e,t,n){if(e=e[t])for(t=0;t<e.length;t++)e[t]=new n(e[t])},JsonPayment.copyFields=function(e){var t,n={};for(t in e)n[t]=e[t];return n},opensocial.requestPayment=function(e,t){opensocial.Container.get().requestPayment(e,t)},opensocial.requestPaymentRecords=function(e,t){opensocial.Container.get().requestPaymentRecords(e,t)},opensocial.newPayment=function(e){return opensocial.Container.get().newPayment(e)},opensocial.newBillingItem=function(e){return opensocial.Container.get().newBillingItem(e)},shindig=shindig||{},shindig.paymentprocessor=function(){function e(e){var t=null;return t={},t.frameId=e,t}function t(t,n){if(i&&(n.responseCode="PAYMENT_PROCESSOR_ALREADY_OPENED"),(!n.amount||n.amount<=0)&&(n.responseCode="MALFORMED_REQUEST"),a.paymentOpen||(n.responseCode="NOT_IMPLEMENTED"),r=e(this.f),"stoken"in n&&(r.stoken=n.stoken),null==r&&(n.responseCode="NOT_IMPLEMENTED"),n.responseCode&&"OK"!=n.responseCode)try{gadgets.rpc.call(this.f,"shindig.requestPayment_callback",null,t,n)}finally{return}i=!0,n.orderedTime=(new Date).getTime(),n.message=gadgets.util.escapeString(n.message),r.callbackId=t,r.payment=n,a.paymentOpen()}function n(t,n){var s={payments:{}};if(i&&(s.responseCode="PAYMENT_PROCESSOR_ALREADY_OPENED"),a.paymentRecordsOpen||(s.responseCode="NOT_IMPLEMENTED"),s.responseCode&&"OK"!=s.responseCode)try{gadgets.rpc.call(this.f,"shindig.requestPaymentRecords_callback",null,t,s)}finally{return}i=!0,r=e(this.f),r.callbackId=t,r.records=s,r.reqParams=n,a.paymentRecordsOpen()}var i=!1,r=null,a={};return{initPayment:function(e,n){a.paymentOpen=e,a.paymentClose=n,gadgets.rpc.register("shindig.requestPayment",t)},initPaymentRecords:function(e,t){a.paymentRecordsOpen=e,a.paymentRecordsClose=t,gadgets.rpc.register("shindig.requestPaymentRecords",n)},openPayment:t,closePayment:function(){if(i){a.paymentClose&&a.paymentClose();try{gadgets.rpc.call(r.frameId,"shindig.requestPayment_callback",null,r.callbackId,r.payment)}catch(e){}finally{i=!1,r=null}}},openPaymentRecords:n,closePaymentRecords:function(){if(i){a.paymentRecordsClose&&a.paymentRecordsClose();try{gadgets.rpc.call(r.frameId,"shindig.requestPaymentRecords_callback",null,r.callbackId,r.records)}finally{i=!1,r=null}}},getParam:function(e){if(!e)return null;var t=null;try{var n=e.split(".");if(n.length>0){e=r;for(var i=0;i<n.length;i++)e=e[n[i]];t=e}}catch(a){t=null}return t},setParam:function(e,t){if(e){var n=e.split(".");if(n.length>1){for(var i=r,a=0;a<n.length-1;a++)i=i[n[a]];i[n[n.length-1]]=t}}}}}();var paymentProcessor=function(){function e(){var e=r.getParam("frameId");return e=shindig.container.gadgetService.getGadgetIdFromModuleId(e),shindig.container.getGadget(e)}function t(){var t=r.getParam("payment.stoken"),i=e();r.setParam("payment.stoken",null),a=new LJAppWidget_RequestPayment({title:paymentProcessor.requestPaymentTitle,finishCallback:n,payment:r.getParam("payment"),onSubmitPayment:function(e){r.setParam("payment.submittedTime",e)},authToken:i.auth_token},{app_id:i.app_id,st:t}),a.loadContent("balance")}function n(e){var t=e.responseCode||e.status;r.setParam("payment.responseCode",t),r.setParam("payment.responseMessage",e.responseMessage),"OK"==t&&(r.setParam("payment.paymentComplete","delivered"===e.state),r.setParam("payment.executedTime",e.executedTime),r.setParam("payment.orderId",e.orderId),LiveJournal.run_hook("update_wallet_balance")),r.closePayment()}function i(){var t=r.getParam("reqParams.stoken"),n=e();r.setParam("reqParams.stoken",null),a=new LJAppWidget_RequestPaymentRecords({title:paymentProcessor.requestPaymentRecordsTitle,finishCallback:function(){r.closePaymentRecords()},authToken:n.auth_token},{app_id:n.app_id,st:t,payment:gadgets.json.stringify(r.getParam("reqParams.payment")),type:r.getParam("reqParams.type"),max:r.getParam("reqParams.max"),start_time:r.getParam("reqParams.start_time"),is_complete:r.getParam("reqParams.is_complete")}),a.loadContent("history")}var r,a;return{init:function(){r=shindig.paymentprocessor,r.initPayment(t),r.initPaymentRecords(i)}}}();if(paymentProcessor.init(),function(){osapi.newBatch=function(e){var t={},n=[],i=e||null,r=function(e){var t={method:e.request.method,id:e.key};return e.request.rpc&&(t.params=e.request.rpc),t};return t.execute=function(e){for(var t={},a={},s=0,o=[],d=0;d<n.length;d++){var g=n[d].request.transport;a[g.name]||(o.push(g),s++),a[g.name]=a[g.name]||[],a[g.name].push(r(n[d]))}for(d=function(i){i.error&&(t.error=i.error);for(var r=0;r<n.length;r++){var a=n[r].key,o=i[a];o&&(t[a]=o.error?o:o.data||o.result)}s--,0===s&&e(t)},g=0;g<o.length;g++)o[g].execute(a[o[g].name],d,i);0==s&&window.setTimeout(function(){e(t)},0)},t.add=function(e,i){return i&&e&&n.push({key:e,request:i}),t},t}}(),osapi._registerMethod=function(e,t){if("newBatch"!==e){for(var n=e.split("."),i=osapi,r=0;r<n.length-1;r++)i[n[r]]=i[n[r]]||{},i=i[n[r]];var a,s=n[n.length-1];i[s]&&(a=i[s]),i[s]=function(n,i,r){return n=n||{},n.userId=n.userId||"@viewer",n.groupId=n.groupId||"@self",osapi.container?(n=new osapi._BoundCall(e,t,n,r),void n.execute(i)):n=new osapi._BoundCall(e,t,n)},"undefined"!=typeof tamings___&&(n=function(){caja___.markTameAsFunction(i[s],e)},a&&a.__taming_index?(i[s].__taming_index=a.__taming_index,tamings___[a.__taming_index]=n):(i[s].__taming_index=tamings___.length,tamings___.push(n)))}},osapi._BoundCall=function(e,t,n,i){this.method=e,this.transport=t,this.rpc=n,this.token=i},osapi._BoundCall.prototype.execute=function(e){var t="undefined"!=typeof caja___&&caja___.getUseless&&caja___.getUseless(),n=t?caja___.getUseless():this,i=t?caja___.untame(e):e;e=osapi.newBatch(this.token),e.add(this.method,this),e.execute(function(e){e.error?i.call(n,e.error):i.call(n,e[n.method])})},function(){function e(e,t,i){e={POST_DATA:gadgets.json.stringify(e),CONTENT_TYPE:"JSON",METHOD:"POST",AUTHORIZATION:"SIGNED"};var r={"Content-Type":"application/json"},a=this.name;i&&(n?r.Authorization="OAuth2 "+i:(a+="?st=",a+=encodeURIComponent(i))),gadgets.io.makeNonProxiedRequest(a,function(e){if(e.errors[0])t({error:{code:e.rc,message:e.text}});else if(e=e.result||e.data,e.error)t(e);else{for(var n={},i=0;i<e.length;i++)n[e[i].id]=e[i];t(n)}},e,r)}function t(t){var i=t["osapi.services"];if(n=t["osapi.useOAuth2"],i)for(var r in i)if(i.hasOwnProperty(r)&&(0==r.indexOf("http")||0==r.indexOf("//"))){t={name:r.replace("%host%",document.location.host),execute:e};for(var a=i[r],s=0;s<a.length;s++)osapi._registerMethod(a[s],t)}}var n;gadgets.config&&gadgets.config.register("osapi.services",null,t)}(),shindig.errors={},shindig.errors.SUBCLASS_RESPONSIBILITY="subclass responsibility",shindig.errors.TO_BE_DONE="to be done",shindig.callAsyncAndJoin=function(e,t,n){for(var i=e.length,r=[],a=0;a<e.length;a++)!function(a){var s=e[a];"string"==typeof s&&(s=n[s]),s.call(n,function(e){r[a]=e,0===--i&&t(r)})}(a)},shindig.Extensible=function(){},shindig.Extensible.prototype.setDependencies=function(e){for(var t in e)this[t]=e[t]},shindig.Extensible.prototype.getDependencies=function(e){return this[e]},shindig.UserPrefStore=function(){},shindig.UserPrefStore.prototype.getPrefs=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.UserPrefStore.prototype.savePrefs=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.DefaultUserPrefStore=function(){shindig.UserPrefStore.call(this)},shindig.DefaultUserPrefStore.inherits(shindig.UserPrefStore),shindig.DefaultUserPrefStore.prototype.getPrefs=function(){},shindig.DefaultUserPrefStore.prototype.savePrefs=function(){},shindig.GadgetService=function(){},shindig.GadgetService.prototype.setHeight=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.GadgetService.prototype.setTitle=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.GadgetService.prototype.setUserPref=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.IfrGadgetService=function(){shindig.GadgetService.call(this),gadgets.rpc.register("resize_iframe",this.setHeight),gadgets.rpc.register("set_pref",this.setUserPref),gadgets.rpc.register("set_title",this.setTitle),gadgets.rpc.register("requestNavigateTo",this.requestNavigateTo),gadgets.rpc.register("requestSendMessage",this.requestSendMessage)},shindig.IfrGadgetService.inherits(shindig.GadgetService),shindig.IfrGadgetService.prototype.setHeight=function(e){e>shindig.container.maxheight_&&(e=shindig.container.maxheight_);var t=document.getElementById(this.f);t&&(t.style.height=e+"px")},shindig.IfrGadgetService.prototype.setTitle=function(e){var t=document.getElementById(this.f+"_title");t&&(t.innerHTML=e.replace(/&/g,"&amp;").replace(/</g,"&lt;"))},shindig.IfrGadgetService.prototype.setUserPref=function(){var e=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);e=shindig.container.getGadget(e);for(var t=1,n=arguments.length;n>t;t+=2)this.userPrefs[arguments[t]].value=arguments[t+1];e.saveUserPrefs()},shindig.IfrGadgetService.prototype.requestSendMessage=function(e,t,n){n&&window.setTimeout(function(){n(new opensocial.ResponseItem(null,null,opensocial.ResponseItem.Error.NOT_IMPLEMENTED,null))},0)},shindig.IfrGadgetService.prototype.requestNavigateTo=function(e,t){shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);var n=shindig.container.gadgetService.getUrlForView(e);if(t){var i=gadgets.json.stringify(t);i.length>0&&(n+="&appParams="+encodeURIComponent(i))}n&&-1==document.location.href.indexOf(n)&&(document.location.href=n)},shindig.IfrGadgetService.prototype.getUrlForView=function(e){return"canvas"===e?"/canvas":"profile"===e?"/profile":null},shindig.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(e){return parseInt(e.match(/_([0-9]+)$/)[1],10)},shindig.LayoutManager=function(){},shindig.LayoutManager.prototype.getGadgetChrome=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.StaticLayoutManager=function(){shindig.LayoutManager.call(this)},shindig.StaticLayoutManager.inherits(shindig.LayoutManager),shindig.StaticLayoutManager.prototype.setGadgetChromeIds=function(e){this.gadgetChromeIds_=e},shindig.StaticLayoutManager.prototype.getGadgetChrome=function(e){return(e=this.gadgetChromeIds_[e.id])?document.getElementById(e):null},shindig.FloatLeftLayoutManager=function(e){shindig.LayoutManager.call(this),this.layoutRootId_=e},shindig.FloatLeftLayoutManager.inherits(shindig.LayoutManager),shindig.FloatLeftLayoutManager.prototype.getGadgetChrome=function(){var e=document.getElementById(this.layoutRootId_);if(e){var t=document.createElement("div");return t.className="gadgets-gadget-chrome",t.style.cssFloat="left",e.appendChild(t),t}return null},shindig.Gadget=function(e){if(this.userPrefs={},e)for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.secureToken||(this.secureToken="john.doe:john.doe:appid:cont:url:0:default")},shindig.Gadget.prototype.setServerBase=function(e){this.serverBase_=e},shindig.Gadget.prototype.getServerBase=function(){return this.serverBase_},shindig.Gadget.prototype.getUserPrefs=function(){return this.userPrefs},shindig.Gadget.prototype.saveUserPrefs=function(){shindig.container.userPrefStore.savePrefs(this)},shindig.Gadget.prototype.getUserPrefValue=function(e){return e=this.userPrefs[e],"undefined"!=typeof e.value&&null!=e.value?e.value:e["default"]},shindig.Gadget.prototype.render=function(e){if(e){var t=this;this.getContent(function(n){e.innerHTML=n,t.finishRender(e)})}},shindig.Gadget.prototype.getContent=function(e){shindig.callAsyncAndJoin(["getTitleBarContent","getUserPrefsDialogContent","getMainContent"],function(t){e(t.join(""))},this)},shindig.Gadget.prototype.getTitleBarContent=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.Gadget.prototype.getUserPrefsDialogContent=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.Gadget.prototype.getMainContent=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.Gadget.prototype.finishRender=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.Gadget.prototype.getAdditionalParams=function(){return""},shindig.BaseIfrGadget=function(e){shindig.Gadget.call(this,e),this.serverBase_?this.serverBase_.indexOf("/gadgets")<0&&(this.serverBase_+="/gadgets/"):this.serverBase_="/gadgets/",this.queryIfrGadgetType_()},shindig.BaseIfrGadget.inherits(shindig.Gadget),shindig.BaseIfrGadget.prototype.GADGET_IFRAME_PREFIX_="remote_iframe_",shindig.BaseIfrGadget.prototype.CONTAINER="default",shindig.BaseIfrGadget.prototype.cssClassGadget="gadgets-gadget",shindig.BaseIfrGadget.prototype.cssClassTitleBar="gadgets-gadget-title-bar",shindig.BaseIfrGadget.prototype.cssClassTitle="gadgets-gadget-title",shindig.BaseIfrGadget.prototype.cssClassTitleButtonBar="gadgets-gadget-title-button-bar",shindig.BaseIfrGadget.prototype.cssClassGadgetUserPrefsDialog="gadgets-gadget-user-prefs-dialog",shindig.BaseIfrGadget.prototype.cssClassGadgetUserPrefsDialogActionBar="gadgets-gadget-user-prefs-dialog-action-bar",shindig.BaseIfrGadget.prototype.cssClassTitleButton="gadgets-gadget-title-button",shindig.BaseIfrGadget.prototype.cssClassGadgetContent="gadgets-gadget-content",shindig.BaseIfrGadget.prototype.rpcToken=2147483647*Math.random()|0,shindig.BaseIfrGadget.prototype.rpcRelay="../container/rpc_relay.html",shindig.BaseIfrGadget.prototype.getTitleBarContent=function(e){var t=this.hasViewablePrefs_()?'<a href="#" onclick="shindig.container.getGadget('+this.id+').handleOpenUserPrefsDialog();return false;" class="'+this.cssClassTitleButton+'">settings</a> ':"";e('<div id="'+this.cssClassTitleBar+"-"+this.id+'" class="'+this.cssClassTitleBar+'"><span id="'+this.getIframeId()+'_title" class="'+this.cssClassTitle+'">'+(this.title?this.title:"Title")+'</span> | <span class="'+this.cssClassTitleButtonBar+'">'+t+'<a href="#" onclick="shindig.container.getGadget('+this.id+').handleToggle();return false;" class="'+this.cssClassTitleButton+'">toggle</a></span></div>')},shindig.BaseIfrGadget.prototype.getUserPrefsDialogContent=function(e){e('<div id="'+this.getUserPrefsDialogId()+'" class="'+this.cssClassGadgetUserPrefsDialog+'"></div>')},shindig.BaseIfrGadget.prototype.getMainContent=function(e){var t=this;window.setTimeout(function(){t.getMainContent(e)},0)},shindig.BaseIfrGadget.prototype.getIframeId=function(){return this.GADGET_IFRAME_PREFIX_+this.id},shindig.BaseIfrGadget.prototype.getUserPrefsDialogId=function(){return this.getIframeId()+"_userPrefsDialog"},shindig.BaseIfrGadget.prototype.getUserPrefsParams=function(){var e,t="";for(e in this.getUserPrefs())t+="&up_"+encodeURIComponent(e)+"="+encodeURIComponent(this.getUserPrefValue(e));return t},shindig.BaseIfrGadget.prototype.handleToggle=function(){var e=document.getElementById(this.getIframeId());e&&(e=e.parentNode,e.style.display=e.style.display?"":"none")},shindig.BaseIfrGadget.prototype.hasViewablePrefs_=function(){for(var e in this.getUserPrefs())if("hidden"!=this.userPrefs[e].type)return!0;return!1},shindig.BaseIfrGadget.prototype.handleOpenUserPrefsDialog=function(){if(this.userPrefsDialogContentLoaded)this.showUserPrefsDialog();else{var e=this;window["ig_callback_"+this.id]=function(t){e.userPrefsDialogContentLoaded=!0,e.buildUserPrefsDialog(t),e.showUserPrefsDialog()};var t=document.createElement("script");t.src="http://www.gmodules.com/ig/gadgetsettings?mid="+this.id+"&output=js"+this.getUserPrefsParams()+"&url="+this.specUrl,document.body.appendChild(t)}},shindig.BaseIfrGadget.prototype.buildUserPrefsDialog=function(e){var t=document.getElementById(this.getUserPrefsDialogId());t.innerHTML=e+'<div class="'+this.cssClassGadgetUserPrefsDialogActionBar+'"><input type="button" value="Save" onclick="shindig.container.getGadget('+this.id+').handleSaveUserPrefs()"> <input type="button" value="Cancel" onclick="shindig.container.getGadget('+this.id+').handleCancelUserPrefs()"></div>',t.childNodes[0].style.display=""},shindig.BaseIfrGadget.prototype.showUserPrefsDialog=function(e){document.getElementById(this.getUserPrefsDialogId()).style.display=e||void 0===e?"":"none"},shindig.BaseIfrGadget.prototype.hideUserPrefsDialog=function(){this.showUserPrefsDialog(!1)},shindig.BaseIfrGadget.prototype.handleSaveUserPrefs=function(){this.hideUserPrefsDialog();for(var e=document.getElementById("m_"+this.id+"_numfields").value,t=0;e>t;t++){var n=document.getElementById("m_"+this.id+"_"+t);this.userPrefs[n.name.substring(("m_"+this.id+"_up_").length)].value=n.value}this.saveUserPrefs(),this.refresh()},shindig.BaseIfrGadget.prototype.handleCancelUserPrefs=function(){this.hideUserPrefsDialog()},shindig.BaseIfrGadget.prototype.refresh=function(){var e=this.getIframeId();document.getElementById(e).src=this.getIframeUrl(Math.random())},shindig.BaseIfrGadget.prototype.queryIfrGadgetType_=function(){var e={CONTENT_TYPE:"JSON",METHOD:"POST",POST_DATA:gadgets.json.stringify({context:{country:"default",language:"default",view:"default",container:"default"},gadgets:[{url:this.specUrl,moduleId:1}]})};gadgets.io.makeNonProxiedRequest(this.serverBase_+"metadata?st="+this.secureToken,function(e){var n=!1;e=e.data.gadgets[0].features;for(var i=0;i<e.length;i++)if("pubsub-2"===e[i]){n=!0;break}n=n?shindig.OAAIfrGadget:shindig.IfrGadget;for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])},e,{"Content-Type":"application/javascript"});var t=this},shindig.IfrGadget={getMainContent:function(e){var t=this.getIframeId();gadgets.rpc.setRelayUrl(t,this.serverBase_+this.rpcRelay),gadgets.rpc.setAuthToken(t,this.rpcToken),e('<div class="'+this.cssClassGadgetContent+'"><iframe id="'+t+'" name="'+t+'" class="'+this.cssClassGadget+'" src="about:blank" frameborder="no" scrolling="no"'+(this.height?' height="'+this.height+'"':"")+(this.width?' width="'+this.width+'"':"")+"></iframe></div>")},finishRender:function(){window.frames[this.getIframeId()].location=this.getIframeUrl()},getIframeUrl:function(e){return this.serverBase_+"ifr?container="+this.CONTAINER+"&mid="+this.id+"&nocache="+shindig.container.nocache_+"&country="+shindig.container.country_+"&lang="+shindig.container.language_+"&view="+shindig.container.view_+(this.specVersion?"&v="+this.specVersion:"")+(shindig.container.parentUrl_?"&parent="+encodeURIComponent(shindig.container.parentUrl_):"")+(this.debug?"&debug=1":"")+this.getAdditionalParams()+this.getUserPrefsParams()+(this.secureToken?"&st="+this.secureToken:"")+"&url="+encodeURIComponent(this.specUrl)+(this.viewParams?"&view-params="+encodeURIComponent(gadgets.json.stringify(this.viewParams)):"")+(e?"&r="+e:"")+"#rpctoken="+this.rpcToken+(this.hashData?"&"+this.hashData:"")}},shindig.OAAIfrGadget={getMainContent:function(e){e('<div id="'+this.cssClassGadgetContent+"-"+this.id+'" class="'+this.cssClassGadgetContent+'"></div>')},finishRender:function(){var e={className:this.cssClassGadget,frameborder:"no",scrolling:"no"};this.height&&(e.height=this.height),this.width&&(e.width=this.width),new OpenAjax.hub.IframeContainer(gadgets.pubsub2router.hub,this.getIframeId(),{Container:{onSecurityAlert:function(e,t){gadgets.error("Security error for container "+e.getClientID()+" : "+t),
e.getIframe().src="about:blank"}},IframeContainer:{parent:document.getElementById(this.cssClassGadgetContent+"-"+this.id),uri:this.getIframeUrl(),tunnelURI:shindig.uri(this.serverBase_+this.rpcRelay).resolve(shindig.uri(window.location.href)),iframeAttrs:e}})},getIframeUrl:function(e){return this.serverBase_+"ifr?container="+this.CONTAINER+"&mid="+this.id+"&nocache="+shindig.container.nocache_+"&country="+shindig.container.country_+"&lang="+shindig.container.language_+"&view="+shindig.container.view_+(this.specVersion?"&v="+this.specVersion:"")+(this.debug?"&debug=1":"")+this.getAdditionalParams()+this.getUserPrefsParams()+(this.secureToken?"&st="+this.secureToken:"")+"&url="+encodeURIComponent(this.specUrl)+(this.viewParams?"&view-params="+encodeURIComponent(gadgets.json.stringify(this.viewParams)):"")+(e?"&r="+e:"")+(this.hashData?"#"+this.hashData:"")}},shindig.Container=function(){this.gadgets_={},this.parentUrl_="http://"+document.location.host,this.language_=this.country_="ALL",this.view_="default",this.nocache_=1,this.maxheight_=2147483647},shindig.Container.inherits(shindig.Extensible),shindig.Container.prototype.gadgetClass=shindig.Gadget,shindig.Container.prototype.userPrefStore=new shindig.DefaultUserPrefStore,shindig.Container.prototype.gadgetService=new shindig.GadgetService,shindig.Container.prototype.layoutManager=new shindig.StaticLayoutManager,shindig.Container.prototype.setParentUrl=function(e){this.parentUrl_=e},shindig.Container.prototype.setCountry=function(e){this.country_=e},shindig.Container.prototype.setNoCache=function(e){this.nocache_=e},shindig.Container.prototype.setLanguage=function(e){this.language_=e},shindig.Container.prototype.setView=function(e){this.view_=e},shindig.Container.prototype.setMaxHeight=function(e){this.maxheight_=e},shindig.Container.prototype.getGadgetKey_=function(e){return"gadget_"+e},shindig.Container.prototype.getGadget=function(e){return this.gadgets_[this.getGadgetKey_(e)]},shindig.Container.prototype.createGadget=function(e){return new this.gadgetClass(e)},shindig.Container.prototype.addGadget=function(e){e.id=this.getNextGadgetInstanceId(),this.gadgets_[this.getGadgetKey_(e.id)]=e},shindig.Container.prototype.addGadgets=function(e){for(var t=0;t<e.length;t++)this.addGadget(e[t])},shindig.Container.prototype.renderGadgets=function(){for(var e in this.gadgets_)this.renderGadget(this.gadgets_[e])},shindig.Container.prototype.renderGadget=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.Container.prototype.nextGadgetInstanceId_=0,shindig.Container.prototype.getNextGadgetInstanceId=function(){return this.nextGadgetInstanceId_++},shindig.Container.prototype.refreshGadgets=function(){for(var e in this.gadgets_)this.gadgets_[e].refresh()},shindig.IfrContainer=function(){shindig.Container.call(this)},shindig.IfrContainer.inherits(shindig.Container),shindig.IfrContainer.prototype.gadgetClass=shindig.BaseIfrGadget,shindig.IfrContainer.prototype.gadgetService=new shindig.IfrGadgetService,shindig.IfrContainer.prototype.setParentUrl=function(e){e.match(/^http[s]?:\/\//)||(e=document.location.href.match(/^[^?#]+\//)[0]+e),this.parentUrl_=e},gadgets&&gadgets.rpc){osapi._handleGadgetRpcMethod=function(e,t){for(var n=Array(e.length),i=0,r=this.callback,a=function(e,t){t({})},s=0;s<e.length;s++){var o=osapi;if(-1==e[s].method.indexOf("_"))for(var d=e[s].method.split("."),g=0;g<d.length;g++){if(!o.hasOwnProperty(d[g])){o=a;break}o=o[d[g]]}else o=a;o(e[s].params,function(t){return function(a){n[t]={id:e[t].id,data:a},i++,i==e.length&&r(n)}}(s),t)}},osapi.container={},osapi.container.listMethods=function(e,t){var n=[];recurseNames(osapi,"",5,n),t(n)};var recurseNames=function t(e,n,i,r){if(0!=i)for(var a in e)if(e.hasOwnProperty(a)&&-1==a.indexOf("_")){var s=_typeof(e[a]);"function"==s?r.push(n+a):"object"==s&&t(e[a],n+a+".",i-1,r)}};gadgets.rpc.register("osapi._handleGadgetRpcMethod",osapi._handleGadgetRpcMethod)}!function(e){return e}(),osapi.container={},osapi.container.MetadataParam={LOCAL_EXPIRE_TIME:"localExpireTimeMs",URL:"url"},osapi.container.MetadataResponse={IFRAME_URL:"iframeUrl",NEEDS_TOKEN_REFRESH:"needsTokenRefresh",VIEWS:"views",EXPIRE_TIME_MS:"expireTimeMs",FEATURES:"features",HEIGHT:"height",MODULE_PREFS:"modulePrefs",PREFERRED_HEIGHT:"preferredHeight",PREFERRED_WIDTH:"preferredWidth",RESPONSE_TIME_MS:"responseTimeMs",WIDTH:"width"},osapi.container.TokenResponse={TOKEN:"token"},osapi.container.NavigateTiming={URL:"url",ID:"id",START:"start",XRT:"xrt",SRT:"srt",DL:"dl",OL:"ol",PRT:"prt"},osapi.container.RenderParam={ALLOW_DEFAULT_VIEW:"allowDefaultView",CAJOLE:"cajole",CLASS:"class",DEBUG:"debug",HEIGHT:"height",NO_CACHE:"nocache",TEST_MODE:"testmode",USER_PREFS:"userPrefs",VIEW:"view",WIDTH:"width"},osapi.container.ViewParam={VIEW:"view"},osapi.container.CallbackType={ON_PRELOADED:"onPreloaded",ON_NAVIGATED:"onNavigated",ON_CLOSED:"onClosed",ON_UNLOADED:"onUnloaded",ON_RENDER:"onRender"},osapi.container.util={},osapi.container.util.getSafeJsonValue=function(e,t,n){return void 0!=e[t]&&null!=e[t]?e[t]:n},osapi.container.util.mergeJsons=function(e,t){var n,i={};for(n in e)i[n]=e[n];for(n in t)i[n]=t[n];return i},osapi.container.util.newMetadataRequest=function(e){return osapi.container.util.isArray(e)||(e=[e]),{container:window.__CONTAINER,ids:e,fields:["iframeUrl","modulePrefs.*","needsTokenRefresh","userPrefs.*","views.preferredHeight","views.preferredWidth","expireTimeMs","responseTimeMs","rpcServiceIds"]}},osapi.container.util.newTokenRequest=function(e){return osapi.container.util.isArray(e)||(e=[e]),{container:window.__CONTAINER,ids:e,fields:["token"]}},osapi.container.util.toArrayOfJsonKeys=function(e){var t,n=[];for(t in e)n.push(t);return n},osapi.container.util.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)},osapi.container.util.isEmptyJson=function(e){for(var t in e)return!1;return!0},osapi.container.util.warn=function(e){console&&console.warn&&console.warn(e)},osapi.container.util.getCurrentTimeMs=function(){return(new Date).getTime()},osapi.container.util.createIframeHtml=function(e){var t=[];t.push("<iframe ");for(var n in e){var i=e[n];i&&(t.push(n),t.push('="'),t.push(i),t.push('" '))}return t.push("></iframe>"),t.join("")},osapi.container.Service=function(e){e=this.config_=e||{},this.registerOsapiServices(),this.onConstructed(e)},osapi.container.Service.prototype.onConstructed=function(){},osapi.container.Service.prototype.registerOsapiServices=function(){gadgets.config.init({rpc:{parentRelayUrl:""},views:gadgets.config.views,"osapi.services":{"http://%host%/__api_endpoint/os/1.0/rpc":["people.get","people.getViewer","people.getViewerFriends","people.getOwner","people.getOwnerFriends"]}})},osapi.container.Container=function(e){e=this.config_=e||{},this.service_=new osapi.container.Service(e),this.initializeMixins_(),this.onConstructed(e)},osapi.container.Container.prototype.onConstructed=function(){},osapi.container.Container.addMixin=function(e,t){osapi.container.Container.prototype.mixins_[e]=t},osapi.container.Container.prototype.mixins_={},osapi.container.Container.prototype.initializeMixins_=function(){for(var e in this.mixins_)this[e]=new this.mixins_[e](this)},shindig.LJIfrGadgetService=function(){shindig.IfrGadgetService.call(this),this.bindRpcMethods()},shindig.LJIfrGadgetService.inherits(shindig.IfrGadgetService),function(){var e={};shindig.LJIfrGadgetService.registerRpcMethod=function(t,n){var i;1===arguments.length?i=t:(i={},i[t]=n);for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])},shindig.LJIfrGadgetService.prototype.bindRpcMethods=function(){for(var t in e)e.hasOwnProperty(t)&&gadgets.rpc.register(t,this[e[t]])}}(),shindig.LJIfrGadgetService.registerRpcMethod({resize_iframe:"setHeight",set_title:"setTitle",requestNavigateTo:"requestNavigateTo","shindig.requestPermission":"requestPermission","shindig.requestShareApp":"requestShareApp","shindig.refreshSecurityToken":"refreshSecurityToken",set_pref:"setUserPref",requestSendMessage:"requestSendMessage"}),shindig.LJIfrGadgetService.prototype.setHeight=function(e){var t=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);shindig.container.getGadget(t).setHeight(e)},shindig.LJIfrGadgetService.prototype.setTitle=function(e){var t=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);shindig.container.getGadget(t).setTitle(e)},shindig.LJIfrGadgetService.prototype.requestNavigateTo=function(e,t,n){var i=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);i=shindig.container.getGadget(i);var r=gadgets.views.getSupportedViews();if(n=n||i.owner_name,jQuery("#"+this.f),e=e.toUpperCase(),!r.hasOwnProperty(e)||-1===jQuery.inArray(e,i.available_views))return null;e=shindig.container._getUrlForView(e,i,n,t),t=t||{},t.app_id=i.app_id;for(var a in t)t.hasOwnProperty(a)&&!t[a]&&delete t[a];t=gadgets.json.stringify(t),a=(a=/#(.+)$/.exec(e))&&a[0]||"",e=e.replace(a,""),t.length>0&&(e+=(-1===e.indexOf("?")?"?":"&")+"appParams="+encodeURIComponent(t)),e+=a,e&&(document.location.href=e)},shindig.LJIfrGadgetService.prototype.requestPermission=function(e,t,n,i){var r=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);r=shindig.container.getGadget(r);var a=r.app_id,s=this.f;new LJAppWidget_RequestPermission({title:"Ask Permission",finishCallback:function(t){"ERROR"==t.status?gadgets.rpc.call(s,"shindig.requestPermission_callback",null,e,t.code,t.message):gadgets.rpc.call(s,"shindig.requestPermission_callback",null,e,0,"",t.permissions)},authToken:r.auth_token},{reason:n||"",permissions:t.join(","),app_id:a,st:i}).loadContent()},shindig.LJIfrGadgetService.prototype.requestShareApp=function(e,t,n,i){var r=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);r=shindig.container.getGadget(r);var a=r.app_id,s=this.f;new LJAppWidget_RequestShareApp({title:"Ask Share App",finishCallback:function(t){gadgets.rpc.call(s,"shindig.requestShareApp_callback",null,e,t.code,t.message,t.recipients)},authToken:r.auth_token},{extra:n||"",recipients:t.join(","),app_id:a,st:i}).loadContent()},shindig.LJIfrGadgetService.prototype.refreshSecurityToken=function(e,t){var n=this.f,i=Site.siteroot.replace(/^http:\/\/www/,"http://api")+"/st/refresh/?st="+t+"&callback=?";jQuery.getJSON(i,function(t){gadgets.rpc.call(n,"shindig.refreshSecurityToken_callback",null,e,t,t.error)})},shindig.LJIfrGadgetService.prototype.setUserPref=function(){throw Error(shindig.errors.TO_BE_DONE)},shindig.LJIfrGadgetService.prototype.requestSendMessage=function(){throw Error(shindig.errors.TO_BE_DONE)},function(){var e={},t=0;this.openGadget=function(n,i){var r=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f),a=shindig.container.getGadget(r);r=this.f;var s={app_id:a.app_id,st:n,owner_id:a.owner_id,module_id:shindig.container.getMaxModuleId(),viewer_id:Site.remoteUser};t>0?gadgets.rpc.call(this.f,"gadgets.views.openGadget.result_callback",null,"already_opened"):r in e||(i.view&&(s.view=i.view),i.viewParams&&(s.params=i.viewParams),a=new LJAppWidget_OpenGadget({dialogId:r,authToken:a.auth_token},s),a.loadContent(),e[r]={widget:a,opener_id:this.f,returnValue:null},t++,gadgets.rpc.call(this.f,"gadgets.views.openGadget.navigate_callback",null,r))},this.close=function(n){var i;if(!n){if(n=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f),n=shindig.container.getGadget(n),!n||!n.dialog_id)return;n=n.dialog_id,i=this.f}var r=e[n];r&&(i||r.opener_id===n)&&(r.widget.close(),i=i||r.widget.frameId,shindig.container.removeGadgetByFrameId(i),gadgets.rpc.call(r.opener_id,"gadgets.views.openGadget.result_callback",null,r.returnValue),delete e[n],t--)},this.setReturnValue=function(t){var n=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f);(n=shindig.container.getGadget(n).dialog_id)&&e[n]&&(e[n].returnValue=t)},shindig.LJIfrGadgetService.registerRpcMethod({"gadgets.views.openGadget":"openGadget","gadgets.views.close":"close","gadgets.views.setReturnValue":"setReturnValue"})}.apply(shindig.LJIfrGadgetService.prototype),function(){gadgets=gadgets||{},gadgets.config=gadgets.config||{},gadgets.config.views={CANVAS:{isOnlyVisible:!0,urlTemplate:"http://{APP_SUBDOMAIN}.{DOMAIN}/{APP_KEY}"},SETTINGS:{urlTemplate:"{SITEROOT}/manage/settings/?cat=userapps&appid={APP_ID}"},ABOUT:{urlTemplate:"{SITEROOT}/games/#app_{APP_ID}"},INSTALL:{urlTemplate:"{SITEROOT}/games/install.bml?id={APP_ID}&act=install"},HOME:{urlTemplate:"{SITEROOT}#app_{APP_ID}"},COMMUNITY:{urlTemplate:"http://{COMMUNITY_NAME}.{DOMAIN}"},"COMMUNITY.PROFILE":{urlTemplate:"http://{COMMUNITY_NAME}.{DOMAIN}/profile"},"COMMUNITY.ENTRY":{urlTemplate:"http://{COMMUNITY_NAME}.{DOMAIN}/{DITEMID}.html"},PROFILE:{urlTemplate:"http://{OWNER_NAME}.{DOMAIN}/profile"},JOURNAL:{urlTemplate:"http://{OWNER_NAME}.{DOMAIN}"},"JOURNAL.ENTRY":{urlTemplate:"http://{OWNER_NAME}.{DOMAIN}/{DITEMID}.html"},"JOURNAL.FRIENDS":{urlTemplate:"http://{OWNER_NAME}.{DOMAIN}/friends"},"EMBEDDED.ENTRY":{urlTemplate:"http://{JOURNAL_NAME}.{DOMAIN}/{DITEMID}.html"},"EMBEDDED.COMMENT":{urlTemplate:"http://{JOURNAL_NAME}.{DOMAIN}/{DITEMID}.html?thread={DTALKID}#t{DTALKID}"},"EMBEDDED.MESSAGE":{urlTemplate:"{SITEROOT}/inbox/"},"EMBEDDED.ACTIVITY":{urlTemplate:"{SITEROOT}/games/info.bml?user={OWNER_NAME}"}}}(),shindig.LJGadget=function(e,t){if(this.id=shindig.container.gadgetService.getGadgetIdFromModuleId(e),this.gadgetId=e,t)for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])},shindig.LJGadget.inherits(shindig.Extensible),shindig.LJGadget.prototype.setHeight=function(e){var t=jQuery("#"+this.gadgetId);e>shindig.container.maxheight_&&(e=shindig.container.maxheight_),t.length>0&&t.height(e)},shindig.LJGadget.prototype.setTitle=function(e){var t=jQuery(".b-catalogue-app h1");t.length>0&&t.text(e.replace(/&/g,"&amp;").replace(/</g,"&lt;"))},shindig.LJPopupGadget=function(e,t,n){shindig.LJGadget.call(this,e,n),this.widget_=t},shindig.LJPopupGadget.inherits(shindig.LJGadget),shindig.LJPopupGadget.prototype.setHeight=function(e){this.widget_.setHeight(e)},shindig.LJPopupGadget.prototype.setTitle=function(e){this.widget_.setTitle(e)},shindig.LJIfrGadgetContainer=function(){shindig.IfrContainer.call(this)},shindig.LJIfrGadgetContainer.inherits(shindig.IfrContainer),shindig.LJIfrGadgetContainer.prototype.gadgetClass=shindig.LJGadget,shindig.LJIfrGadgetContainer.prototype.gadgetService=new shindig.LJIfrGadgetService,shindig.LJIfrGadgetContainer.prototype._getUrlForView=function(e,t,n,i){t={APP_ID:t.app_id,SITEROOT:Site.siteroot,DOMAIN:Site.siteroot.replace(/http:\/\/www\./g,""),APP_KEY:t.key,APP_SUBDOMAIN:t.app_domain,COMMUNITY_NAME:t.community_name,OWNER_NAME:n},n=gadgets.views.getSupportedViews()[e].getUrlTemplate(),i=i||{};for(var r in i)e=r.toUpperCase(),t.hasOwnProperty(e)||(t[e.toUpperCase()]=i[r]);return gadgets.views.bind(n,t)},shindig.LJIfrGadgetContainer.prototype._getViewFromString=function(e){return-1==e.indexOf(".")?{surface:e}:(e=e.split("."),{surface:e[0],secondary:e[1]})},shindig.LJIfrGadgetContainer.prototype.addGadget=function(e){e.id||(e.id=this.getNextGadgetInstanceId()),this.gadgets_[this.getGadgetKey_(e.id)]=e},shindig.LJIfrGadgetContainer.prototype.removeGadget=function(e){e=this.getGadgetKey_(e),e in this.gadgets_&&delete this.gadgets_[e]},shindig.LJIfrGadgetContainer.prototype.removeGadgetByFrameId=function(e){this.removeGadget(shindig.container.gadgetService.getGadgetIdFromModuleId(e))},shindig.LJIfrGadgetContainer.prototype.getMaxModuleId=function(){var e,t=0;for(e in this.gadgets_)this.gadgets_.hasOwnProperty(e)&&(t=Math.max(t,+this.gadgets_[e].module_id));return t},shindig.LJIfrGadgetContainer.prototype.findGadgets=function(){var e=this;jQuery("iframe.ljapp").filter(function(){if(!this.id)return!1;var e=shindig.container.gadgetService.getGadgetIdFromModuleId(this.id);return!shindig.container.getGadget(e)}).each(function(){e.createGadget(this)})},shindig.LJIfrGadgetContainer.prototype.createGadget=function(e,t){var n=jQuery(e);if(1===n.length){var i=gadgets.json.parse(decodeURIComponent(n.attr("data-view"))),r=n.prop("id");n=n.prop("src");var a=shindig.container.gadgetService.getGadgetIdFromModuleId(r);if(a=shindig.container.getGadget(a),!a){if(t&&"popup"===t){if(arguments.length<3)throw Error("widget must be passed  to the LJPopupGadget constructor");a=new shindig.LJPopupGadget(r,arguments[2],i)}else a=new shindig.LJGadget(r,i);shindig.container.addGadget(a),gadgets.rpc.setupReceiver(r,n)}}},shindig.container=new shindig.LJIfrGadgetContainer;var commonContainer=new osapi.container.Container({});LiveJournal.register_hook("page_load",function(){shindig.container.findGadgets()});
/* <<< file end: js/apps/appcontainer.js */

//# map link was there [appcontainer.js.map]
/* >>> file start: js/jquery/jquery.lj.journalPromoStrip.js */
!function(o,e){"use strict";o.widget("lj.journalPromoStrip",o.lj.basicWidget,{options:{selectors:{popupInfo:".journalpromo-popup-content-info",popupDelete:".journalpromo-popup-content-delete",button:"#journalpromo-popup-btn",iconClose:".b-journalpromo-actions-close",options:".b-journalpromo-header-options",promoItem:".b-journalpromo-item",iconDelete:".b-journalpromo-actions-delete",info:".journalpromo-popup-info-action",spinner:".journalpromo-popup-spinner",error:".journalpromo-popup-info-error",errorContent:".journalpromo-popup-info-error-content",ban:"#journalpromo-user-ban"},classNames:{iconInfo:".journalpromo-info-icon",iconDelete:".b-journalpromo-actions-delete",noPromo:"b-journalpromo-item-nopromotion"},template:"<dt><a href='{rules_link}'>{subject}</a> {ljuser}</dt><dd>{body}</dd>"},_create:function(){var e=this;o.lj.basicWidget.prototype._create.apply(this),this._el("spinner"),this._el("info"),this._el("button"),this._el("iconClose"),this._el("error"),e._el("promoItem"),this._el("iconDelete"),this._el("popupDelete"),this._el("errorContent"),this._el("iconDelete")[0]&&(this._deleteBubble=this._popupDelete.bubble({target:this._cl("iconDelete"),showOn:"click"})),this._el("popupInfo").bubble({target:this._cl("iconInfo"),showOn:"hover",closeControl:!1,showDelay:500}),this._bindControls()},_toggleSpinner:function(o){this._spinner.toggle(o),this._info.toggle(!o)},_toggleError:function(o,e){this._error.toggle(o),this._info.toggle(!o),e&&this._errorContent.text(e)},_updateBlock:function(o){o.object[0].object_url?this._promoItem.html(this.options.template.supplant({rules_link:o.object[0].object_url,subject:o.object[0].subject,body:o.object[0].body,ljuser:o.object[0].ljuser_display})):this._promoItem.html('<span class="b-journalpromo-item-message">'+o.object[0].body+"</span>").addClass(this._cl("noPromo"))},_closeClick:function(){var o=this;return"#__debug"===location.hash?this._debug():(o._toggleSpinner(!0),void LJ.Api.call("journalpromo.admin_cancel",{object_url:o.options.url,user:Site.currentJournal,get_slot:1,ban_user:document.getElementById("journalpromo-user-ban").checked},function(e){if(o._toggleSpinner(!1),console.dir(e),e.error&&e.error.data&&e.error.data.entry)return o._updated=e.error.data.entry[0],o._toggleError(!0,e.error.message),void console.error(e.error.message);if(!e.error&&e.entry){var t=e.entry[0];if(!t||!t.object||!t.object[0])return void console.error("Wrong data",e);o._updateBlock(t),o._iconDelete.hide()}o._deleteBubble.bubble("hide")}))},_disableClick:function(){var o=this;LJ.Api.call("journalpromo.disable_promo_announce",{journal:LJ.get("currentJournal")},function(e){e.error||o.element.slideUp("fast")})},_bindControls:function(){var e=this;o.lj.basicWidget.prototype._bindControls.apply(this),this._button.on("click",this._closeClick.bind(this)),this._iconClose.on("click",this._disableClick.bind(this)),this._deleteBubble&&this._deleteBubble.bind("bubblehide",function(o){e._toggleError(!1),e._updated&&(e._updateBlock(e._updated),e._iconDelete.hide())})},_debug:function(){var o=this;o._toggleSpinner(!0),setTimeout(function(){o._toggleSpinner(!1),o._toggleError(!0,"Sample error")},1e3)}})}(jQuery,window);
/* <<< file end: js/jquery/jquery.lj.journalPromoStrip.js */

//# map link was there [jquery.lj.journalPromoStrip.js.map]
